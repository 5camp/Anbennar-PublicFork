namespace = magic_realm_illusion


#Illusion - Menu
country_event = {
	id = magic_realm_illusion.0
	title = magic_realm_illusion.0.t
	desc = magic_realm_illusion.0.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = magic_realm_nospells.0.a
		trigger = {
			OR = {
				NOT = { has_ruler_flag = illusion_1 }
				NOT = { has_ruler_flag = illusion_2 }
				NOT = { has_ruler_flag = illusion_3 }
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				NOT = { prestige = 50 }
			}
		}
		
		country_event = { id = magic_realm.0 days = 0 }
	}
	
	option = {	#Illusionary Marvels 1
		name = magic_realm_illusion.1.t
		trigger = {
			has_ruler_flag = illusion_1
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_realm_illusion.1 days = 0 }
	}
	
	option = {	#Glamour 2
		name = magic_realm_illusion.2.t
		trigger = {
			has_ruler_flag = illusion_2
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				personality = ai_diplomat
			}
		}
		
		country_event = { id = magic_realm_illusion.2 days = 0 }
	}
	
	option = {	#Simulacrum 3
		name = magic_realm_illusion.3.t
		trigger = {
			has_ruler_flag = illusion_3
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_realm_illusion.3 days = 0 }
	}
	
	option = {
		name = magic_siege.goback
		ai_chance = {
			factor = 50
		}
		country_event = { id = magic_realm.0 days = 0 }
	}
}

# 1 - Illusionary Marvels
country_event = {
	id = magic_realm_illusion.1
	title = magic_realm_illusion.1.t
	desc = magic_realm_illusion.1.d
	picture = STREET_SPEECH_eventPicture
	
	is_triggered_only = yes
	
	option = {	#Level 1
		name = magic_realm_illusion.1.a
		trigger = {
			has_ruler_flag = illusion_1
		}
		ai_chance = {
			factor = 50
		}
		
		#Cost
		add_mil_power = -10
		
		#Effect
		magic_casted_spell = yes
		
		add_prestige = 2
	}
	
	option = {	#Level 3
		name = magic_realm_illusion.1.b
		trigger = {
			has_ruler_flag = illusion_2
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				has_ruler_flag = illusion_2
				NOT = { has_ruler_flag = illusion_3 }
			}
		}
		
		#Cost
		add_mil_power = -20
		
		#Effect
		magic_casted_spell = yes
		
		add_prestige = 5
	}
	
	option = {	#Level 3
		name = magic_realm_illusion.1.c
		trigger = {
			has_ruler_flag = illusion_3
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				NOT = { prestige = 50 }
			}
			modifier = {
				factor = 2
				has_ruler_flag = illusion_3
			}
		}
		
		#Cost
		add_mil_power = -30
		
		#Effect
		magic_casted_spell = yes
		
		add_prestige = 10
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 50
		}
		country_event = { id = magic_realm_illusion.0 days = 0 }
	}
}

# 2 - Glamour
country_event = {
	id = magic_realm_illusion.2
	title = magic_realm_illusion.2.t
	desc = magic_realm_illusion.2.d
	picture = wihgfx_FEMALES_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = magic_realm_unavailable.0.a
		trigger = {
			OR = {
				has_ruler_modifier = magic_realm_illusion_glamour
				has_ruler_modifier = magic_realm_illusion_enchanted_glamour
				has_ruler_modifier = magic_realm_illusion_otherworldly_glamour
			}
		}
		custom_tooltip = magic_realm_unavailable_cooldown
	}
	
	option = {	#Glamour
		name = magic_realm_illusion.2.a
		trigger = {
			has_ruler_flag = illusion_2
			NOT = { has_ruler_modifier = magic_realm_illusion_glamour }
			NOT = { has_ruler_modifier = magic_realm_illusion_enchanted_glamour }
			NOT = { has_ruler_modifier = magic_realm_illusion_otherworldly_glamour }
		}
		ai_chance = {
			factor = 50
		}
		
		#Cost
		add_dip_power = -10
		
		#Effect
		magic_casted_spell = yes
		
		add_ruler_modifier = {
			name = magic_realm_illusion_glamour
			duration = 365
		}
	}
	
	option = {	#Enchanted Glamour
		name = magic_realm_illusion.2.b
		trigger = {
			has_ruler_flag = illusion_2
			has_ruler_flag = enchantment_1
			NOT = { has_ruler_modifier = magic_realm_illusion_glamour }
			NOT = { has_ruler_modifier = magic_realm_illusion_enchanted_glamour }
			NOT = { has_ruler_modifier = magic_realm_illusion_otherworldly_glamour }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				has_ruler_flag = illusion_2
				has_ruler_flag = enchantment_1
			}
		}
		custom_tooltip = magic_enchantment_1_tooltip
		
		#Cost
		add_dip_power = -10
		add_adm_power = -5
		
		#Effect
		magic_casted_spell = yes
		
		add_ruler_modifier = {
			name = magic_realm_illusion_enchanted_glamour
			duration = 365
		}
	}
	
	option = {	#Otherworldly Glamour
		name = magic_realm_illusion.2.b
		trigger = {
			has_ruler_flag = illusion_3
			has_ruler_flag = enchantment_1
			NOT = { has_ruler_modifier = magic_realm_illusion_glamour }
			NOT = { has_ruler_modifier = magic_realm_illusion_enchanted_glamour }
			NOT = { has_ruler_modifier = magic_realm_illusion_otherworldly_glamour }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				has_ruler_flag = illusion_2
				has_ruler_flag = enchantment_1
			}
		}
		custom_tooltip = magic_enchantment_1_tooltip
		custom_tooltip = magic_illusion_3_tooltip
		
		#Cost
		add_dip_power = -10
		add_adm_power = -5
		
		#Effect
		magic_casted_spell = yes
		
		add_ruler_modifier = {
			name = magic_realm_illusion_enchanted_glamour
			duration = 365
		}
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 50
		}
		country_event = { id = magic_realm_illusion.0 days = 0 }
	}
}

# 3 - Simulacrum
country_event = {
	id = magic_realm_illusion.3
	title = magic_realm_illusion.3.t
	desc = magic_realm_illusion.3.d
	picture = wihgfx_FEMALES_eventPicture
	
	#is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_flag = magic_project_simulacrum_started }
		#has_ruler_modifier = ruler_studying_magic
		OR = {
			NOT = { has_ruler_modifier = magic_realm_illusion_simulacrum }
			NOT = { has_ruler_modifier = magic_realm_illusion_simulacrum_exposed }
		}
	}
	
	option = {
		name = magic_realm_unavailable.0.a
		trigger = {
			OR = {
				has_ruler_modifier = magic_realm_illusion_glamour
				has_ruler_modifier = magic_realm_illusion_enchanted_glamour
			}
		}
		custom_tooltip = magic_realm_unavailable_cooldown
	}
	
	option = {	#Craft Simulacrum
		name = magic_realm_illusion.3.a
		trigger = {
			has_ruler_flag = illusion_3
			OR = {
				NOT = { has_ruler_modifier = magic_realm_illusion_simulacrum }
				NOT = { has_ruler_modifier = magic_realm_illusion_simulacrum_exposed }
			}
			NOT = { has_ruler_flag = magic_project_simulacrum_started }
			NOT = { has_ruler_flag = magic_project_simulacrum_complete }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				NOT = { prestige = 50 }
			}
		}
		custom_tooltip = magic_project_start
		
		#Cost
		add_adm_power = -50
		add_dip_power = -50
		add_mil_power = -50
		
		#Effect
		magic_casted_spell = yes
		
		set_ruler_flag = magic_project_simulacrum_started
		
	}
	
	option = {	#Activate Simulacrum
		name = magic_realm_illusion.3.b
		trigger = {
			has_ruler_flag = illusion_3
			has_ruler_flag = magic_project_simulacrum_complete
			has_ruler_modifier = ruler_studying_magic
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { adm_power = 150 }
				NOT = { dip_power = 150 }
			}
		}
		
		#Cost
		add_adm_power = -150
		add_dip_power = -150
		
		#Effect
		magic_casted_spell = yes
		
		if = {
			limit = {
				has_ruler_flag = magic_realm_simulacrum_exposed
			}
			add_ruler_modifier = {
				name = magic_realm_illusion_simulacrum_exposed
				duration = 3650
			}
		}
		else = {
			add_ruler_modifier = {
				name = magic_realm_illusion_simulacrum
				duration = 3650
			}
		}
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 50
		}
		country_event = { id = magic_realm_illusion.0 days = 0 }
	}
}


# 3 - Simulacrum B project finish
country_event = {
	id = magic_realm_illusion.4
	title = magic_realm_illusion.4.t
	desc = magic_realm_illusion.4.d
	picture = wihgfx_FEMALES_eventPicture
	
	trigger = {
		has_ruler_flag = magic_project_simulacrum_started
		NOT = { has_ruler_flag = magic_project_simulacrum_1 }
	}
	
	mean_time_to_happen = {
		months = 12
		modifier = {
			factor = 0.5
			has_ruler_flag = magic_project_simulacrum_1
		}
	}
	
	option = {	#Success
		name = magic_realm_illusion.4.a
		ai_chance = {
			factor = 50
		}
		
		set_ruler_flag = magic_project_simulacrum_complete
		
	}
}

# 3 - Simulacrum B project finish
country_event = {
	id = magic_realm_illusion.5
	title = magic_realm_illusion.5.t
	desc = magic_realm_illusion.5.d
	picture = wihgfx_FEMALES_eventPicture
	
	trigger = {
		has_ruler_flag = magic_project_simulacrum_started
		NOT = { has_ruler_flag = magic_project_simulacrum_1 }
	}
	
	mean_time_to_happen = {
		months = 6
	}
	
	option = {
		name = magic_realm_illusion.5.a
		ai_chance = {
			factor = 50
		}
		
		add_adm_power = -10
		
		set_ruler_flag = magic_project_simulacrum_1
		custom_tooltip = magic_realm_simulacrum_available
		
	}
}