namespace = flavour_kobold_dragon_cult

country_event = {
	id = flavour_kobold_dragon_cult.1
	title = flavour_kobold_dragon_cult.1.t
	desc = flavour_kobold_dragon_cult.1.d
	picture = EXPLORERS_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			random_owned_province = {
				save_event_target_as = kobold_event_target
			}
			random_owned_province = {
				limit = {
					religion = kobold_dragon_cult
				}
				save_event_target_as = kobold_event_target
			}
			random_owned_province = {
				limit = {
					religion = kobold_dragon_cult
					NOT = { has_province_modifier = kdc_donated_to_hoard }
				}
				save_event_target_as = kobold_event_target
			}
		}
	}
	
	after = {
		if = {
			limit = {
				has_country_flag = red_dragon_2
				has_country_flag = red_dragon_3
				has_country_flag = blue_dragon_2
				has_country_flag = blue_dragon_3
				has_country_flag = green_dragon_2
				has_country_flag = green_dragon_3
				has_country_flag = black_dragon_2
				has_country_flag = black_dragon_3
				has_country_flag = white_dragon_2
				has_country_flag = white_dragon_3
				has_country_flag = purple_dragon_2
				has_country_flag = purple_dragon_3
				has_country_flag = brown_dragon_2
				has_country_flag = brown_dragon_3
				has_country_flag = brass_dragon_2
				has_country_flag = brass_dragon_3
				has_country_flag = copper_dragon_2
				has_country_flag = copper_dragon_3
				has_country_flag = bronze_dragon_2
				has_country_flag = bronze_dragon_3
				has_country_flag = silver_dragon_2
				has_country_flag = silver_dragon_3
				has_country_flag = gold_dragon_2
				has_country_flag = gold_dragon_3
				NOT = { has_country_flag = kobold_power_of_the_rainbow }
			}
			country_event = { id = flavour_kobold_dragon_cult.3 }
		}
	}
	
	# Go back
	option = {
		name = flavour_kobold_dragon_cult.1.a
		highlight = yes
		
		add_church_power = 100
		
		ai_chance = {
			factor = 0
		}
	}
	
	# Contibute to the hoard
	option = {
		name = flavour_kobold_dragon_cult.1.b
		goto = kobold_event_target
		
		trigger = {
			owns = 189
		}
		
		if = {
			limit = {
				NOT = { has_global_flag = dragon_roar }
			}

			custom_tooltip = church_power_hoard_donation_100
			add_prestige = 5
			hidden_effect = { REB = { change_variable = { dragon_cult_hoard = 100 } } }
			hidden_effect = { 189 = { upgrade_kobold_hoard = yes } }
		}
		else = {
			add_treasury = 100
		}
		
		event_target:kobold_event_target = {
			add_province_modifier = {
				name = kdc_donated_to_hoard
				duration = 365
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.c
		
		trigger = {
			has_church_aspect = red_dragon_1
			NOT = { has_country_flag = unlocked_red_dragon_2 }
		}
		set_country_flag = unlocked_red_dragon_2

		tooltip = {
			add_country_modifier = {
				name = red_dragon_2
				desc = UNLOCKED_DRAGON_CULT_TOOLTIP
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.e
		
		trigger = {
			has_church_aspect = red_dragon_1
			NOT = { has_country_flag = unlocked_red_dragon_3 }
		}
		set_country_flag = unlocked_red_dragon_3

		tooltip = {
			add_country_modifier = {
				name = red_dragon_3
				desc = UNLOCKED_DRAGON_CULT_TOOLTIP
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.f
		
		trigger = {
			has_church_aspect = blue_dragon_1
			NOT = { has_country_flag = unlocked_blue_dragon_2 }
		}
		set_country_flag = unlocked_blue_dragon_2

		tooltip = {
			add_country_modifier = {
				name = blue_dragon_2
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.g
		
		trigger = {
			has_church_aspect = blue_dragon_1
			NOT = { has_country_flag = unlocked_blue_dragon_3 }
		}
		set_country_flag = unlocked_blue_dragon_3

		tooltip = {
			add_country_modifier = {
				name = blue_dragon_3
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.h
		
		trigger = {
			has_church_aspect = green_dragon_1
			NOT = { has_country_flag = unlocked_green_dragon_2 }
		}
		set_country_flag = unlocked_green_dragon_2

		tooltip = {
			add_country_modifier = {
				name = green_dragon_2
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.i
		
		trigger = {
			has_church_aspect = green_dragon_1
			NOT = { has_country_flag = unlocked_green_dragon_3 }
		}
		set_country_flag = unlocked_green_dragon_3

		tooltip = {
			add_country_modifier = {
				name = green_dragon_3
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.j
		
		trigger = {
			has_church_aspect = black_dragon_1
			NOT = { has_country_flag = unlocked_black_dragon_2 }
		}
		set_country_flag = unlocked_black_dragon_2

		tooltip = {
			add_country_modifier = {
				name = black_dragon_2
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.k
		
		trigger = {
			has_church_aspect = black_dragon_1
			NOT = { has_country_flag = unlocked_black_dragon_3 }
		}
		set_country_flag = unlocked_black_dragon_3

		tooltip = {
			add_country_modifier = {
				name = black_dragon_3
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.l
		
		trigger = {
			has_church_aspect = white_dragon_1
			NOT = { has_country_flag = unlocked_white_dragon_2 }
		}
		set_country_flag = unlocked_white_dragon_2

		tooltip = {
			add_country_modifier = {
				name = white_dragon_2
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.m
		
		trigger = {
			has_church_aspect = white_dragon_1
			NOT = { has_country_flag = unlocked_white_dragon_3 }
		}
		set_country_flag = unlocked_white_dragon_3

		tooltip = {
			add_country_modifier = {
				name = white_dragon_3
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.n
		
		trigger = {
			has_church_aspect = purple_dragon_1
			NOT = { has_country_flag = unlocked_purple_dragon_2 }
		}
		set_country_flag = unlocked_purple_dragon_2

		tooltip = {
			add_country_modifier = {
				name = purple_dragon_2
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.o
		
		trigger = {
			has_church_aspect = purple_dragon_1
			NOT = { has_country_flag = unlocked_purple_dragon_3 }
		}
		set_country_flag = unlocked_purple_dragon_3

		tooltip = {
			add_country_modifier = {
				name = purple_dragon_3
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.p
		
		trigger = {
			has_church_aspect = brown_dragon_1
			NOT = { has_country_flag = unlocked_brown_dragon_2 }
		}
		set_country_flag = unlocked_brown_dragon_2

		tooltip = {
			add_country_modifier = {
				name = brown_dragon_2
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.q
		
		trigger = {
			has_church_aspect = brown_dragon_1
			NOT = { has_country_flag = unlocked_brown_dragon_3 }
		}
		set_country_flag = unlocked_brown_dragon_3

		tooltip = {
			add_country_modifier = {
				name = brown_dragon_3
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.r
		
		trigger = {
			has_church_aspect = brass_dragon_1
			NOT = { has_country_flag = unlocked_brass_dragon_2 }
		}
		set_country_flag = unlocked_brass_dragon_2

		tooltip = {
			add_country_modifier = {
				name = brass_dragon_2
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.s
		
		trigger = {
			has_church_aspect = brass_dragon_1
			NOT = { has_country_flag = unlocked_brass_dragon_3 }
		}
		set_country_flag = unlocked_brass_dragon_3

		tooltip = {
			add_country_modifier = {
				name = brass_dragon_3
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.t
		
		trigger = {
			has_church_aspect = copper_dragon_1
			NOT = { has_country_flag = unlocked_copper_dragon_2 }
		}
		set_country_flag = unlocked_copper_dragon_2

		tooltip = {
			add_country_modifier = {
				name = copper_dragon_2
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.u
		
		trigger = {
			has_church_aspect = copper_dragon_1
			NOT = { has_country_flag = unlocked_copper_dragon_3 }
		}
		set_country_flag = unlocked_copper_dragon_3

		tooltip = {
			add_country_modifier = {
				name = copper_dragon_3
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.v
		
		trigger = {
			has_church_aspect = bronze_dragon_1
			NOT = { has_country_flag = unlocked_bronze_dragon_2 }
		}
		set_country_flag = unlocked_bronze_dragon_2

		tooltip = {
			add_country_modifier = {
				name = bronze_dragon_2
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.w
		
		trigger = {
			has_church_aspect = bronze_dragon_1
			NOT = { has_country_flag = unlocked_bronze_dragon_3 }
		}
		set_country_flag = unlocked_bronze_dragon_3

		tooltip = {
			add_country_modifier = {
				name = bronze_dragon_3
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.x
		
		trigger = {
			has_church_aspect = silver_dragon_1
			NOT = { has_country_flag = unlocked_silver_dragon_2 }
		}
		set_country_flag = unlocked_silver_dragon_2

		tooltip = {
			add_country_modifier = {
				name = silver_dragon_2
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.y
		
		trigger = {
			has_church_aspect = silver_dragon_1
			NOT = { has_country_flag = unlocked_silver_dragon_3 }
		}
		set_country_flag = unlocked_silver_dragon_3

		tooltip = {
			add_country_modifier = {
				name = silver_dragon_3
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.z
		
		trigger = {
			has_church_aspect = gold_dragon_1
			NOT = { has_country_flag = unlocked_gold_dragon_2 }
		}
		set_country_flag = unlocked_gold_dragon_2

		tooltip = {
			add_country_modifier = {
				name = gold_dragon_2
				desc = UNLOCKED_CULT
			}
		}
	}
	
	option = {
		name = flavour_kobold_dragon_cult.1.aa
		
		trigger = {
			has_church_aspect = gold_dragon_1
			NOT = { has_country_flag = unlocked_gold_dragon_3 }
		}
		set_country_flag = unlocked_gold_dragon_3

		tooltip = {
			add_country_modifier = {
				name = gold_dragon_3
				desc = UNLOCKED_CULT
			}
		}
	}
}

#The KoboldHoard
country_event = {
	id = flavour_kobold_dragon_cult.2
	title = flavour_kobold_dragon_cult.2.t
	desc = flavour_kobold_dragon_cult.2.d
	picture = KOBOLD_HOARD_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		religion = kobold_dragon_cult
		NOT = { has_global_flag = dragon_roar }
	}
	
	# little investment
	option = {		
		name = flavour_kobold_dragon_cult.2.a
		ai_chance = { factor = 50 }	
		trigger = { treasury = 100 }
		add_treasury = -100
		if = {
			limit = { has_church_aspect = red_dragon_1 }
			add_church_power = 20
		}
		else = {
			add_church_power = 10
		}
		hidden_effect = { REB = { change_variable = { dragon_cult_hoard = 100 } } }
		tooltip = { random = { chance = 10 add_stability_or_adm_power = yes } }
		set_country_flag = hoard_chance_1
		hidden_effect = { country_event = { id = flavor_kobildzan.100 } }
		hidden_effect = { country_event = { id = flavor_kobildzan.4 } }
		hidden_effect = { 189 = { upgrade_kobold_hoard = yes } }
	}
	
	# Normal investment
	option = {		
		name = flavour_kobold_dragon_cult.2.b
		ai_chance = { factor = 50 }	
		trigger = { treasury = 250 }
		add_treasury = -250
		if = {
			limit = { has_church_aspect = red_dragon_1 }
			add_church_power = 50
		}
		else = {
			add_church_power = 25
		}
		hidden_effect = { REB = { change_variable = { dragon_cult_hoard = 250 } } }
		add_prestige = 2
		tooltip = { random = { chance = 25 add_stability_or_adm_power = yes } }
		set_country_flag = hoard_chance_2
		hidden_effect = { country_event = { id = flavor_kobildzan.100 } }
		hidden_effect = { country_event = { id = flavor_kobildzan.4 } }
		hidden_effect = { 189 = { upgrade_kobold_hoard = yes } }
	}
	
	# Big investment
	option = {		
		name = flavour_kobold_dragon_cult.2.c
		ai_chance = { factor = 50 }	
		trigger = { treasury = 500 }
		add_treasury = -500
		if = {
			limit = { has_church_aspect = red_dragon_1 }
			add_church_power = 100
		}
		else = {
			add_church_power = 50
		}
		hidden_effect = { REB = { change_variable = { dragon_cult_hoard = 500 } } }
		add_prestige = 5
		tooltip = { random = { chance = 50 add_stability_or_adm_power = yes } }
		set_country_flag = hoard_chance_3
		hidden_effect = { country_event = { id = flavor_kobildzan.100 } }
		hidden_effect = { country_event = { id = flavor_kobildzan.4 } }
		hidden_effect = { 189 = { upgrade_kobold_hoard = yes } }
	}
	
	# Huge investment
	option = {		
		name = flavour_kobold_dragon_cult.2.e
		ai_chance = { factor = 50 }	
		trigger = { treasury = 1000 }
		add_treasury = -1000
		if = {
			limit = { has_church_aspect = red_dragon_1 }
			add_church_power = 200
		}
		else = {
			add_church_power = 100
		}
		hidden_effect = { REB = { change_variable = { dragon_cult_hoard = 1000 } } }
		add_prestige = 10
		add_stability_or_adm_power = yes
		hidden_effect = { country_event = { id = flavor_kobildzan.4 } }
		hidden_effect = { 189 = { upgrade_kobold_hoard = yes } }
	}
	
	# Colossal investment
	option = {		
		name = flavour_kobold_dragon_cult.2.f
		ai_chance = { factor = 50 }
		trigger = { treasury = 2000 }
		add_treasury = -2000
		add_church_power = 200
		if = {
			limit = { has_church_aspect = red_dragon_1 }
			custom_tooltip = church_power_hoard_donation_200
		}
		hidden_effect = { REB = { change_variable = { dragon_cult_hoard = 2000 } } }
		add_prestige = 25
		add_stability_or_adm_power = yes
		add_stability_or_adm_power = yes
		hidden_effect = { country_event = { id = flavor_kobildzan.4 } }
		hidden_effect = { 189 = { upgrade_kobold_hoard = yes } }
	}
	
	option = {		
		name = flavour_kobold_dragon_cult.2.g
		ai_chance = { factor = 50 }
		trigger = { treasury = 5000 }
		add_treasury = -5000
		add_church_power = 200
		if = {
			limit = { has_church_aspect = red_dragon_1 }
			custom_tooltip = church_power_hoard_donation_800
		}
		else = {
			custom_tooltip = church_power_hoard_donation_300
		}
		hidden_effect = { REB = { change_variable = { dragon_cult_hoard = 5300 } } }
		add_prestige = 50
		add_stability_or_adm_power = yes
		add_stability_or_adm_power = yes
		add_stability_or_adm_power = yes
		add_stability_or_adm_power = yes
		add_stability_or_adm_power = yes
		hidden_effect = { country_event = { id = flavor_kobildzan.4 } }
		hidden_effect = { 189 = { upgrade_kobold_hoard = yes } }
	}
	
	# Go Back
	option = {		
		name = flavour_kobold_dragon_cult.2.h
		ai_chance = { factor = 50 }
		hidden_effect = { clr_country_flag = kobold_hoard_menu }
	}
}

# Unlock malliath
country_event = {
	id = flavour_kobold_dragon_cult.3
	title = flavour_kobold_dragon_cult.3.t
	desc = flavour_kobold_dragon_cult.3.d
	picture = KOBOLD_HOARD_eventPicture
	
	is_triggered_only = yes
	
	# Coolio
	option = {		
		name = flavour_kobold_dragon_cult.3.a
		ai_chance = { factor = 50 }
		set_country_flag = unlocked_kobold_power_of_the_rainbow

		tooltip = {
			add_country_modifier = {
				name rainbow_dragon_1
			}
		}
	}
}


