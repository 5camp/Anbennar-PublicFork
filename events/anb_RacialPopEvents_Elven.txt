namespace = racial_pop_events_elven

#Demand Representation
country_event = {
	id = racial_pop_events_elven.1
	title = racial_pop_events_elven.1.t
	desc = racial_pop_events_elven.1.d
	picture = DEBATE_REPUBLICAN_eventPicture
	
	trigger = {
		any_owned_province = {
			NOT = { local_autonomy = 50 }
			is_capital = no
			has_elven_minority_trigger = yes
		}
	}
	
	is_triggered_only = yes
	
	mean_time_to_happen = {
		days = 1
	}
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					has_elven_minority_trigger = yes
					is_capital = no
				}
				save_event_target_as = racial_pop_province
			}
			random_owned_province = {
				limit = {
					NOT = { local_autonomy = 50 }
					is_capital = no
					has_elven_minority_trigger = yes
				}
				save_event_target_as = racial_pop_province
			}
			random_owned_province = {
				limit = {
					NOT = { local_autonomy = 50 }
					is_capital = no
					has_elven_minority_trigger = yes
					development = 10
				}
				save_event_target_as = racial_pop_province
			}
		}
	}
	
	option = {		#Granted!
		name = racial_pop_events_elven.1.a
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.5
				ai_lower_than_wanted_tolerance_elven = yes
			}
		}
		
		add_adm_power = -40
		
		medium_increase_of_elven_tolerance_effect = yes
		
		event_target:racial_pop_province = {
			add_local_autonomy = 25
		}
	}
	
	option = {		#Make some concessions
		name = racial_pop_events_elven.1.b
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.5
				ai_equal_to_wanted_tolerance_elven = yes
			}
			modifier = {
				factor = 0.5
				average_autonomy = 10
			}
		}
		
		add_adm_power = -20
		
		event_target:racial_pop_province = {
			add_local_autonomy = 10
		}

	}
	
	option = {		#No. Haven't we given them enough?!
		name = racial_pop_events_elven.1.c
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.5
				ai_higher_than_wanted_tolerance_elven = yes
			}
		}
		
		medium_decrease_of_elven_tolerance_effect = yes
		
	}
	
	option = {		#Special: Make empty promises
		name = racial_pop_events_elven.1.e
		trigger = { ruler_has_personality = charismatic_negotiator_personality }
		highlight = yes
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.25
				ai_higher_to_wanted_tolerance_elven = yes
			}
			modifier = {
				factor = 1.5
				average_autonomy = 10
			}
		}
		
		add_dip_power = -10
		
		small_increase_of_elven_tolerance_effect = yes
		
		event_target:racial_pop_province = {
			add_local_autonomy = 1
		}
		
	}
}


#Tolerance Increase
country_event = {
	id = racial_pop_events_elven.2
	title = racial_pop_events_elven.2.t
	desc = racial_pop_events_elven.2.d
	picture = GOOD_WITH_MONARCH_eventPicture
	
	trigger = {
		any_owned_province = {
			has_elven_minority_trigger = yes
		}
		
		OR = {
			stability = 1
			in_golden_age = yes
			ruler_has_personality = tolerant_personality
			ruler_has_personality = kind_hearted_personality
			ruler_has_personality = benevolent_personality
			has_idea_group = humanist_ideas
		}
	}
	
	is_triggered_only = yes
	
	mean_time_to_happen = {
		days = 1
	}
	immediate = {
		hidden_effect = {
		
			random_list = {
				75 = {
					set_country_flag = racial_pop_small_increase
				}
				25 = {
					set_country_flag = racial_pop_medium_increase
				}
			}
		}
	}
	
	option = {		#Good for them
		name = racial_pop_events_elven.2.a
		ai_chance = {
			factor = 50
		}
		
		trigger_switch = {
			on_trigger = has_country_flag
			racial_pop_small_increase = { small_increase_of_elven_tolerance_effect = yes }
			racial_pop_medium_increase = { medium_increase_of_elven_tolerance_effect = yes }
		}
		
		clear_racial_pop_tolerance_chance_flags = yes
		
	}
	
}


#Tolerance Decrease
country_event = {
	id = racial_pop_events_elven.3
	title = racial_pop_events_elven.3.t
	desc = racial_pop_events_elven.3.d
	picture = BAD_WITH_MONARCH_eventPicture
	
	trigger = {
		any_owned_province = {
			has_elven_minority_trigger = yes
		}
		
		OR = {
			stability = -3
			NOT = { stability = 0 }
			is_bankrupt = yes
			inflation = 25
			is_at_war = yes
			NOT = { war_score = 20 }
			war_exhaustion = 10
			ruler_has_personality = cruel_personality
			ruler_has_personality = malevolent_personality
			ruler_has_personality = conqueror_personality
		}
	}
	
	is_triggered_only = yes
	
	mean_time_to_happen = {
		days = 1
	}
	immediate = {
		hidden_effect = {
		
			random_list = {
				75 = {
					set_country_flag = racial_pop_small_decrease
				}
				25 = {
					set_country_flag = racial_pop_medium_decrease
				}
			}
		}
	}
	
	option = {		#That's unfortunate
		name = racial_pop_events_elven.3.a
		ai_chance = {
			factor = 50
		}
		
		trigger_switch = {
			on_trigger = has_country_flag
			racial_pop_small_decrease = { small_decrease_of_elven_tolerance_effect = yes }
			racial_pop_medium_decrease = { medium_decrease_of_elven_tolerance_effect = yes }
		}
		
		clear_racial_pop_tolerance_chance_flags = yes
		
	}
	
}


#Independent Pop Grow - small to large
country_event = {
	id = racial_pop_events_elven.4
	title = racial_pop_events_elven.4.t
	desc = racial_pop_events_elven.4.d
	picture = CITY_eventPicture
	
	trigger = {
		any_owned_province = {
			has_small_elven_minority_trigger = yes
			OR = {
				is_prosperous = yes
				development = 20
			}
		}

	}
	
	is_triggered_only = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					has_small_elven_minority_trigger = yes
					development = 20
				}
				save_event_target_as = racial_pop_province
			}
			random_owned_province = {
				limit = {
					has_small_elven_minority_trigger = yes
					is_capital = yes
				}
				save_event_target_as = racial_pop_province
			}
			random_owned_province = {
				limit = {
					has_small_elven_minority_trigger = yes
					development = 20
				}
				save_event_target_as = racial_pop_province
			}
		}
	}
	
	option = {		#The more the merrier?
		name = racial_pop_events_elven.4.a
		ai_chance = {
			factor = 50
		}
	
		event_target:racial_pop_province = {
			add_elven_minority_size_effect = yes
		}
	}
	
}

#Independent Pop Decrease - large/small decrease
country_event = {
	id = racial_pop_events_elven.5
	title = racial_pop_events_elven.5.t
	desc = racial_pop_events_elven.5.d
	picture = CITY_eventPicture
	
	trigger = {
		OR = {
			any_owned_province = {
				has_elven_minority_trigger = yes
				OR = {
					devastation = 50
					unrest = 15
				}
			}
			any_owned_province = {
				has_oppressed_elven_minority_trigger = yes
			}
		}
	}
	
	is_triggered_only = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					has_elven_minority_trigger = yes
				}
				save_event_target_as = racial_pop_province
			}
		}
	}
	
	option = {		#Large minority decreases to small
		name = racial_pop_events_elven.5.a
		trigger = {
			event_target:racial_pop_province = {
				has_large_elven_minority_trigger = yes
			}
		}
		ai_chance = {
			factor = 50
		}
	
		event_target:racial_pop_province = {
			remove_elven_minority_size_effect = yes
		}
	}
	
	option = {		#Small minority is removed (becomes insignificant)
		name = racial_pop_events_elven.5.b
		trigger = {
			event_target:racial_pop_province = {
				has_small_elven_minority_trigger = yes
			}
		}
		ai_chance = {
			factor = 50
		}
	
		event_target:racial_pop_province = {
			remove_elven_minority_size_effect = yes
		}
	}
}


#Pop Migrates - Start
country_event = {
	id = racial_pop_events_elven.6
	title = racial_pop_events_elven.6.t
	desc = racial_pop_events_elven.6.d
	picture = CITY_eventPicture
	
	trigger = {
		num_of_cities = 2	#you have something to migrate to
		OR = {
			any_owned_province = {
				has_elven_minority_trigger = yes
				OR = {
					devastation = 33
					unrest = 10
					NOT = { development = 10 }
				}
			}
			any_owned_province = {
				OR = {
					has_elven_minority_trigger = yes
					has_oppressed_elven_minority_trigger = yes
				}
			}
		}
		# has_oppressed_elven_minority_trigger = yes
		# has_elven_minority_trigger = yes
		# OR = {
			# devastation = 33
			# unrest = 10
			# NOT = { development = 10 }
		# }

	}
	
	is_triggered_only = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		#hidden_effect = {
			random_owned_province = {
				limit = {
					has_elven_minority_trigger = yes
					# OR = {
						# devastation = 33
						# unrest = 10
						# NOT = { development = 10 }
					# }
				}
				save_event_target_as = racial_pop_province
			}
			
			#NOT BEING USED IF WE ARENT DOING ADJACENT!
			event_target:racial_pop_province = {
				random_neighbor_province = {
					limit = {
					}
					save_global_event_target_as = global_racial_pop_migration_province
				}
			}
			event_target:racial_pop_province = {
				random_neighbor_province = {
					limit = {
						development 10
					}
				}
				save_global_event_target_as = global_racial_pop_migration_province
			}
			
		#Which migration path check
		hidden_effect = {
			random_list = {
				# 1 = {
					# set_country_flag = racial_pop_migrate_adjacent
				# }
				1 = {
					set_country_flag = racial_pop_migrate_within_country
				}
				1 = {
					set_country_flag = racial_pop_migrate_outside_country
				}
			}
		}
		
		#Which country to migrate to
		hidden_effect = {
			random_neighbor_country = {
				save_event_target_as = racial_pop_migration_country
			}
			random_neighbor_country = {
				limit = {
					any_owned_province = {
						development = 20
					}
				}
				save_event_target_as = racial_pop_migration_country
			}
			random_neighbor_country = {
				limit = {
					medium_tolerance_elven_race_trigger = yes
				}
				save_event_target_as = racial_pop_migration_country
			}
			random_neighbor_country = {
				limit = {
					any_owned_province = {
						development = 20
					}
					medium_tolerance_elven_race_trigger = yes
				}
				save_event_target_as = racial_pop_migration_country
			}
			random_neighbor_country = {
				limit = {
					high_tolerance_elven_race_trigger = yes
				}
				save_event_target_as = racial_pop_migration_country
			}
			random_neighbor_country = {
				limit = {
					any_owned_province = {
						development = 20
					}
					high_tolerance_elven_race_trigger = yes
				}
				save_event_target_as = racial_pop_migration_country
			}
		}
	}
	
	option = {		#Adjacent
		name = racial_pop_events_elven.6.a
		trigger = {
			has_country_flag = racial_pop_migrate_adjacent
		}
		ai_chance = {
			factor = 50
		}
	
		event_target:racial_pop_province = {
			remove_elven_minority_size_effect = yes
		}
		
		#no this is for migration country no adjacents
		# event_target:racial_pop_migration_country = {
			# country_event = {
				# id = racial_pop_events_elven.7
				# days = 14
			# }
		# }
		
		clear_racial_pop_migration_flags = yes
	}
	
	option = {		#Within country
		name = racial_pop_events_elven.6.b
		trigger = {
			has_country_flag = racial_pop_migrate_within_country
		}
		ai_chance = {
			factor = 50
		}
		
		event_target:racial_pop_province = {
			remove_elven_minority_size_effect = yes
		}
		
		country_event = {
			id = racial_pop_events_elven.8
			days = 14
		}
		
		clear_racial_pop_migration_flags = yes
	}
	
	option = {		#Outside Country
		name = racial_pop_events_elven.6.c
		trigger = {
			has_country_flag = racial_pop_migrate_outside_country
		}
		ai_chance = {
			factor = 50
		}
		
		event_target:racial_pop_province = {
			remove_elven_minority_size_effect = yes
		}
		
		event_target:racial_pop_migration_country  = {	#what if my country is massive tho, maybe it reduces the chance if its bigger?
			country_event = {
				id = racial_pop_events_elven.9
				days = 14
			}
		}
		
		clear_racial_pop_migration_flags = yes
	}
}


#Pop Migrates - Adjacent
country_event = {
	id = racial_pop_events_elven.7
	title = racial_pop_events_elven.7.t
	desc = racial_pop_events_elven.7.d
	picture = CITY_eventPicture
	
	trigger = {
		# has_oppressed_elven_minority_trigger = yes
		# has_small_elven_minority_trigger = yes
		# OR = {
			# devastation = 33
			# unrest = 10
			# NOT = { development = 10 }
		# }

	}
	
	is_triggered_only = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {

	}
	
	option = {		#Large minority decreases to small
		name = racial_pop_events_elven.7.a
		trigger = {
			
		}
		ai_chance = {
			factor = 50
		}
	
		event_target:global_racial_pop_migration_province = {
			add_elven_minority_size_effect = yes
		}
		
		clr_global_flag  = global_racial_pop_migration_province
	}
	
	option = {		#Small minority is removed (becomes insignificant)
		name = racial_pop_events_elven.7.b
		trigger = {
		}
		ai_chance = {
			factor = 50
		}
	
		if = {
			limit = {
				event_target:global_racial_pop_migration_province = {
					limit = {
						has_large_elven_minority_trigger = yes
					}
				}
			}
			event_target:global_racial_pop_migration_province = {
				add_base_tax = 1
			}
		}
		
		clr_global_flag  = global_racial_pop_migration_province
	}
	
}


#Pop Migrates - Within Country
country_event = {
	id = racial_pop_events_elven.8
	title = racial_pop_events_elven.8.t
	desc = racial_pop_events_elven.8.d
	picture = CITY_eventPicture
	
	trigger = {
		# has_oppressed_elven_minority_trigger = yes
		# has_small_elven_minority_trigger = yes
		# OR = {
			# devastation = 33
			# unrest = 10
			# NOT = { development = 10 }
		# }

	}
	
	is_triggered_only = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					NOT = { devastation = 33 }
					NOT = { unrest = 10 }
					development = 10
				}
				save_event_target_as = racial_pop_province
			}
		
		}
	}
	
	option = {		
		name = racial_pop_events_elven.8.a
		trigger = {
			
		}
		ai_chance = {
			factor = 50
		}
	
		event_target:racial_pop_province = {
			add_elven_minority_size_effect = yes
		}
	}
	
}


#Pop Migrates - Outside Country
country_event = {
	id = racial_pop_events_elven.9
	title = racial_pop_events_elven.9.t
	desc = racial_pop_events_elven.9.d
	picture = CITY_eventPicture
	
	trigger = {

	}
	
	is_triggered_only = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		hidden_effect = {
			random_owned_province = {
				save_event_target_as = racial_pop_province
			}
			random_owned_province = {
				limit = {
					development = 10
				}
				save_event_target_as = racial_pop_province
			}
			random_owned_province = {
				limit = {
					development = 20
				}
				save_event_target_as = racial_pop_province
			}
		
		}
	}
	
	option = {		
		name = racial_pop_events_elven.9.a
		trigger = {
			
		}
		ai_chance = {
			factor = 50
		}
	
		event_target:racial_pop_province = {
			add_elven_minority_size_effect = yes
		}
		
	}
	
	option = {		
		name = racial_pop_events_elven.9.b
		trigger = {
			
		}
		ai_chance = {
			factor = 50
		}
	
		event_target:racial_pop_province = {
			add_elven_minority_size_effect = yes
		}
		
		if = {
			limit = {
				event_target:racial_pop_province = {
					limit = {
						has_large_elven_minority_trigger = yes
					}
				}
			}
			event_target:racial_pop_province = {
				add_base_tax = 1
			}
		}
	}
	
}