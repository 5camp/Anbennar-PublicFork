
namespace = flavor_krak
#1-50 mission related
#51-99 disaster
#99+ ice smiths and misc

#Missions
#midjurdr krat
country_event = {
	id = flavor_krak.1
	title = flavor_krak.1.t
	desc = flavor_krak.1.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = flavor_krak.1.a	
		4208 = { add_province_modifier = { name = krak_midjurdr_1 duration = 18250 } }
		ai_chance = { factor = 5 }
	}
	
	option = {
		name = flavor_krak.1.b
		4208 = { add_province_modifier = { name = krak_midjurdr_3 duration = 18250 } }
		ai_chance = { factor = 5 }
	}

	option = {
		name = flavor_krak.1.c
		4208 = { add_province_modifier = { name = krak_midjurdr_2 duration = 18250 } }
		ai_chance = { factor = 5 }
	}
}
#thundersteel
country_event = {
	id = flavor_krak.2
	title = flavor_krak.2.t
	desc = flavor_krak.2.d
	picture = ADVISOR_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = flavor_krak.2.a
		add_country_modifier = { name = krak_thundersteel duration = 18250 }
		4201 = {
			discover_country = ROOT
			add_permanent_claim = ROOT
		}
		4198 = {
			discover_country = ROOT
			add_permanent_claim = ROOT
		}
		4020 = {
			discover_country = ROOT
			add_permanent_claim = ROOT
		}
		ai_chance = { factor = 5 }
	}
}
#noble outrage
country_event = {
	id = flavor_krak.3
	title = flavor_krak.3.t
	desc = flavor_krak.3.d
	picture = REVOLT_HUNGARIAN_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = flavor_krak.3.a
		add_mil_power = -100
		4208 = { 
			add_devastation = 20
			spawn_rebels = {
				type = noble_rebels
				size = 0.9
			}
		}
		ai_chance = { factor = 5 }
	}
}
#dead end prospecting
country_event = {
	id = flavor_krak.4
	title = flavor_krak.4.t
	desc = flavor_krak.4.d
	picture = TRADE_GOODS_METALS_AND_MINING_EQUIPENT_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = flavor_krak.4.a
		dead_end_tunnel_area = {
			type = all
			remove_province_modifier = krak_prospecting
		}
		4209 = { #foul dark
			if = {
				limit = { 
					NOT = {
						trade_goods = iron
						trade_goods = mithril
						trade_goods = gold
						trade_goods = gems
					}
				}
				change_trade_goods = iron
			}
			add_base_tax = 1
			add_base_production = 2
			add_base_manpower = 1
			change_province_name = "Uristov"
			rename_capital = "Uristov"
		}
		4210 = { #stillness
			if = {
				limit = { 
					NOT = {
						trade_goods = iron
						trade_goods = mithril
						trade_goods = gold
						trade_goods = gems
					}
				}
				change_trade_goods = iron
			}
			add_base_tax = 1
			add_base_production = 2
			add_base_manpower = 1
			change_province_name = "Garlimstunad"
			rename_capital = "Garlimstunad"
		}
		4211 = { #abrupt end
			if = {
				limit = { 
					NOT = {
						trade_goods = mithril
						trade_goods = gold
						trade_goods = gems
					}
				}
				change_trade_goods = gems
			}
			add_base_tax = 1
			add_base_production = 2
			add_base_manpower = 1
			change_province_name = "Garlimstunad"
			rename_capital = "Garlimstunad"
		}
		ai_chance = { factor = 5 }
	}
}
#conflicts of interest
country_event = {
	id = flavor_krak.5
	title = flavor_krak.5.t
	desc = flavor_krak.5.d
	picture = RIOTING_workers_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = flavor_krak.5.a
		add_republican_tradition = -10
		dead_end_tunnel_area = {
			type = all
			add_province_modifier = { name = krak_anvil_conflicts duration = 7300 }
		}
		ai_chance = { factor = 5 }
	}
}
#disunity
country_event = {
	id = flavor_krak.6
	title = flavor_krak.6.t
	desc = flavor_krak.6.d
	picture = REVOLT_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = flavor_krak.6.a
		add_republican_tradition = -15
		add_country_modifier = { name = krak_disunity duration = 7300 }
		remove_country_modifier = krak_colonial_rush
		ai_chance = { factor = 5 }
	}
}
#massacre
country_event = {
	id = flavor_krak.7
	title = flavor_krak.7.t
	desc = flavor_krak.7.d
	picture = VILLAGE_BURNING_eventPicture
	
	is_triggered_only = yes
	
	immediate = { set_country_flag = krak_massacre_happened }

	option = {
		name = flavor_krak.7.a
		add_republican_tradition = -20
		add_manpower = -0.2
		add_prestige = -40
		3001 = { destroy_province = yes } 
		dagrinrod_13_15_area = {
			type = all
			limit = { NOT = { province_id = 3001 } }
			remove_claim = ROOT
		}
		orlazam_area = {
			type = all
			limit = { NOT = { province_id = 4147 } }
			remove_claim = ROOT
		}
		dagrinrod_7_9_area = {
			type = all
			remove_claim = ROOT
		}
		country_event = { id = elections.1000 }
		hidden_effect = {
			if = {
				limit = { has_country_flag = krak_conflicting_views_happened }
				set_country_flag = krak_disaster_can_start
			}
		}
		ai_chance = { factor = 5 }
	}
}
#conflicting views
country_event = {
	id = flavor_krak.8
	title = flavor_krak.8.t
	desc = flavor_krak.8.d
	picture = SIEGE_eventPicture
	
	is_triggered_only = yes
	
	immediate = { set_country_flag = krak_conflicting_views_happened }

	option = {
		name = flavor_krak.8.a
		add_republican_tradition = -20
		add_stability = -2
		amldihr_area = {
			type = all
			add_base_tax = -2
			add_base_production = -2
			add_base_manpower = -2
			add_devastation = 15
		}
		hidden_effect = {
			if = {
				limit = { has_country_flag = krak_massacre_happened }
				set_country_flag = krak_disaster_can_start
			}
		}
		ai_chance = { factor = 5 }
	}
}









#disaster




#ice smiths and misc
#magic menu
country_event = {
	id = flavor_krak.100
	title = flavor_krak.100.t
	desc = flavor_krak.100.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	option = {	#go back
		name = flavor_krak.100.a	
		highlight = yes
		if = { # Causes crashes on Linux
			limit = { ai = no }
			remove_estate_privilege = estate_mages_perform_icecraft 
		}
		else = {
			set_country_flag = revoke_mage_estate_spells
		}
		ai_chance = { factor = 5 }
	}
	
	option = {	#ice-steel equipment
		name = flavor_krak.100.b
		trigger = { has_country_flag = icecraft_equipment }
		country_event = { id = flavor_krak.101 }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				personality = ai_militarist
			}
		}
	}
	
	option = {	#ice drills
		name = flavor_krak.100.c
		trigger = { has_country_flag = icecraft_drills }
		country_event = { id = flavor_krak.102 }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				personality = ai_capitalist
			}
		}
	}
	
	option = {	#ice field
		name = flavor_krak.100.e
		trigger = { has_country_flag = icecraft_field }
		country_event = { id = flavor_krak.103 }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				is_at_war = yes
			}
		}
	}
	
	option = {	#frozen gems
		name = flavor_krak.100.f
		trigger = { has_country_flag = icecraft_gems }
		country_event = { id = flavor_krak.104 }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				personality = ai_capitalist
			}
		}
	}
	
	option = {	#infuse foundations
		name = flavor_krak.100.g
		trigger = { has_country_flag = icecraft_foundations }
		country_event = { id = flavor_krak.105 }
		ai_chance = { factor = 0 }
	}
}
#equipment
country_event = {
	id = flavor_krak.101
	title = flavor_krak.101.t
	desc = flavor_krak.101.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = magic_estate.goback
		country_event = { id = flavor_krak.100 }
		ai_chance = { factor = 5 }
	}

	option = {
		name = flavor_krak.101.a
		if = {
			limit = { has_country_flag = icecraft_equipment_upgrade }
			if = {
				limit = { 
					estate_influence = {
						estate = estate_mages
						influence = 66
					}
				}
				add_mil_power = -200
				if = {
					limit = { check_variable = { which = krak_discount_spell value = 1 } } 
					change_variable = { which = krak_discount_spell value = -1 }
				}
				else = { add_years_of_income = -0.7 }
				add_country_modifier = { name = krak_icecraft_equipment_6 duration = 3650  }
			}
			else_if = {
				limit = { 
					estate_influence = {
						estate = estate_mages
						influence = 33
					}
				}
				add_mil_power = -150
				if = {
					limit = { check_variable = { which = krak_discount_spell value = 1 } } 
					change_variable = { which = krak_discount_spell value = -1 }
				}
				else = { add_years_of_income = -0.5 }
				add_country_modifier = { name = krak_icecraft_equipment_5 duration = 3650  }
			}
			else = {
				add_mil_power = -100
				if = {
					limit = { check_variable = { which = krak_discount_spell value = 1 } } 
					change_variable = { which = krak_discount_spell value = -1 }
				}
				else = { add_years_of_income = -0.3 }
				add_country_modifier = { name = krak_icecraft_equipment_4 duration = 3650  }
			}
		}
		else = {
			if = {
				limit = { 
					estate_influence = {
						estate = estate_mages
						influence = 66
					}
				}
				add_mil_power = -200
				if = {
					limit = { check_variable = { which = krak_discount_spell value = 1 } } 
					change_variable = { which = krak_discount_spell value = -1 }
				}
				else = { add_years_of_income = -0.7 }
				add_country_modifier = { name = krak_icecraft_equipment_3 duration = 3650  }
			}
			else_if = {
				limit = { 
					estate_influence = {
						estate = estate_mages
						influence = 33
					}
				}
				add_mil_power = -150
				if = {
					limit = { check_variable = { which = krak_discount_spell value = 1 } } 
					change_variable = { which = krak_discount_spell value = -1 }
				}
				else = { add_years_of_income = -0.5 }
				add_country_modifier = { name = krak_icecraft_equipment_2 duration = 3650  }
			}
			else = { 
				add_mil_power = -100
				if = {
					limit = { check_variable = { which = krak_discount_spell value = 1 } } 
					change_variable = { which = krak_discount_spell value = -1 }
				}
				else = { add_years_of_income = -0.5 }
				add_country_modifier = { name = krak_icecraft_equipment_1 duration = 3650  } 
			}
		}
		ai_will_do = { factor = 50 }
	}
}
#drills
country_event = {
	id = flavor_krak.102
	title = flavor_krak.102.t
	desc = flavor_krak.102.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = magic_estate.goback
		country_event = { id = flavor_krak.100 }
		ai_chance = { factor = 5 }
	}

	option = {
		name = flavor_krak.102.a
		if = {
			limit = { 
				estate_influence = {
					estate = estate_mages
					influence = 66
				}
			}
			add_adm_power = -150
			if = {
				limit = { check_variable = { which = krak_discount_spell value = 1 } } 
				change_variable = { which = krak_discount_spell value = -1 }
			}
			else = { add_years_of_income = -0.5 }
			every_owned_province = {
				limit = {
					is_core = ROOT
					province_with_mineable_goods = yes
				}
				add_province_modifier = { name = krak_icecraft_drills_3 duration = 3650 }
			}
		}
		else_if = {
			limit = { 
				estate_influence = {
					estate = estate_mages
					influence = 33
				}
			}
			add_adm_power = -100
			if = {
				limit = { check_variable = { which = krak_discount_spell value = 1 } } 
				change_variable = { which = krak_discount_spell value = -1 }
			}
			else = { add_years_of_income = -0.35 }
			every_owned_province = {
				limit = {
					is_core = ROOT
					province_with_mineable_goods = yes
				}
				add_province_modifier = { name = krak_icecraft_drills_2 duration = 3650 }
			}
		}
		else = {
			add_adm_power = -50
			if = {
				limit = { check_variable = { which = krak_discount_spell value = 1 } } 
				change_variable = { which = krak_discount_spell value = -1 }
			}
			else = { add_years_of_income = -0.2 }
			every_owned_province = {
				limit = {
					is_core = ROOT
					province_with_mineable_goods = yes
				}
				add_province_modifier = { name = krak_icecraft_drills_1 duration = 3650 }
			}
		}
		ai_will_do = { factor = 50 }
	}
}

#icefield
country_event = {
	id = flavor_krak.103
	title = flavor_krak.103.t
	desc = flavor_krak.103.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = magic_estate.goback
		country_event = { id = flavor_krak.100 }
		ai_chance = { factor = 5 }
	}

	#northpass
	option = {
		name = flavor_krak.103.a
		trigger = {
			4175 = { has_building = mage_tower owned_by = ROOT }
			4181 = { has_building = mage_tower owned_by = ROOT }
			4194 = { has_building = mage_tower owned_by = ROOT }
			4197 = { has_building = mage_tower owned_by = ROOT }
			4200 = { has_building = mage_tower owned_by = ROOT }
			4190 = { has_building = mage_tower owned_by = ROOT }
			4184 = { has_building = mage_tower owned_by = ROOT }
		}
		northern_pass_region = { 
			limit = { owned_by = ROOT }
			add_province_modifier = { name = krak_icefield duration = 3650 }
		}
		ai_will_do = {
			factor = 10
			modifier = {
				factor = 100
				any_owned_province = {
					region = northern_pass_region
					NOT = { controlled_by = ROOT }
				}
			}
		}
	}
	#west dwarovar
	option = {
		name = flavor_krak.103.b
		trigger = {
			num_of_owned_provinces_with = {
				region = west_dwarovar_region
				has_building = mage_tower
				value = 12
			}
		}
		west_dwarovar_region = { 
			limit = { owned_by = ROOT }
			add_province_modifier = { name = krak_icefield duration = 3650 }
		}
		ai_will_do = {
			factor = 10
			modifier = {
				factor = 100
				any_owned_province = {
					region = west_dwarovar_region
					NOT = { controlled_by = ROOT }
				}
			}
		}
	}
	#serpentreach
	option = {
		name = flavor_krak.103.c
		trigger = {
			num_of_owned_provinces_with = {
				region = serpentreach_region
				has_building = mage_tower
				value = 8
			}
		}
		serpentreach_region = { 
			limit = { owned_by = ROOT }
			add_province_modifier = { name = krak_icefield duration = 3650 }
		}
		ai_will_do = {
			factor = 10
			modifier = {
				factor = 100
				any_owned_province = {
					region = serpentreach_region
					NOT = { controlled_by = ROOT }
				}
			}
		}
	}
	#middle 
	option = {
		name = flavor_krak.103.e
		trigger = {
			num_of_owned_provinces_with = {
				region = middle_dwarovar_region
				has_building = mage_tower
				value = 9
			}
		}
		middle_dwarovar_region = { 
			limit = { owned_by = ROOT }
			add_province_modifier = { name = krak_icefield duration = 3650 }
		}
		ai_will_do = {
			factor = 10
			modifier = {
				factor = 100
				any_owned_province = {
					region = middle_dwarovar_region
					NOT = { controlled_by = ROOT }
				}
			}
		}
	}
	#tree 
	option = {
		name = flavor_krak.103.f
		trigger = {
			num_of_owned_provinces_with = {
				region = tree_of_stone_region
				has_building = mage_tower
				value = 7
			}
		}
		tree_of_stone_region = { 
			limit = { owned_by = ROOT }
			add_province_modifier = { name = krak_icefield duration = 3650 }
		}
		ai_will_do = {
			factor = 10
			modifier = {
				factor = 100
				any_owned_province = {
					region = tree_of_stone_region
					NOT = { controlled_by = ROOT }
				}
			}
		}
	}
	#jade
	option = {
		name = flavor_krak.103.g
		trigger = {
			num_of_owned_provinces_with = {
				region = jade_mines_region
				has_building = mage_tower
				value = 6
			}
		}
		jade_mines_region = { 
			limit = { owned_by = ROOT }
			add_province_modifier = { name = krak_icefield duration = 3650 }
		}
		ai_will_do = {
			factor = 10
			modifier = {
				factor = 100
				any_owned_province = {
					region = jade_mines_region
					NOT = { controlled_by = ROOT }
				}
			}
		}
	}
}

#frozengems
country_event = {
	id = flavor_krak.104
	title = flavor_krak.104.t
	desc = flavor_krak.104.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = magic_estate.goback
		country_event = { id = flavor_krak.100 }
		ai_chance = { factor = 5 }
	}

	option = {
		name = flavor_krak.104.a
		if = {
			limit = { has_country_flag = icecraft_gems_upgrade }
			if = {
				limit = { 
					estate_influence = {
						estate = estate_mages
						influence = 66
					}
				}
				add_country_modifier = { name = krak_frozengems_6 duration = 3650  }
			}
			else_if = {
				limit = {
					estate_influence = {
						estate = estate_mages
						influence = 33
					}
				}
				add_country_modifier = { name = krak_frozengems_5 duration = 3650  }
			}
			else = { add_country_modifier = { name = krak_frozengems_4 duration = 3650  } }
		}
		if = {
			limit = { 
				estate_influence = {
					estate = estate_mages
					influence = 66
				}
			}
			add_dip_power = -150
			if = {
				limit = { check_variable = { which = krak_discount_spell value = 1 } } 
				change_variable = { which = krak_discount_spell value = -1 }
			}
			else = { add_years_of_income = -0.8 }
			every_owned_province = {
				limit = {
					is_core = ROOT
					trade_goods = gems
				}
				add_province_modifier = { name = krak_frozengems_3 duration = 3650 }
			}
		}
		else_if = {
			limit = { 
				estate_influence = {
					estate = estate_mages
					influence = 33
				}
			}
			add_dip_power = -100
			if = {
				limit = { check_variable = { which = krak_discount_spell value = 1 } } 
				change_variable = { which = krak_discount_spell value = -1 }
			}
			else = { add_years_of_income = -0.55 }
			every_owned_province = {
				limit = {
					is_core = ROOT
					trade_goods = gems
				}
				add_province_modifier = { name = krak_frozengems_2 duration = 3650 }
			}
		}
		else = { 
			add_dip_power = -50
			if = {
				limit = { check_variable = { which = krak_discount_spell value = 1 } } 
				change_variable = { which = krak_discount_spell value = -1 }
			}
			else = { add_years_of_income = -0.5 }
			every_owned_province = {
				limit = {
					is_core = ROOT
					trade_goods = gems
				}
				add_province_modifier = { name = krak_frozengems_1 duration = 3650 }
			}
		}
	}
	ai_will_do = { factor = 50 }
}

#foundations
country_event = {
	id = flavor_krak.105
	title = flavor_krak.105.t
	desc = flavor_krak.105.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	immediate = { krak_pick_holds_for_foundations = yes }

	option = {
		name = magic_estate.goback
		country_event = { id = flavor_krak.100 }
		ai_chance = { factor = 5 }
	}

	option = {
		name = flavor_krak.105.a
		trigger = { has_saved_event_target = candidate_1 }
		goto = candidate_1
		krak_foundation_cost = yes
		event_target:candidate_1 = { add_province_modifier = { name = krak_icesteel_foundations duration = -1 } }
	}
	option = {
		name = flavor_krak.105.b
		trigger = { has_saved_event_target = candidate_2 }
		goto = candidate_2
		krak_foundation_cost = yes
		event_target:candidate_2 = { add_province_modifier = { name = krak_icesteel_foundations duration = -1 } }
	}
	option = {
		name = flavor_krak.105.c
		trigger = { has_saved_event_target = candidate_3 }
		goto = candidate_3
		krak_foundation_cost = yes
		event_target:candidate_3 = { add_province_modifier = { name = krak_icesteel_foundations duration = -1 } }
	}
	option = {
		name = flavor_krak.105.e
		trigger = { has_saved_event_target = candidate_4 }
		goto = candidate_4
		krak_foundation_cost = yes
		event_target:candidate_4 = { add_province_modifier = { name = krak_icesteel_foundations duration = -1 } }
	}
	option = {
		name = flavor_krak.105.f
		trigger = { has_saved_event_target = candidate_5 }
		goto = candidate_5
		krak_foundation_cost = yes
		event_target:candidate_5 = { add_province_modifier = { name = krak_icesteel_foundations duration = -1 } }
	}
	option = {
		name = flavor_krak.105.g
		trigger = { has_saved_event_target = candidate_6 }
		goto = candidate_6
		krak_foundation_cost = yes
		event_target:candidate_6 = { add_province_modifier = { name = krak_icesteel_foundations duration = -1 } }
	}
	option = {
		name = flavor_krak.105.h
		trigger = { has_saved_event_target = candidate_7 }
		goto = candidate_7
		krak_foundation_cost = yes
		event_target:candidate_7 = { add_province_modifier = { name = krak_icesteel_foundations duration = -1 } }
	}
	option = {
		name = flavor_krak.105.i
		trigger = { has_saved_event_target = candidate_8 }
		goto = candidate_8
		krak_foundation_cost = yes
		event_target:candidate_8 = { add_province_modifier = { name = krak_icesteel_foundations duration = -1 } }
	}
	option = {
		name = flavor_krak.105.j
		trigger = { has_saved_event_target = candidate_9 }
		goto = candidate_9
		krak_foundation_cost = yes
		event_target:candidate_9 = { add_province_modifier = { name = krak_icesteel_foundations duration = -1 } }
	}
	option = {
		name = flavor_krak.105.k
		trigger = { has_saved_event_target = candidate_10 }
		goto = candidate_10
		krak_foundation_cost = yes
		event_target:candidate_10 = { add_province_modifier = { name = krak_icesteel_foundations duration = -1 } }
	}

	after = { every_owned_province = { clr_province_flag = foundation_candidate } }
}