namespace = magic_siege

#Magic Menu
country_event = {
	id = magic_siege.1
	title = magic_siege.1.t	#Have this title mention the target
	desc = magic_siege.1.d
	picture = INVENTION_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		random_province = {
			limit = {
				sieged_by = ROOT
				unit_has_leader = yes
				fort_level = 1
				num_of_units_in_province = {
					who = ROOT
					amount = 1
				}
			}
			save_global_event_target_as = spell_target_province	#this works yo
		}
	}
	
	option = {	
		name = magic_siege.1.a	#go back
		ai_chance = {
			factor = 50
		}
		#some sort of tooltip
	}
	
	option = {	
		name = magic_siege.c1.t
		ai_chance = {
			factor = 50
		}
		country_event = { id = magic_siege.c1 days = 0 }
	}
	
	option = {	
		name = magic_siege.3.t
		ai_chance = {
			factor = 50
		}
		country_event = { id = magic_siege.e1 days = 0 }
	}
	
	option = {	
		name = magic_siege.4.t
		ai_chance = {
			factor = 50
		}
		country_event = { id = magic_siege.4 days = 0 }
	}
	
	option = {	
		name = magic_siege.5.t
		ai_chance = {
			factor = 50
		}
		country_event = { id = magic_siege.5 days = 0 }
	}
}

#Conjuration

#Summon Siege Elemental
country_event = {
	id = magic_siege.c1
	title = magic_siege.c1.t
	desc = magic_siege.c1.d
	picture = INVENTION_eventPicture
	
	is_triggered_only = yes
	
	option = {	#Test Spell
		name = magic_siege.c1.a
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.8
				NOT = { years_of_income = 0.125 }
			}
		}
		
		event_target:spell_target_province = { 
			change_siege = 1	#if possible
		}
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 50
		}
		country_event = { id = magic_siege.1 days = 0 }
	}
	
}


#Enchantment

#Dominate Surrender
country_event = {
	id = magic_siege.e1
	title = magic_siege.e1.t
	desc = magic_siege.e1.d
	picture = INVENTION_eventPicture
	
	is_triggered_only = yes
	
	immediate = {

	}
	
	option = {	#Test Spell
		name = magic_siege.e1.a
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.8
				NOT = { years_of_income = 0.125 }
			}
		}
		
		#Costs
		if = {
			limit = {
				event_target:spell_target_province = {
					base_manpower = 1
					NOT = { base_manpower = 4 }
				}
			}
			add_adm_power = -5
			add_dip_power = -5
			add_mil_power = -20
			
			random_list = {
				80 = {
					event_target:spell_target_province = { 
						change_controller = ROOT
					}
				}
				20 = {
				
				}
			}
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					base_manpower = 4
					NOT = { base_manpower = 8 }
				}
			}
			add_adm_power = -10
			add_dip_power = -10
			add_mil_power = -30
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					base_manpower = 8
					NOT = { base_manpower = 12 }
				}
			}
			add_adm_power = -15
			add_dip_power = -15
			add_mil_power = -40
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					base_manpower = 12
					NOT = { base_manpower = 16 }
				}
			}
			add_adm_power = -20
			add_dip_power = -20
			add_mil_power = -50
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					base_manpower = 16
					NOT = { base_manpower = 20 }
				}
			}
			add_adm_power = -25
			add_dip_power = -25
			add_mil_power = -60
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					base_manpower = 20
					NOT = { base_manpower = 24 }
				}
			}
			add_adm_power = -30
			add_dip_power = -30
			add_mil_power = -70
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					base_manpower = 24
					NOT = { base_manpower = 28 }
				}
			}
			add_adm_power = -35
			add_dip_power = -35
			add_mil_power = -80
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					base_manpower = 28
					NOT = { base_manpower = 32 }
				}
			}
			add_adm_power = -40
			add_dip_power = -40
			add_mil_power = -90
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					base_manpower = 32
				}
			}
			add_adm_power = -45
			add_dip_power = -45
			add_mil_power = -100
		}
		
		
		event_target:spell_target_province = { 
			change_controller = ROOT
		}
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 50
		}
				event_target:spell_target_province = { 
					change_siege = 1	#if possible
				}
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 50
		}
				event_target:spell_target_province = { 
					change_siege = 10	#if possible
				}
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 50
		}
				event_target:spell_target_province = { 
					change_siege = 30	#if possible
				}
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 50
		}
		country_event = { id = magic_siege.1 days = 0 }
	}
	
}