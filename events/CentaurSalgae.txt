namespace = salgae

#Setup event
country_event = {
	id = salgae.1
	title = salgae.1.t
	desc = salgae.1.d
	picture = RELIGION_eventPicture

	is_triggered_only = yes
	fire_only_once = yes
	hidden = yes

	trigger = {
		always = yes
	}
	
	immediate = { hidden_effect = { set_country_flag = the_salgae_start } }
	
	option = {
		name = salgae.1.a
		ai_chance = { factor = 1 }
		capital_scope = { region = { set_province_flag = capital_region } }
		if = {
			limit = { NOT = { has_country_flag = burning_spear_flag } }
			random_owned_province = {
				limit = {
					NOT = { has_province_flag = capital_region }
					NOT = { has_province_flag = marked_region }
					OR = {
						region = east_forbidden_plains_region
						region = west_forbidden_plains_region
						region = serpent_gift_region
						region = ogre_mountains_region
						region = yyl_moista_region
					}
				}
				region = {
					set_province_flag = marked_region
					set_province_flag = burning_spear_region
				}
			}
		}
		if = {
			limit = { NOT = { has_country_flag = verdant_bliss_flag } }
			random_owned_province = {
				limit = {
					NOT = { has_province_flag = capital_region }
					NOT = { has_province_flag = marked_region }
					OR = {
						region = east_forbidden_plains_region
						region = west_forbidden_plains_region
						region = serpent_gift_region
						region = ogre_mountains_region
						region = yyl_moista_region
					}
				}
				region = {
					set_province_flag = marked_region
					set_province_flag = verdant_bliss_region
				}
			}
		}
		if = {
			limit = { NOT = { has_country_flag = tiger_bane_flag } }
			random_owned_province = {
				limit = {
					NOT = { has_province_flag = capital_region }
					NOT = { has_province_flag = marked_region }
					OR = {
						region = east_forbidden_plains_region
						region = west_forbidden_plains_region
						region = serpent_gift_region
						region = ogre_mountains_region
						region = yyl_moista_region
					}
				}
				region = {
					set_province_flag = marked_region
					set_province_flag = tiger_bane_region
				}
			}
		}
		country_event = { id = salgae.2 }
	}
}

#Loss of faith in the leader
country_event = {
	id = salgae.2
	title = salgae.2.t
	desc = salgae.2.d
	picture = RELIGION_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		always = yes
	}
	
	option = {
		name = salgae.2.a
		ai_chance = { factor = 100 }
		add_stability = -1
		remove_country_modifier = centaur_unification_zeal
		country_event = { id = salgae.3 days = 260 }
	}
}

#The Burning Spear
country_event = {
	id = salgae.3
	title = salgae.3.t
	desc = salgae.3.d
	picture = RELIGION_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		has_disaster = the_salgae
	}
	
	option = {
		name = salgae.3.a
		ai_chance = { factor = 100 }
		add_stability = -1
		add_disaster_modifier = {
			name = the_salgae_war
			duration = 3650
		}
		custom_tooltip = burning_spear_rebellion_tooltip
		hidden_effect = {
			if = {
				limit = { has_country_flag = burning_spear_flag }
				every_owned_province = {
					limit = { has_province_modifier = centaur_burning_spear_territory }
					add_core = I91
				}
				release = I91
			}
			else = {
				every_owned_province = {
					limit = { has_province_flag = burning_spear_region }
					clr_province_flag = burning_spear_region
					clr_province_flag = marked_region
					add_core = I91
				}
				release = I91
				I91 = {
					random_owned_province = {
						limit = { any_neighbor_province = { owned_by = I89 NOT = { has_province_flag = capital_region } } }
						random_neighbor_province = {
							limit = { owned_by = I89 NOT = { has_province_flag = capital_region } }
							region = { limit = { owned_by = I89 } add_core = I91 cede_province = I91 }
						}
					}
				}
			}
			I91 = {
				change_technology_group  = tech_centaur
				change_religion = ik_magthaal
				change_government = tribal
				add_government_reform = centaur_settled
				country_event = { id = salgae.100 days = 30 }
				add_yearly_manpower = 10
				add_years_of_income = 15
			}
			declare_war_with_cb = {
				who = I91
				casus_belli = cb_salgae
			}
			country_event = { id = salgae.4 days = 90 random = 20 }
			set_country_flag = burning_spear_revolt
			remove_faction = burning_spear
		}
	}
	option = {
		name = salgae.3.b
		ai_chance = { factor = 0 }
		add_stability = -1
		custom_tooltip = centaur_switch_country_tooltip
		hidden_effect = {
			if = {
				limit = { has_country_flag = burning_spear_flag }
				every_owned_province = {
					limit = { has_province_modifier = centaur_burning_spear_territory }
					add_core = I91
				}
				release = I91
			}
			else = {
				every_owned_province = {
					limit = { has_province_flag = burning_spear_region }
					clr_province_flag = burning_spear_region
					clr_province_flag = marked_region
					add_core = I91
				}
				release = I91
				I91 = {
					random_owned_province = {
						limit = { any_neighbor_province = { owned_by = I89 NOT = { has_province_flag = capital_region } } }
						random_neighbor_province = {
							limit = { owned_by = I89 NOT = { has_province_flag = capital_region } }
							region = { limit = { owned_by = I89 } add_core = I91 cede_province = I91 }
						}
					}
				}
			}
			I91 = {
				change_technology_group  = tech_centaur
				change_religion = ik_magthaal
				change_government = tribal
				add_government_reform = centaur_settled
				country_event = { id = salgae.100 days = 30 }
				add_yearly_manpower = 10
				add_years_of_income = 15
			}
			declare_war_with_cb = {
				who = I91
				casus_belli = cb_salgae
			}
			country_event = { id = salgae.4 days = 90 random = 20 }
			set_country_flag = burning_spear_revolt
			remove_faction = burning_spear
		}
		switch_tag = I91
	}
}


#The Verdant Bliss
country_event = {
	id = salgae.4
	title = salgae.4.t
	desc = salgae.4.d
	picture = RELIGION_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		has_disaster = the_salgae
	}
	
	option = {
		name = salgae.4.a
		ai_chance = { factor = 100 }
		add_stability = -1
		custom_tooltip = verdant_bliss_rebellion_tooltip
		hidden_effect = {
			if = {
				limit = { has_country_flag = verdant_bliss_flag }
				every_owned_province = {
					limit = { has_province_modifier = centaur_verdant_bliss_territory }
					add_core = I92
				}
				release = I92
			}
			else = {
				every_owned_province = {
					limit = { has_province_flag = verdant_bliss_region }
					clr_province_flag = verdant_bliss_region
					clr_province_flag = marked_region
					add_core = I92
				}
				release = I92
				I92 = {
					random_owned_province = {
						limit = { any_neighbor_province = { owned_by = I89 NOT = { has_province_flag = capital_region } } }
						random_neighbor_province = {
							limit = { owned_by = I89 NOT = { has_province_flag = capital_region } }
							region = { limit = { owned_by = I89 } add_core = I92 cede_province = I92 }
						}
					}
				}
			}
			I92 = {
				change_technology_group  = tech_centaur
				change_religion = ik_magthaal
				change_government = tribal
				add_government_reform = centaur_settled
				country_event = { id = salgae.100 days = 30 }
				declare_war_with_cb = {
					who = I91
					casus_belli = cb_salgae
				}
				add_yearly_manpower = 10
				add_years_of_income = 15
			}
			declare_war_with_cb = {
				who = I92
				casus_belli = cb_salgae
			}
			country_event = { id = salgae.5 days = 120 random = 50 }
			set_country_flag = verdant_bliss_revolt
			remove_faction = verdant_bliss
		}
	}
	option = {
		name = salgae.4.b
		ai_chance = { factor = 0 }
		add_stability = -1
		custom_tooltip = centaur_switch_country_tooltip
		hidden_effect = {
			if = {
				limit = { has_country_flag = verdant_bliss_flag }
				every_owned_province = {
					limit = { has_province_modifier = centaur_verdant_bliss_territory }
					add_core = I92
				}
				release = I92
			}
			else = {
				every_owned_province = {
					limit = { has_province_flag = verdant_bliss_region }
					clr_province_flag = verdant_bliss_region
					clr_province_flag = marked_region
					add_core = I92
				}
				release = I92
				I92 = {
					random_owned_province = {
						limit = { any_neighbor_province = { owned_by = I89 NOT = { has_province_flag = capital_region } } }
						random_neighbor_province = {
							limit = { owned_by = I89 NOT = { has_province_flag = capital_region } }
							region = { limit = { owned_by = I89 } add_core = I92 cede_province = I92 }
						}
					}
				}
			}
			I92 = {
				change_technology_group  = tech_centaur
				change_religion = ik_magthaal
				change_government = tribal
				add_government_reform = centaur_settled
				country_event = { id = salgae.100 days = 30 }
				declare_war_with_cb = {
					who = I91
					casus_belli = cb_salgae
				}
				add_yearly_manpower = 10
				add_years_of_income = 15
			}
			declare_war_with_cb = {
				who = I92
				casus_belli = cb_salgae
			}
			country_event = { id = salgae.5 days = 120 random = 50 }
			set_country_flag = verdant_bliss_revolt
			remove_faction = verdant_bliss
		}
		switch_tag = I92
	}
}

#The Tiger Bane
country_event = {
	id = salgae.5
	title = salgae.5.t
	desc = salgae.5.d
	picture = RELIGION_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		has_disaster = the_salgae
	}
	
	option = {
		name = salgae.5.a
		ai_chance = { factor = 100 }
		add_stability = -1
		custom_tooltip = tiger_bane_rebellion_tooltip
		hidden_effect = {
			if = {
				limit = { has_country_flag = tiger_bane_flag }
				every_owned_province = {
					limit = { has_province_modifier = centaur_tiger_bane_territory }
					add_core = I93
				}
				release = I93
			}
			else = {
				every_owned_province = {
					limit = { has_province_flag = tiger_bane_region }
					clr_province_flag = tiger_bane_region
					clr_province_flag = marked_region
					add_core = I93
				}
				release = I93
				I93 = {
					random_owned_province = {
						limit = { any_neighbor_province = { owned_by = I89 NOT = { has_province_flag = capital_region } } }
						random_neighbor_province = {
							limit = { owned_by = I89 NOT = { has_province_flag = capital_region } }
							region = { limit = { owned_by = I89 } add_core = I93 cede_province = I93 }
						}
					}
				}
			}
			I93 = {
				change_technology_group  = tech_centaur
				change_religion = ik_magthaal
				change_government = tribal
				add_government_reform = centaur_settled
				country_event = { id = salgae.100 days = 30 }
				declare_war_with_cb = {
					who = I91
					casus_belli = cb_salgae
				}
				declare_war_with_cb = {
					who = I92
					casus_belli = cb_salgae
				}
				add_yearly_manpower = 10
				add_years_of_income = 15
			}
			declare_war_with_cb = {
				who = I93
				casus_belli = cb_salgae
			}
			#country_event = { id = salgae.6 days = 120 random = 50 }
			set_country_flag = tiger_bane_revolt
			remove_faction = tiger_bane
		}
	}
	option = {
		name = salgae.5.b
		ai_chance = { factor = 0 }
		add_stability = -1
		custom_tooltip = centaur_switch_country_tooltip
		hidden_effect = {
			if = {
				limit = { has_country_flag = tiger_bane_flag }
				every_owned_province = {
					limit = { has_province_modifier = centaur_tiger_bane_territory }
					add_core = I93
				}
				release = I93
			}
			else = {
				every_owned_province = {
					limit = { has_province_flag = tiger_bane_region }
					clr_province_flag = tiger_bane_region
					clr_province_flag = marked_region
					add_core = I93
				}
				release = I93
				I93 = {
					random_owned_province = {
						limit = { any_neighbor_province = { owned_by = I89 NOT = { has_province_flag = capital_region } } }
						random_neighbor_province = {
							limit = { owned_by = I89 NOT = { has_province_flag = capital_region } }
							region = { limit = { owned_by = I89 } add_core = I93 cede_province = I93 }
						}
					}
				}
			}
			I93 = {
				change_technology_group  = tech_centaur
				change_religion = ik_magthaal
				change_government = tribal
				add_government_reform = centaur_settled
				country_event = { id = salgae.100 days = 30 }
				declare_war_with_cb = {
					who = I91
					casus_belli = cb_salgae
				}
				declare_war_with_cb = {
					who = I92
					casus_belli = cb_salgae
				}
			}
			declare_war_with_cb = {
				who = I93
				casus_belli = cb_salgae
			}
			#country_event = { id = salgae.6 days = 120 random = 50 }
			set_country_flag = tiger_bane_revolt
			remove_faction = tiger_bane
		}
		switch_tag = I93
	}
}

country_event = {
	id = salgae.6
	title = salgae.6.t
	desc = salgae.6.d
	picture = RELIGION_eventPicture

	is_triggered_only = yes

	trigger = {
		always = yes
	}
	
	option = {
		name = salgae.6.a
		ai_chance = { factor = 100 }
		add_stability = 3
		hidden_effect = { set_country_flag = the_salgae_end }
	}
}

##################
### Background event
#################
country_event = {
	id = salgae.100
	title = salgae.100.t
	desc = salgae.100.d
	picture = RELIGION_eventPicture

	is_triggered_only = yes

	trigger = {
		always = yes
	}
	
	option = {
		name = salgae.100.a
		ai_chance = { factor = 100 }
		hidden_effect = { change_technology_group  = tech_centaur }
		add_country_modifier = {
			name = centaur_salgae_war
			duration = 7300
		}
		capital_scope = {
			build_to_forcelimit = {
				cavalry = 0.75
				artillery = 0.15
			}
		}
		add_yearly_manpower = 10
		add_years_of_income = 15
		create_general = { tradition = 40 }
		create_general = { tradition = 55 }
		create_general = { tradition = 80 }
	}
}

country_event = {
	id = salgae.101
	title = salgae.101.t
	desc = salgae.101.d
	picture = RELIGION_eventPicture

	is_triggered_only = yes
	hidden = yes

	trigger = {
		always = yes
	}
	
	option = {
		name = salgae.100.a
		ai_chance = { factor = 100 }
		export_to_variable = {
			which = treasuryAvailable
			value = treasury
			who = ROOT
		}
		export_to_variable = {
			which = manpowerAvailable
			value = manpower
			who = ROOT
		}
		currency_effect = { currency=treasury takeFrom=ROOT addTo=FROM which=treasuryAvailable }
		currency_effect = { currency=manpower takeFrom=ROOT addTo=FROM which=manpowerAvailable }
		every_owned_province = {
			cede_province = FROM
		}
	}
}



