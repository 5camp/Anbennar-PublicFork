########################################
# Raj Events                         #
########################################

namespace = rahenraj

# The DYNASTYNAME raja_reform has fallen!
province_event = {
	id = rahenraj.1
	title = "rahenraj.1.t"
	picture = COURT_eventPicture
	
	major = yes
	is_triggered_only = yes
	
	desc = {
		trigger = {
			owner = { has_reform = raja_reform }
			FROM = {
				has_reform = raja_reform
			}
		}
		desc = rahenraj.1.da
	}
	
	desc = {
		trigger = {
			owner = { has_reform = raja_reform }
			FROM = {
				NOT = { has_reform = raja_reform }
			}
		}
		desc = rahenraj.1.db
	}
	
	desc = {
		trigger = {
			owner = {
				NOT = { has_reform = raja_reform }
			}
		}
		desc = rahenraj.1.dc
	}
	
	trigger = {
		province_id = 4411
	}
	
	immediate = {
		hidden_effect = {
			owner = {
				if = {
					limit = {
						OR = {
							has_reform = jamindar_reform
						}
					}
					add_core = 4411
					set_capital = 4411
					add_government_reform = raja_reform
					save_event_target_as = new_raja_reform
				}
			}
		}
	}
	
	option = {
		name = rahenraj.a
		if = {
			limit = {
				owner = { has_reform = raja_reform }
			}
			custom_tooltip = claiming_the_raja_reform_tooltip
		}
		hidden_effect = {
			if = {
				limit = {
					exists = FROM
					owner = { has_reform = raja_reform }
					FROM = { has_reform = raja_reform }
				}
				FROM = {
					free_vassal = PREV
				}
				FROM = {
					every_subject_country = {
						limit = {
							OR = {
								has_reform = jamindar_reform
							}
							NOT = { war_with = event_target:new_raja_reform }
						}
						event_target:new_raja_reform = {
							vassalize = PREV
						}
					}
					every_subject_country = {
						limit = {
							OR = {
								has_reform = jamindar_reform
							}
							war_with = event_target:new_raja_reform
						}
						from = {
							free_vassal = prev
						}
						if = {
							limit = {
								NOT = { has_reform = indep_jamindar_reform }
							}
							add_government_reform = indep_jamindar_reform
						}
					}
					if = {
						limit = {
							has_dlc = "Dharma"
						}
						add_government_reform = indep_jamindar_reform
					}
					else = {
						set_legacy_government = indep_daimyo_legacy
					}
				}
			}
			if = {
				limit = {
					exists = FROM
					NOT = { owner = { has_reform = raja_reform } }
					FROM = { has_reform = raja_reform }
				}
				FROM = {
					every_subject_country = {
						limit = {
							OR = {
								has_reform = jamindar_reform
							}
						}
						FROM = {
							free_vassal = PREV
						}
					}
					add_government_reform = indep_jamindar_reform
				}
			}
			if = {
				limit = {
					NOT = { exists = FROM }
					owner = { has_reform = raja_reform }
				}
				every_country = {
					limit = {
						has_reform = daimyo
						NOT = { war_with = event_target:new_raja_reform }
					}
					event_target:new_raja_reform = {
						vassalize = PREV
					}
				}
				every_country = {
					limit = {
						has_reform = jamindar_reform
						war_with = event_target:new_raja_reform
					}
					add_government_reform = indep_jamindar_reform
				}
			}
			if = {
				limit = {
					NOT = { exists = FROM }
					NOT = {
						owner = { has_reform = raja_reform }
					}
				}
				every_country = {
					limit = { has_reform = jamindar_reform }
					overlord = {
						free_vassal = PREV
					}
				}
			}
		}
		if = {
			limit = {
				NOT = {
					owner = { has_reform = raja_reform }
				}
			}
			owner = {
				if = {
					limit = { NOT = { has_country_flag = destroyed_raja_reform } }
					add_prestige = 20
					add_adm_power = 50
					add_dip_power = 50
					add_mil_power = 50
					set_country_flag = destroyed_raja_reform
				}
			}
		}
		hidden_effect = {
			if = {
				limit = {
					any_country = {
						is_subject_of_type = daimyo_vassal
						NOT = { overlord = { has_reform = raja_reform } }
					}
				}
				every_country = {
					limit = {
						is_subject_of_type = daimyo_vassal
						NOT = { overlord = { has_reform = raja_reform } }
					}
					overlord = {
						free_vassal = PREV
					}
				}
			}
		}
	}
}

#A Senapti Falls
country_event = {
	id = rahenraj.2
	title = rahenraj.2.t
	desc = rahenraj.2.d
	picture = FORT_eventPicture
	
	trigger = {
		OR = {
			AND = {
				is_subject_of_type = great_daimyo_vassal
				OR = {
					NOT = { num_of_cities = 2 }
					NOT = { ruler_culture = west_harimari ruler_culture = east_harimari}
				}
			}
			AND = {
				is_subject_of_type = great_daimyo_vassal
				OR = {
					overlord = {
						NOT = { num_of_subjects = 100 }
						great_daimyo_vassal = 13
					}
					overlord = {
						NOT = { num_of_subjects = 70 }
						great_daimyo_vassal = 11
					}
					overlord = {
						NOT = { num_of_subjects = 45 }
						great_daimyo_vassal = 9
					}
					overlord = {
						NOT = { num_of_subjects = 35 }
						great_daimyo_vassal = 7
					}
					overlord = {
						NOT = { num_of_subjects = 25 }
						great_daimyo_vassal = 5
					}
					overlord = {
						NOT = { num_of_subjects = 15 }
						great_daimyo_vassal = 3
					}
				}
				NOT = {
					overlord = {
						any_subject_country = {
							is_subject_of_type = great_daimyo_vassal
							NOT = { tag = ROOT }
							variable_arithmetic_trigger = {
								export_to_variable = {
									which = our_total_development
									value = trigger_value:total_development
								}
								export_to_variable = {
									which = root_total_development
									value = trigger_value:total_development
									who = ROOT
								}
								
								check_variable = { #Check if A >= B
									which = root_total_development #A
									which = our_total_development #B
								}
							}
						}
					}
				}
			}
		}
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	option = {
		name = rahenraj.2.a
		ai_chance = { factor = 1 }
		
		overlord = {
			create_subject = {
				subject_type = daimyo_vassal
				subject = ROOT
			}
		}
		if = {
			limit = {
				has_reform = great_jamindar_reform
			}
			add_government_reform = jamindar_reform
		}
	}
}

#A Prabhi Rises
country_event = {
	id = rahenraj.3
	title = rahenraj.3.t
	desc = rahenraj.3.d
	picture = FORT_eventPicture
	hidden = yes
	
	trigger = {
		is_subject_of_type = daimyo_vassal
		OR = { ruler_culture = west_harimari ruler_culture = east_harimari}
		NOT = { has_country_modifier = jamindar_promotion_rejected }
		NOT = {
			overlord = {
				NOT = { num_of_subjects = 70 }
				great_daimyo_vassal = 12
			}
			overlord = {
				NOT = { num_of_subjects = 45 }
				great_daimyo_vassal = 10
			}
			overlord = {
				NOT = { num_of_subjects = 35 }
				great_daimyo_vassal = 8
			}
			overlord = {
				NOT = { num_of_subjects = 25 }
				great_daimyo_vassal = 6
			}
			overlord = {
				NOT = { num_of_subjects = 15 }
				great_daimyo_vassal = 4
			}
			overlord = {
				NOT = { num_of_subjects = 5 }
				great_daimyo_vassal = 2
			}
		}
		NOT = {
			overlord = {
				any_subject_country = {
					is_subject_of_type = daimyo_vassal
					NOT = { has_country_modifier = jamindar_promotion_rejected }
					NOT = { tag = ROOT }
					variable_arithmetic_trigger = {
						export_to_variable = {
							which = our_total_development
							value = trigger_value:total_development
						}
						export_to_variable = {
							which = root_total_development
							value = trigger_value:total_development
							who = ROOT
						}
						
						check_variable = { #Check if A >= B
							which = our_total_development #A
							which = root_total_development #B
						}
					}
				}
			}
		}
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	option = { #Send event to Raj
		ai_chance = { factor = 1 }
		overlord = {
			country_event = {
				id = rahenraj.4
			}
		}
		set_country_flag = potential_great_jamindar
	}
}
country_event = {
	id = rahenraj.4
	title = rahenraj.4.t
	desc = rahenraj.4.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			random_subject_country = {
				limit = {
					has_country_flag = potential_great_jamindar
				}
				save_event_target_as = potential_great_jamindar_target
				clr_country_flag = potential_great_jamindar
			}
		}
	}
	
	option = { #Raise Prabhi to Senapti
		name = rahenraj.4.a
		ai_chance = { factor = 1 } #! Balance AI chance
		
		event_target:potential_great_jamindar_target = {
			overlord = {
				create_subject = {
					subject_type = great_daimyo_vassal
					subject = event_target:potential_great_jamindar_target
				}
			}
			add_government_reform = great_jamindar_reform
		}
	}
	
	option = { #We don't need any more Senapti
		name = rahenraj.4.b
		ai_chance = { factor = 1 } #! Balance AI chance
		
		event_target:potential_great_jamindar_target = {
			add_country_modifier = {
				name = jamindar_promotion_rejected
				duration = 3650
			}
		}
	}
}
country_event = { #To let the Prabhi know the result
	id = rahenraj.5
	title = rahenraj.5.t
	desc = rahenraj.5.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	
	option = { #Send event to Raj
		ai_chance = { factor = 1 }
		name = rahenraj.5.b
	}
}
