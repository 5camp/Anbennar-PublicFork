namespace = vyzemby_flavour

country_event = { #First Contact
	id = vyzemby_flavour.0
	title = vyzemby_flavour.0.t
	desc = vyzemby_flavour.0.d
	picture = SHIP_SAILING_eventPicture
	
	fire_only_once = yes

	trigger = {
		culture_group = vyzemby
		any_owned_province = {
			has_port = yes
		}
		is_year = 1540
		any_country = {
			capital_scope = {
				continent = europe
			}
			has_discovered = 6612 # CoT on Fahvanosy
		}
	}

	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					has_port = yes
				}
				save_event_target_as = landing_point
			}
		}
	}
	
	mean_time_to_happen = {
		months = 120
	}
	
	option = {
		name = vyzemby_flavour.0.a
		add_prestige = 25
		discover_province = 151 #Discover Beepeck
		event_target:landing_point = {
			add_permanent_province_modifier = {
				name = port_of_first_contact
				duration = -1
			}
		}
		hidden_effect = {				
			set_global_flag = halflings_reunited
			discover_province = 205
			discover_province = 60
			discover_province = 155				
			discover_province = 1926
			discover_province = 1267
			discover_province = 1257
			discover_province = 1266				
			discover_province = 1252
			discover_province = 1255
			discover_province = 1928
			discover_province = 1268				
			discover_province = 1253
			discover_province = 1258
			discover_province = 1272
			discover_province = 1271
			discover_province = 1270				
			discover_province = 1269
			discover_province = 1274
			discover_province = 1275
			discover_province = 1276				
			discover_province = 1293
			discover_province = 1280
			discover_province = 1301
			discover_province = 1282				
			discover_province = 1300
			discover_province = 1975
			discover_province = 1472
			discover_province = 1471				
			discover_province = 1291
			discover_province = 1277
			discover_province = 1927
			discover_province = 1563				
			discover_province = 1259
			discover_province = 1652
			discover_province = 1279
			discover_province = 1468
		}
		hidden_effect = {
			A12 = { # Beepeck discovers Fahvanosy
				discover_province = 1464
				discover_province = 3079
				discover_province = 3080
				discover_province = 3081
				discover_province = 3082
				discover_province = 1603
				discover_province = 3083
				discover_province = 4346
				discover_province = 4333
				discover_province = 3089
				discover_province = 5891
				discover_province = 3087
				discover_province = 3088
				discover_province = 3086
				discover_province = 1462
				discover_province = 3085
				discover_province = 3084
				discover_province = 3078
				discover_province = 3077
				discover_province = 1463
				discover_province = 3076
				discover_province = 3075
				discover_province = 3074
				discover_province = 1465
				discover_province = 1466
				discover_province = 1467
				discover_province = 1468
				discover_province = 1279
				discover_province = 6599
				discover_province = 5818
				discover_province = 5821
				discover_province = 6603
				discover_province = 6597
				discover_province = 6601
				discover_province = 6600
				discover_province = 5819
				discover_province = 6602
				discover_province = 6610
				discover_province = 6611
				discover_province = 5823
				discover_province = 6613
				discover_province = 6608
				discover_province = 6607
				discover_province = 3081
				discover_province = 6612
				discover_province = 6614
				discover_province = 5826
				discover_province = 6616
				discover_province = 6615
				discover_province = 5824
				discover_province = 6619
				discover_province = 6617
				discover_province = 6623
				discover_province = 6620
				discover_province = 6621
				discover_province = 6622
				discover_province = 5828
				discover_province = 5829
				discover_province = 6626
				discover_province = 6628
				discover_province = 6627
				discover_province = 6634
				discover_province = 5831
				discover_province = 6631
				discover_province = 6633
				discover_province = 6632
				discover_province = 5832
				discover_province = 6629
				discover_province = 6625
				discover_province = 3083
				discover_province = 6624
				discover_province = 1460
				discover_province = 1461
				discover_province = 1602
				discover_province = 6609
			}
		}
	}
}

country_event = { # First Contact (other nations)
	id = vyzemby_flavour.1
	title = vyzemby_flavour.1.t
	desc = vyzemby_flavour.1.d
	picture = SHIP_SAILING_eventPicture

	trigger = {
		culture_group = vyzemby
		has_global_flag = halflings_reunited
		NOT = {
			has_country_flag = cannorian_meeting
		}
	}

	immediate = {
		hidden_effect = {
			every_province = {
				limit = {
					has_province_modifier = port_of_first_contact
				}
				save_event_target_as  = landing_point
			}
		}
	}

	mean_time_to_happen = {
		days = 7
	}
	
	option = {
		name = vyzemby_flavour.1.a
		discover_province = 151 #Beepeck
		hidden_effect = {
			set_country_flag = cannorian_meeting
			discover_province = 205
			discover_province = 60
			discover_province = 155
			discover_province = 1926
			discover_province = 1267				
			discover_province = 1257
			discover_province = 1266
			discover_province = 1252
			discover_province = 1255				
			discover_province = 1928
			discover_province = 1268
			discover_province = 1253
			discover_province = 1258				
			discover_province = 1272
			discover_province = 1271
			discover_province = 1270
			discover_province = 1269
			discover_province = 1274
			discover_province = 1275
			discover_province = 1276
			discover_province = 1293			
			discover_province = 1280
			discover_province = 1301
			discover_province = 1282
			discover_province = 1300				
			discover_province = 1975
			discover_province = 1472
			discover_province = 1471
			discover_province = 1291
			discover_province = 1277
			discover_province = 1927				
			discover_province = 1563
			discover_province = 1259
			discover_province = 1652
			discover_province = 1279				
			discover_province = 1468
		}
	}
}

country_event = { # A Diplomatic Feast
	id = vyzemby_flavour.2
	title = vyzemby_flavour.2.t
	desc = vyzemby_flavour.2.d
	picture = FEAST_eventPicture

	is_triggered_only = yes # Bi-yearly pulse IV

	trigger = {
		culture_group = vyzemby
	}

	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = vyzemby_flavour.2.a # Ensure the peasants are well-fed.
		add_country_modifier = {
			name = happy_peasants
			duration = 1825
		}
	}
	option = {
		name = vyzemby_flavour.2.b # Lavish Feast
		add_years_of_income = -0.25
		add_country_modifier = {
			name = lavish_feast
			duration = 1825
		}
	}
	option = {
		name = vyzemby_flavour.2.c # Magnificent Feast
		add_years_of_income = -0.5
		add_country_modifier = {
			name = magnificent_feast
			duration = 1825
		}
	}
}

country_event = { # An Intellectual Rebirth
	id = vyzemby_flavour.3
	title = vyzemby_flavour.3.t
	desc = vyzemby_flavour.3.d
	picture = PAINTER_ARTIST_eventPicture

	fire_only_once = yes
	major_trigger = { culture_group = vyzemby }

	trigger = {
		culture_group = vyzemby
		has_global_flag = halflings_reunited
	}

	mean_time_to_happen = {
		years = 10
		modifier = {
			factor = 0.5
			any_owned_province = {
				has_province_modifier = port_of_first_contact
			}
		}
	}

	option = {
		name = vyzemby_flavour.3.a # A glorious flourishing of culture!
		if = {
			limit = {
				has_institution = renaissance
			}
			add_innovativeness = 10
		}
		else = {
			capital_scope = {
				add_institution_embracement = {
					which = "renaissance"
					value = 100
				}
			}
		}
	}
}

country_event = { # Spread of Printing
	id = vyzemby_flavour.4
	title = vyzemby_flavour.4.t
	desc = vyzemby_flavour.4.d
	picture = PRINTING_PRESS_eventPicture

	fire_only_once = yes
	major_trigger = { culture_group = vyzemby }

	trigger = {
		culture_group = vyzemby
		has_global_flag = halflings_reunited
		is_year = 1565
	}

	mean_time_to_happen = {
		years = 10
		modifier = {
			factor = 0.5
			any_owned_province = {
				has_province_modifier = port_of_first_contact
			}
		}
	}

	option = {
		name = vyzemby_flavour.4.a # What a splendid idea!
		if = {
			limit = {
				has_institution = printing_press
			}
			add_innovativeness = 10
		}
		else = {
			capital_scope = {
				add_institution_embracement = {
					which = "printing_press"
					value = 100
				}
			}
		}
	}
}

country_event = { # Shipwreck Found!
	id = vyzemby_flavour.5
	title = vyzemby_flavour.5.t
	desc = vyzemby_flavour.5.d
	picture = DHOW_AT_SEA_eventPicture

	is_triggered_only = yes # Bi-yearly pulse IV

	trigger = {
        culture_group = vyzemby
        any_owned_province = {
			has_port = yes
			any_neighbor_province = {
				has_port = yes
				NOT = {
					owned_by = ROOT
				}
			}
		}
	}

	mean_time_to_happen = {
		days = 1
	}

	immediate = {
		hidden_effect = {
            random_country = {
                limit = {
                    culture_group = vyzemby
                    any_owned_province = {
                        has_port = yes
                        any_neighbor_province = {
						    has_port = yes
							owned_by = ROOT
					    }
                    }
                }
                save_event_target_as = shipwreck_country
            }
			random_owned_province = {
				limit = {
					has_port = yes
					any_neighbor_province = {
						has_port = yes
						owned_by = event_target:shipwreck_country
					}
				}
				save_event_target_as = shipwreck_location
			}
		}
	}

	option = {
		name = vyzemby_flavour.5.a # Seize the ship and its cargo.
		event_target:shipwreck_location = {
			add_unit_construction = {
				type = light_ship
				amount = 1
				speed = 0.05
				cost = 0
			}
		}
		add_years_of_income = 0.25
        event_target:shipwreck_country = {
            add_opinion = {who = ROOT modifier = vyzemby_shipwreck_hindered}
        }
	}
	option = {
		name = vyzemby_flavour.5.b # Help the sailors get to their destination.
		add_prestige = 10
        add_country_modifier = {
			name = vyzemby_helped_sailors
			duration = 1825
		}
        event_target:shipwreck_country = {
            add_opinion = {who = ROOT modifier = vyzemby_shipwreck_helped}
        }
	}
}

country_event = { # The Fahvanosy Marathon
	id = vyzemby_flavour.6
	title = vyzemby_flavour.6.t
	desc = vyzemby_flavour.6.d
	picture = NATIVES_LOW_eventPicture

	fire_only_once = yes

	trigger = {
		tag = S71 # Fahvanosy
		current_income_balance = 5
	}

	mean_time_to_happen = {
		months = 120
	}

	option = {
		name = vyzemby_flavour.6.a
		add_country_modifier = {
			name = fahvanosy_marathon
			duration = -1
		}
	}
}

country_event = { # The International Fahvanosy Marathon
	id = vyzemby_flavour.7
	title = vyzemby_flavour.7.t
	desc = vyzemby_flavour.7.d
	picture = NATIVES_LOW_eventPicture

	fire_only_once = yes

	trigger = {
		has_global_flag = halflings_reunited 
		has_country_modifier = fahvanosy_marathon
		exists = A12 # Loc wouldn't make sense if Beepeck is dead
	}

	mean_time_to_happen = {
		months = 120
	}

	option = {
		name = vyzemby_flavour.7.a
		if = {
			limit = {
				has_country_modifier = fahvanosy_marathon
			}
			hidden_effect = {
				remove_country_modifier = fahvanosy_marathon
			}
		}
		add_country_modifier = {
			name = international_fahvanosy_marathon
			duration = -1
		}
	}
}

country_event = { # Foreign Production Methods
	id = vyzemby_flavour.8
	title = vyzemby_flavour.8.t
	desc = vyzemby_flavour.8.d
	picture = TRADEGOODS_eventPicture

	trigger = {
		culture_group = vyzemby
		has_global_flag = halflings_reunited 
		OR = {
			AND = {
				owns = 6601 # glass
				6601 = {
					NOT = {
						OR = {
							has_province_modifier = little_scholar
							has_province_modifier = big_scholar
						}
					}
				}
			}
			AND = {
				owns = 6605 # gems
				6605 = {
					NOT = {
						OR = {
							has_province_modifier = little_scholar
							has_province_modifier = big_scholar
						}
					}
				}
			}
			AND = {
				owns = 5821 # paper
				5821 = {
					NOT = {
						OR = {
							has_province_modifier = little_scholar
							has_province_modifier = big_scholar
						}
					}
				}
			}
		}
	}

	immediate = {
		hidden_effect = {
			if = {
				limit = {
					owns = 6601 # glass
					6601 = {
						NOT = {
							OR = {
								has_province_modifier = little_scholar
								has_province_modifier = big_scholar
							}
						}
					}
				}
				6601 = {
					save_event_target_as = scholar_province
				}
			}
			else_if = {
				limit = {
					owns = 6605 # gems
					6605 = {
						NOT = {
							OR = {
								has_province_modifier = little_scholar
								has_province_modifier = big_scholar
							}
						}
					}
				}
				6605 = {
					save_event_target_as = scholar_province
				}
			}
			else = {
				5821 = { # paper
					save_event_target_as = scholar_province
				}
			}
		}
	}

	mean_time_to_happen = {
		years = 30
		modifier = {
			factor = 0.5
			any_owned_province = {
				has_province_modifier = port_of_first_contact
			}
		}
	}

	option = {
		name = vyzemby_flavour.8.a
		event_target:scholar_province = {
			add_province_modifier = {
				name = little_scholar
				duration = -1
			}
		}
	}

	option = {
		name = vyzemby_flavour.8.b
		add_years_of_income = -0.5
		event_target:scholar_province = {
			add_base_production = 2
			add_province_modifier = {
				name = big_scholar
				duration = -1
			}
		}
	}
}

country_event = {
	id = vyzemby_flavour.9
	title = vyzemby_flavour.9.t
	desc = vyzemby_flavour.9.d
	picture = muslimgfx_NAVAL_MILITARY_eventPicture

	fire_only_once = yes

	trigger = {
		culture_group = vyzemby
		has_global_flag = halflings_reunited 
		owns = 6619 # spice province
	}

	mean_time_to_happen = {
		years = 30
		modifier = {
			factor = 0.5
			any_owned_province = {
				has_province_modifier = port_of_first_contact
			}
		}
	}

	option = {
		name = vyzemby_flavour.9.a
		6619 = {
			add_province_modifier = {
				name = cannorian_spice_demand
				duration = -1
			}
		}
	}
}