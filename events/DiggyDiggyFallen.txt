namespace = diggy_fallen

#Starting Event
country_event = {
	id = diggy_fallen.1
	title = diggy_fallen.1.t
	desc = diggy_fallen.1.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	#They're coming from the Old Hold !
	option = {
        name = diggy_fallen.1.a
        ai_chance = { factor = 100 }
		every_owned_province = {
			limit = { has_province_modifier = old_hold }
			spawn_rebels = {
				type = fallen_dwarf_rebel
				culture = obsidian_dwarf
				size = 2
				win = yes
			}
		}
		hidden_effect = {
			country_event = { id = diggy_fallen.3 days = 720 random = 100 }
		}
	}
}
#Random dead dwarf storming
country_event = {
	id = diggy_fallen.2
	title = diggy_fallen.2.t
	desc = diggy_fallen.2.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
		hidden_effect = {
			every_owned_province = {
				limit = { has_province_modifier = old_hold }
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 1
				}
			}	
		}
	}
	
	#They're coming from the Old Hold !
	option = {
        name = diggy_fallen.2.a
        ai_chance = { factor = 100 }
		tooltip = {
			every_owned_province = {
				limit = { has_province_modifier = old_hold }
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 1
				}
			}
		}
	}
}
	
	#Invading through road
country_event = {
	id = diggy_fallen.3
	title = diggy_fallen.3.t
	desc = diggy_fallen.3.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = { has_terrain = dwarven_road NOT = { has_province_modifier = old_gate } }
				add_permanent_province_modifier = {
					name = old_gate
					duration = -1
				}
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 1
				}
			}
			random_owned_province = {
				limit = { has_terrain = dwarven_road NOT = { has_province_modifier = old_gate } }
				add_permanent_province_modifier = {
					name = old_gate
					duration = -1
				}
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 1
				}
			}
			random_owned_province = {
				limit = { has_terrain = dwarven_road NOT = { has_province_modifier = old_gate } }
				add_permanent_province_modifier = {
					name = old_gate
					duration = -1
				}
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 1
				}
			}
			country_event = { id = diggy_fallen.5 days = 720 random = 360 }
		}
	}
	
	#They're coming from the Old Hold !
	option = {
        name = diggy_fallen.3.a
        ai_chance = { factor = 100 }
		tooltip = {
			random_owned_province = {
				limit = { has_terrain = dwarven_road NOT = { has_province_modifier = old_gate } }
				add_permanent_province_modifier = {
					name = old_gate
					duration = -1
				}
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 1
				}
			}
			random_owned_province = {
				limit = { has_terrain = dwarven_road NOT = { has_province_modifier = old_gate } }
				add_permanent_province_modifier = {
					name = old_gate
					duration = -1
				}
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 1
				}
			}
			random_owned_province = {
				limit = { has_terrain = dwarven_road NOT = { has_province_modifier = old_gate } }
				add_permanent_province_modifier = {
					name = old_gate
					duration = -1
				}
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 1
				}
			}
		}
	}
}

#Random dwarf from old gate
country_event = {
	id = diggy_fallen.4
	title = diggy_fallen.4.t
	desc = diggy_fallen.4.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	#They're coming from the Old Hold !
	option = {
        name = diggy_fallen.4.a
        ai_chance = { factor = 100 }
		every_owned_province = {
			limit = { has_province_modifier = old_gate }
			spawn_rebels = {
				type = fallen_dwarf_rebel
				culture = obsidian_dwarf
				size = 1
			}
		}
	}
}

#Big Horde - Konspark Blackhammer
country_event = {
	id = diggy_fallen.5
	title = diggy_fallen.5.t
	desc = diggy_fallen.5.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
		hidden_effect = {
			every_owned_province = {
				limit = { has_province_modifier = old_gate }
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 1
				}
			}
			random_owned_province = {
				limit = { has_province_modifier = old_hold }
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 2
					leader = "Konspark Blackhammer"
				}
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 1
				}
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 1
				}
			}
			set_country_flag = fallen_disaster_end
		}
	}
	
	option = {
        name = diggy_fallen.5.a
        ai_chance = { factor = 100 }
		tooltip = {
			every_owned_province = {
				limit = { has_province_modifier = old_gate }
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 1
				}
			}
			random_owned_province = {
				limit = { has_province_modifier = old_hold }
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 2
					leader = "Konspark Blackhammer"
				}
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 1
				}
				spawn_rebels = {
					type = fallen_dwarf_rebel
					culture = obsidian_dwarf
					size = 1
				}
			}
		}
	}
}

#Found an old dwarven artefact
province_event = {
	id = diggy_fallen.6
	title = diggy_fallen.6.t
	desc = diggy_fallen.6.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 30
	}
	
	trigger = {
		has_country_flag = fallen_treasure
		NOT = { has_country_flag = fallen_treasure_2 }
		any_owned_province = {
			has_province_modifier = old_hold
		}
	}
	
	immediate = {
		hidden_effect = { set_country_flag = fallen_treasure_2 }
	}
	#Sell it
	option = {
        name = diggy_fallen.6.a
        ai_chance = { factor = 100 }
		add_years_of_income = 1
		add_legitimacy = -5
		add_prestige = -5
	}
	#Put it in the display in a hold
	option = {
        name = diggy_fallen.6.b
        ai_chance = { factor = 100 }
		add_prestige = 20
		add_legitimacy = 20
	}
	#Study it
	option = {
        name = diggy_fallen.6.c
        ai_chance = { factor = 100 }
		add_adm_power = 100
		add_mil_power = 100
		add_dip_power = 100
	}
}
#News of strange thing deep in the old Hold
province_event = {
	id = diggy_fallen.7
	title = diggy_fallen.7.t
	desc = diggy_fallen.7.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 15
	}
	
	trigger = {
		has_country_flag = fallen_treasure_2
		NOT = { has_country_flag = fallen_treasure_3 }
		any_owned_province = {
			has_province_modifier = old_hold
		}
	}
	
	immediate = {
		hidden_effect = { set_country_flag = fallen_treasure_3 }
	}
	
	#Probably just random stories
	option = {
        name = diggy_fallen.7.a
        ai_chance = { factor = 100 }
		hidden_effect = { country_event = { id = diggy_fallen.39 days = 365 } }
	}
	
	#Send an exploration team
	option = {
        name = diggy_fallen.7.b
        ai_chance = { factor = 100 }
		add_adm_power = -20
		add_dip_power = -20
		add_mil_power = -10
		hidden_effect = { country_event = { id = diggy_fallen.39 days = 1095 } }
	}
	
	#Mine harder to discover the Old Secret
	option = {
        name = diggy_fallen.7.c
        ai_chance = { factor = 100 }
		add_years_of_income = -0.2
		add_adm_power = -10
		hidden_effect = { country_event = { id = diggy_fallen.39 days = 720 } }
	}
}
##Start Fallen Dwarf disaster
province_event = {
	id = diggy_fallen.8
	title = diggy_fallen.8.t
	desc = diggy_fallen.8.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = fallen_treasure_3
		any_owned_province = {
			has_province_modifier = old_hold
		}
	}
	
	#They are coming from deep in the mountain
	option = {
        name = diggy_fallen.8.a
        ai_chance = { factor = 100 }
		trigger = { NOT = { has_global_flag = fallen_disaster_start } }
		hidden_effect = {
			set_global_flag = fallen_disaster
			set_country_flag = fallen_disaster_start
			add_disaster_progress = {
				disaster = fallen_dwarf
				value = 100
			}
		}
	}
	#It was just rumors
	option = {
        name = diggy_fallen.8.b
        ai_chance = { factor = 100 }
		trigger = { has_global_flag = fallen_disaster_start }
		add_prestige = 5
	}
}
