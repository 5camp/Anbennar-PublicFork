namespace = magic_study

#Magic Menu
country_event = {
	id = magic_study.0
	title = magic_study.0.t	#Have this title mention the target
	picture = BIG_BOOK_eventPicture
	desc = magic_study.0.d
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			ruler_clear_saved_spell_schools = yes
			ruler_save_spell_schools = yes
		}
	}
	
	#Whats my spell schools
	option = {
		name = magic_study.0.a
		highlight = yes
		ai_chance = {
			factor = 1
		}
		
		close_single_menu = yes
		
		if = {
			limit = {	
				NOT = { has_ruler_flag = abjuration_1 }
				NOT = { has_ruler_flag = abjuration_2 }
				NOT = { has_ruler_flag = abjuration_3 }
			}
			custom_tooltip = tooltip_has_abjuration_0 
		}
		if = {
			limit = {	
				has_ruler_flag = abjuration_1
				NOT = { has_ruler_flag = abjuration_2 }
				NOT = { has_ruler_flag = abjuration_3 }
			}
			custom_tooltip = tooltip_has_abjuration_1 
		}
		if = {
			limit = {	
				has_ruler_flag = abjuration_2
				NOT = { has_ruler_flag = abjuration_3 }
			}
			custom_tooltip = tooltip_has_abjuration_2 
		}
		if = {
			limit = {	
				has_ruler_flag = abjuration_3
			}
			custom_tooltip = tooltip_has_abjuration_3 
		}
		
		if = {
			limit = {	
				NOT = { has_ruler_flag = conjuration_1 }
				NOT = { has_ruler_flag = conjuration_2 }
				NOT = { has_ruler_flag = conjuration_3 }
			}
			custom_tooltip = tooltip_has_conjuration_0 
		}
		if = {
			limit = {	
				has_ruler_flag = conjuration_1
				NOT = { has_ruler_flag = conjuration_2 }
				NOT = { has_ruler_flag = conjuration_3 }
			}
			custom_tooltip = tooltip_has_conjuration_1 
		}
		if = {
			limit = {	
				has_ruler_flag = conjuration_2
				NOT = { has_ruler_flag = conjuration_3 }
			}
			custom_tooltip = tooltip_has_conjuration_2 
		}
		if = {
			limit = {	
				has_ruler_flag = conjuration_3
			}
			custom_tooltip = tooltip_has_conjuration_3 
		}
		
		if = {
			limit = {	
				NOT = { has_ruler_flag = divination_1 }
				NOT = { has_ruler_flag = divination_2 }
				NOT = { has_ruler_flag = divination_3 }
			}
			custom_tooltip = tooltip_has_divination_0
		}
		if = {
			limit = {	
				has_ruler_flag = divination_1
				NOT = { has_ruler_flag = divination_2 }
				NOT = { has_ruler_flag = divination_3 }
			}
			custom_tooltip = tooltip_has_divination_1 
		}
		if = {
			limit = {	
				has_ruler_flag = divination_2
				NOT = { has_ruler_flag = divination_3 }
			}
			custom_tooltip = tooltip_has_divination_2 
		}
		if = {
			limit = {	
				has_ruler_flag = divination_3
			}
			custom_tooltip = tooltip_has_divination_3 
		}
		
		if = {
			limit = {	
				NOT = { has_ruler_flag = enchantment_1 }
				NOT = { has_ruler_flag = enchantment_2 }
				NOT = { has_ruler_flag = enchantment_3 }
			}
			custom_tooltip = tooltip_has_enchantment_0 
		}
		if = {
			limit = {	
				has_ruler_flag = enchantment_1
				NOT = { has_ruler_flag = enchantment_2 }
				NOT = { has_ruler_flag = enchantment_3 }
			}
			custom_tooltip = tooltip_has_enchantment_1 
		}
		if = {
			limit = {	
				has_ruler_flag = enchantment_2
				NOT = { has_ruler_flag = enchantment_3 }
			}
			custom_tooltip = tooltip_has_enchantment_2 
		}
		if = {
			limit = {	
				has_ruler_flag = enchantment_3
			}
			custom_tooltip = tooltip_has_enchantment_3 
		}
		
		if = {
			limit = {	
				NOT = { has_ruler_flag = evocation_1 }
				NOT = { has_ruler_flag = evocation_2 }
				NOT = { has_ruler_flag = evocation_3 }
			}
			custom_tooltip = tooltip_has_evocation_0 
		}
		if = {
			limit = {	
				has_ruler_flag = evocation_1
				NOT = { has_ruler_flag = evocation_2 }
				NOT = { has_ruler_flag = evocation_3 }
			}
			custom_tooltip = tooltip_has_evocation_1 
		}
		if = {
			limit = {	
				has_ruler_flag = evocation_2
				NOT = { has_ruler_flag = evocation_3 }
			}
			custom_tooltip = tooltip_has_evocation_2 
		}
		if = {
			limit = {	
				has_ruler_flag = evocation_3
			}
			custom_tooltip = tooltip_has_evocation_3 
		}
		
		if = {
			limit = {	
				NOT = { has_ruler_flag = illusion_1 }
				NOT = { has_ruler_flag = illusion_2 }
				NOT = { has_ruler_flag = illusion_3 }
			}
			custom_tooltip = tooltip_has_illusion_0 
		}
		if = {
			limit = {	
				has_ruler_flag = illusion_1
				NOT = { has_ruler_flag = illusion_2 }
				NOT = { has_ruler_flag = illusion_3 }
			}
			custom_tooltip = tooltip_has_illusion_1 
		}
		if = {
			limit = {	
				has_ruler_flag = illusion_2
				NOT = { has_ruler_flag = illusion_3 }
			}
			custom_tooltip = tooltip_has_illusion_2 
		}
		if = {
			limit = {	
				has_ruler_flag = illusion_3
			}
			custom_tooltip = tooltip_has_illusion_3 
		}
		
		if = {
			limit = {	
				NOT = { has_ruler_flag = necromancy_1 }
				NOT = { has_ruler_flag = necromancy_2 }
				NOT = { has_ruler_flag = necromancy_3 }
			}
			custom_tooltip = tooltip_has_necromancy_0 
		}
		if = {
			limit = {	
				has_ruler_flag = necromancy_1
				NOT = { has_ruler_flag = necromancy_2 }
				NOT = { has_ruler_flag = necromancy_3 }
			}
			custom_tooltip = tooltip_has_necromancy_1 
		}
		if = {
			limit = {	
				has_ruler_flag = necromancy_2
				NOT = { has_ruler_flag = necromancy_3 }
			}
			custom_tooltip = tooltip_has_necromancy_2 
		}
		if = {
			limit = {	
				has_ruler_flag = necromancy_3
			}
			custom_tooltip = tooltip_has_necromancy_3 
		}
		
		if = {
			limit = {	
				NOT = { has_ruler_flag = transmutation_1 }
				NOT = { has_ruler_flag = transmutation_2 }
				NOT = { has_ruler_flag = transmutation_3 }
			}
			custom_tooltip = tooltip_has_transmutation_0 
		}
		if = {
			limit = {	
				has_ruler_flag = transmutation_1
				NOT = { has_ruler_flag = transmutation_2 }
				NOT = { has_ruler_flag = transmutation_3 }
			}
			custom_tooltip = tooltip_has_transmutation_1 
		}
		if = {
			limit = {	
				has_ruler_flag = transmutation_2
				NOT = { has_ruler_flag = transmutation_3 }
			}
			custom_tooltip = tooltip_has_transmutation_2 
		}
		if = {
			limit = {	
				has_ruler_flag = transmutation_3
			}
			custom_tooltip = tooltip_has_transmutation_3 
		}
	}

	
	option = {	
		name = magic_study.1.t
		trigger = { NOT = { has_ruler_flag = abjuration_3 } }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.2
				OR = {
					has_ruler_flag = abjuration_1
					has_ruler_flag = abjuration_2
					has_ruler_flag = abjuration_3
				}
			}
		}
		country_event = { id = magic_study.1 days = 0 }
	}
	option = {	
		name = magic_study.4.t
		trigger = { NOT = { has_ruler_flag = conjuration_3 } }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.2
				OR = {
					has_ruler_flag = conjuration_1
					has_ruler_flag = conjuration_2
					has_ruler_flag = conjuration_3
				}
			}
		}
		country_event = { id = magic_study.4 days = 0 }
	}
	option = {	
		name = magic_study.7.t
		trigger = { NOT = { has_ruler_flag = divination_3 } }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.2
				OR = {
					has_ruler_flag = divination_1
					has_ruler_flag = divination_2
					has_ruler_flag = divination_3
				}
			}
		}
		country_event = { id = magic_study.7 days = 0 }
	}
	option = {	
		name = magic_study.10.t
		trigger = { NOT = { has_ruler_flag = enchantment_3 } }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.2
				OR = {
					has_ruler_flag = enchantment_1
					has_ruler_flag = enchantment_2
					has_ruler_flag = enchantment_3
				}
			}
		}
		country_event = { id = magic_study.10 days = 0 }
	}
	option = {	
		name = magic_study.13.t
		trigger = { NOT = { has_ruler_flag = evocation_3 } }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.2
				OR = {
					has_ruler_flag = evocation_1
					has_ruler_flag = evocation_2
					has_ruler_flag = evocation_3
				}
			}
		}
		country_event = { id = magic_study.13 days = 0 }
	}
	option = {	
		name = magic_study.16.t
		trigger = { NOT = { has_ruler_flag = illusion_3 } }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.2
				OR = {
					has_ruler_flag = illusion_1
					has_ruler_flag = illusion_2
					has_ruler_flag = illusion_3
				}
			}
		}
		country_event = { id = magic_study.16 days = 0 }
	}
	option = {	
		name = magic_study.19.t
		trigger = { NOT = { has_ruler_flag = necromancy_3 } }
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.2
				OR = {
					has_ruler_flag = necromancy_1
					has_ruler_flag = necromancy_2
					has_ruler_flag = necromancy_3
				}
			}
			modifier = {
				factor = 2
				capital_scope = { superregion = escann_superregion }
			}
		}
		country_event = { id = magic_study.19 days = 0 }
	}
	option = {	
		name = magic_study.22.t
		trigger = { NOT = { has_ruler_flag = transmutation_3 } }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.2
				OR = {
					has_ruler_flag = transmutation_1
					has_ruler_flag = transmutation_2
					has_ruler_flag = transmutation_3
				}
			}
		}
		country_event = { id = magic_study.22 days = 0 }
	}
}



#Abjuration - Menu
country_event = {
	id = magic_study.1	#Abjuration 1
	title = magic_study.1.t	
	desc = magic_realm_abjuration.0.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	option = {	#Spend Mana aka rigorous study
		name = magic_study.1.a
		ai_chance = {
			factor = 50
		}
		
		add_adm_power = -25
		add_dip_power = -25
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 1825
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_abjuration
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
		
		close_single_menu = yes
	}
	
	option = {	#Spend gold
		name = magic_study.1.b
		ai_chance = {
			factor = 50
		}
		
		add_years_of_income = -0.5
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 3650
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_abjuration
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
		
		close_single_menu = yes
	}
	
	option = { #Abjuration
        name = aelnar.92.b
        ai_chance = { factor = 100 }
		trigger = { NOT = { has_ruler_flag = abjuration_3 } has_country_flag = aelnar_empowerment }
		if = {
			limit = { has_ruler_flag = abjuration_2 }
			if = {
				limit = { check_variable = { nbConnadh = 10000 } }
				custom_tooltip = upgrade_to_legendary_tooltip
				magic_study_level_up_abjuration = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 10000 } }
			}
			else = { custom_tooltip = not_enough_need_10000_tooltip }
		}
		else_if = {
			limit = { has_ruler_flag = abjuration_1 }
			if = {
				limit = { check_variable = { nbConnadh = 5000 } }
				custom_tooltip = upgrade_to_renowned_tooltip
				magic_study_level_up_abjuration = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 5000 } }
			}
			else = { custom_tooltip = not_enough_need_5000_tooltip }
		}
		else = {
			if = {
				limit = { check_variable = { nbConnadh = 2500 } }
				custom_tooltip = upgrade_to_talented_tooltip
				magic_study_level_up_abjuration = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 2500 } }
			}
			else = { custom_tooltip = not_enough_need_2500_tooltip }
		}
		close_single_menu = yes
	}
	
	option = {
		name = magic_siege.goback
		ai_chance = {
			factor = 10
		}
		if = {
			limit = {
				ai = yes	#makes ai back out of casting completely to prevent spam
			}
			add_ruler_modifier = { 
				name = magic_study_menu_cooldown
				duration = 730	#prevents them studying for 2 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			country_event = { id = magic_study.0 days = 0 }
		}
	}
}

#Abjuration - Success
country_event = {
	id = magic_study.2
	title = magic_study.2.t
	desc = magic_study.2.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_abjuration
	}
	
	mean_time_to_happen = {
		days = 84
		
		#Difficulty
		modifier = {
			factor = 1.5
			has_ruler_flag = abjuration_1
		}
		modifier = {
			factor = 2
			has_ruler_flag = abjuration_2
		}
		modifier = {
			factor = 0.75
			had_ruler_flag = { flag = ruler_studying_abjuration		days = 365 }
		}

		#Personality  
		modifier = {
			factor = 0.8
			ruler_has_personality = scholar_personality 
		}
		modifier = {
			factor = 0.8
			ruler_has_personality = careful_personality
		}
		
		#Generic
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_help_from_mages_estate
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_help_from_advisor
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_library_archives
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_ancient_tome_found
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_relic
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_precursor_knowledge
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_magisterial_support
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_3
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_3
		}
		
		#Spells
		modifier = {
			factor = 0.75
			has_ruler_flag = ruler_studying_legend_lore
		}
		modifier = {
			factor = 0.75
			has_country_flag = ruler_studying_homunculus_familiar
		}
		
		#Deities
		modifier = {
			factor = 0.75
			has_personal_deity = the_dame
		}
		modifier = {
			factor = 0.9
			has_personal_deity = balgar
		}
		modifier = {
			factor = 0.9
			has_personal_deity = castellos
		}
		
		#Resource
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = precursor_relics
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = precursor_relics
				value = yes
			}
		}
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = damestear
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = damestear
				value = yes
			}
		}
		
		#Evil
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
		}
		modifier = {
			factor = 0.7
			has_ruler_flag = ruler_studying_forbidden_knowledge
		}
		modifier = {
			factor = 0.6
			has_ruler_flag = ruler_studying_appealed_to_darker_powers
		}
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.2.a
		ai_chance = {
			factor = 1.50
		}
		
		magic_study_level_up_abjuration = yes #not defined
	}
}

#abjuration - Fail
country_event = {
	id = magic_study.3
	title = magic_study.3.t	
	desc = magic_study.3.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_abjuration
	}
	
	mean_time_to_happen = {
		days = 28
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.3.a
		ai_chance = {
			factor = 1.50
		}
		
		#magic_study_level_up_abjuration = yes #not defined
	}
}



#Conjuration - Menu
country_event = {
	id = magic_study.4
	title = magic_study.4.t	
	desc = magic_realm_conjuration.0.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	option = {	#Spend Mana aka rigorous study
		name = magic_study.1.a
		ai_chance = {
			factor = 50
		}
		
		add_adm_power = -50
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 1825
			
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_conjuration
		
		close_single_menu = yes
	}
	
	option = {	#Spend gold
		name = magic_study.1.b
		ai_chance = {
			factor = 50
		}
		
		add_years_of_income = -0.5
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 3650
			
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_conjuration
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
		
		close_single_menu = yes
		
	}
	
	option = { #Conjuration
        name = aelnar.92.a
        ai_chance = { factor = 100 }
		trigger = { NOT = { has_ruler_flag = conjuration_3 } has_country_flag = aelnar_empowerment }
		if = {
			limit = { has_ruler_flag = conjuration_2 }
			if = {
				limit = { check_variable = { nbConnadh = 10000 } }
				custom_tooltip = upgrade_to_legendary_tooltip
				magic_study_level_up_conjuration = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 10000 } }
			}
			else = { custom_tooltip = not_enough_need_10000_tooltip }
		}
		else_if = {
			limit = { has_ruler_flag = conjuration_1 }
			if = {
				limit = { check_variable = { nbConnadh = 5000 } }
				custom_tooltip = upgrade_to_renowned_tooltip
				magic_study_level_up_conjuration = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 5000 } }
			}
			else = { custom_tooltip = not_enough_need_5000_tooltip }
		}
		else = {
			if = {
				limit = { check_variable = { nbConnadh = 2500 } }
				custom_tooltip = upgrade_to_talented_tooltip
				magic_study_level_up_conjuration = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 2500 } }
			}
			else = { custom_tooltip = not_enough_need_2500_tooltip }
		}
		close_single_menu = yes
	}
	
	option = {
		name = magic_siege.goback
		ai_chance = {
			factor = 10
		}
		if = {
			limit = {
				ai = yes	#makes ai back out of casting completely to prevent spam
			}
			add_ruler_modifier = { 
				name = magic_study_menu_cooldown
				duration = 730	#prevents them studying for 2 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			country_event = { id = magic_study.0 days = 0 }
		}
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
	}
}

#Conjuration - Success
country_event = {
	id = magic_study.5
	title = magic_study.2.t	
	desc = magic_study.2.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_conjuration
	}
	
	mean_time_to_happen = {
		days = 84
		
		#Difficulty
		modifier = {
			factor = 1.5
			has_ruler_flag = conjuration_1
		}
		modifier = {
			factor = 2
			has_ruler_flag = conjuration_2
		}
		modifier = {
			factor = 0.75
			had_ruler_flag = { flag = ruler_studying_conjuration		days = 365 }
		}

		#Personality
		modifier = {
			factor = 0.8
			ruler_has_personality = scholar_personality 
		}
		modifier = {
			factor = 0.8
			ruler_has_personality = industrious_personality
		}
		
		#Generic
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_help_from_mages_estate
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_help_from_advisor
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_library_archives
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_ancient_tome_found
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_relic
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_precursor_knowledge
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_magisterial_support
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_3
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_3
		}
		
		#Spells
		modifier = {
			factor = 0.75
			has_ruler_flag = ruler_studying_legend_lore
		}
		modifier = {
			factor = 0.75
			has_country_flag = ruler_studying_homunculus_familiar
		}
		
		#Deities
		modifier = {
			factor = 0.75
			has_personal_deity = the_dame
		}
		modifier = {
			factor = 0.9
			has_personal_deity = esmaryal
		}
		modifier = {
			factor = 0.9
			has_personal_deity = falah
		}
		
		#Resource
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = precursor_relics
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = precursor_relics
				value = yes
			}
		}
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = damestear
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = damestear
				value = yes
			}
		}
		
		
		#Evil
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
		}
		modifier = {
			factor = 0.7
			has_ruler_flag = ruler_studying_forbidden_knowledge
		}
		modifier = {
			factor = 0.6
			has_ruler_flag = ruler_studying_appealed_to_darker_powers
		}
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.2.a
		ai_chance = {
			factor = 1.50
		}
		
		magic_study_level_up_conjuration = yes #not defined
	}
}

#Conjuration - Fail
country_event = {
	id = magic_study.6
	title = magic_study.3.t
	desc = magic_study.3.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_conjuration
	}
	
	mean_time_to_happen = {
		days = 28
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.3.a
		ai_chance = {
			factor = 1.50
		}
		
		#magic_study_level_up_conjuration = yes #not defined
	}
}


#divination - Menu
country_event = {
	id = magic_study.7
	title = magic_study.7.t	
	desc = magic_realm_divination.0.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	option = {	#Spend Mana aka rigorous study
		name = magic_study.1.a
		ai_chance = {
			factor = 50
		}
		
		add_dip_power = -50
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 1825
			
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_divination
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
		
		close_single_menu = yes
	}
	
	option = {	#Spend gold
		name = magic_study.1.b
		ai_chance = {
			factor = 50
		}
		
		add_years_of_income = -0.5
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 3650
			
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_divination
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
		
		close_single_menu = yes
	}
	
	option = { #Divination
        name = aelnar.92.c
        ai_chance = { factor = 100 }
		trigger = { NOT = { has_ruler_flag = divination_3 } has_country_flag = aelnar_empowerment }
		if = {
			limit = { has_ruler_flag = divination_2 }
			if = {
				limit = { check_variable = { nbConnadh = 10000 } }
				custom_tooltip = upgrade_to_legendary_tooltip
				magic_study_level_up_divination = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 10000 } }
			}
			else = { custom_tooltip = not_enough_need_10000_tooltip }
		}
		else_if = {
			limit = { has_ruler_flag = divination_1 }
			if = {
				limit = { check_variable = { nbConnadh = 5000 } }
				custom_tooltip = upgrade_to_renowned_tooltip
				magic_study_level_up_divination = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 5000 } }
			}
			else = { custom_tooltip = not_enough_need_5000_tooltip }
		}
		else = {
			if = {
				limit = { check_variable = { nbConnadh = 2500 } }
				custom_tooltip = upgrade_to_talented_tooltip
				magic_study_level_up_divination = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 2500 } }
			}
			else = { custom_tooltip = not_enough_need_2500_tooltip }
		}
		close_single_menu = yes
	}
	
	option = {
		name = magic_siege.goback
		ai_chance = {
			factor = 10
		}
		if = {
			limit = {
				ai = yes	#makes ai back out of casting completely to prevent spam
			}
			add_ruler_modifier = { 
				name = magic_study_menu_cooldown
				duration = 730	#prevents them studying for 2 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			country_event = { id = magic_study.0 days = 0 }
		}
	}
}

#divination - Success
country_event = {
	id = magic_study.8
	title = magic_study.2.t	
	desc = magic_study.2.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_divination
	}
	
	mean_time_to_happen = {
		days = 84
		
		#Difficulty
		modifier = {
			factor = 1.5
			has_ruler_flag = divination_1
		}
		modifier = {
			factor = 2
			has_ruler_flag = divination_2
		}
		modifier = {
			factor = 0.75
			had_ruler_flag = { flag = ruler_studying_divination		days = 365 }
		}

		#Personality
		modifier = {
			factor = 0.8
			ruler_has_personality = scholar_personality 
		}
		modifier = {
			factor = 0.8
			ruler_has_personality = intricate_web_weaver_personality
		}
		
		#Generic
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_help_from_mages_estate
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_help_from_advisor
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_library_archives
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_ancient_tome_found
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_relic
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_precursor_knowledge
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_magisterial_support
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_3
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_3
		}
		
		#Spells
		modifier = {
			factor = 0.75
			has_ruler_flag = ruler_studying_legend_lore
		}
		modifier = {
			factor = 0.75
			has_country_flag = ruler_studying_homunculus_familiar
		}
		
		#Deities
		modifier = {
			factor = 0.7
			has_personal_deity = the_dame
		}
		
		#Resource
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = precursor_relics
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = precursor_relics
				value = yes
			}
		}
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = damestear
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = damestear
				value = yes
			}
		}
		
		
		#Evil
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
		}
		modifier = {
			factor = 0.7
			has_ruler_flag = ruler_studying_forbidden_knowledge
		}
		modifier = {
			factor = 0.6
			has_ruler_flag = ruler_studying_appealed_to_darker_powers
		}
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.2.a
		ai_chance = {
			factor = 1.50
		}
		
		magic_study_level_up_divination = yes #not defined
	}
}

#divination - Fail
country_event = {
	id = magic_study.9
	title = magic_study.3.t	
	desc = magic_study.3.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_divination
	}
	
	mean_time_to_happen = {
		days = 28
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.3.a
		ai_chance = {
			factor = 1.50
		}
		
		#magic_study_level_up_divination = yes #not defined
	}
}


#enchantment - Menu
country_event = {
	id = magic_study.10
	title = magic_study.10.t	
	desc = magic_realm_enchantment.0.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	option = {	#Spend Mana aka rigorous study
		name = magic_study.1.a
		ai_chance = {
			factor = 50
		}
		
		add_adm_power = -50
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 1825
			
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_enchantment
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
		
		close_single_menu = yes
	}
	
	option = {	#Spend gold
		name = magic_study.1.b
		ai_chance = {
			factor = 50
		}
		
		add_years_of_income = -0.5
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 3650
			
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_enchantment
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
		
		close_single_menu = yes
	}
	
	option = { #Enchantment
        name = aelnar.92.e
        ai_chance = { factor = 100 }
		trigger = { NOT = { has_ruler_flag = enchantment_3 } has_country_flag = aelnar_empowerment }
		if = {
			limit = { has_ruler_flag = enchantment_2 }
			if = {
				limit = { check_variable = { nbConnadh = 10000 } }
				custom_tooltip = upgrade_to_legendary_tooltip
				magic_study_level_up_enchantment = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 10000 } }
			}
			else = { custom_tooltip = not_enough_need_10000_tooltip }
		}
		else_if = {
			limit = { has_ruler_flag = enchantment_1 }
			if = {
				limit = { check_variable = { nbConnadh = 5000 } }
				custom_tooltip = upgrade_to_renowned_tooltip
				magic_study_level_up_enchantment = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 5000 } }
			}
			else = { custom_tooltip = not_enough_need_5000_tooltip }
		}
		else = {
			if = {
				limit = { check_variable = { nbConnadh = 2500 } }
				custom_tooltip = upgrade_to_talented_tooltip
				magic_study_level_up_enchantment = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 2500 } }
			}
			else = { custom_tooltip = not_enough_need_2500_tooltip }
		}
		close_single_menu = yes
	}
	
	option = {
		name = magic_siege.goback
		ai_chance = {
			factor = 10
		}
		if = {
			limit = {
				ai = yes	#makes ai back out of casting completely to prevent spam
			}
			add_ruler_modifier = { 
				name = magic_study_menu_cooldown
				duration = 730	#prevents them studying for 2 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			country_event = { id = magic_study.0 days = 0 }
		}
	}
}

#enchantment - Success
country_event = {
	id = magic_study.11
	title = magic_study.2.t	
	desc = magic_study.2.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_enchantment
	}
	
	mean_time_to_happen = {
		days = 84
		
		#Difficulty
		modifier = {
			factor = 1.5
			has_ruler_flag = enchantment_1
		}
		modifier = {
			factor = 2
			has_ruler_flag = enchantment_2
		}
		modifier = {
			factor = 0.75
			had_ruler_flag = { flag = ruler_studying_enchantment		days = 365 }
		}
		

		#Personality
		modifier = {
			factor = 0.8
			ruler_has_personality = scholar_personality 
		}
		modifier = {
			factor = 0.8
			ruler_has_personality = silver_tongue_personality
		}
		
		#Generic
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_help_from_mages_estate
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_help_from_advisor
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_library_archives
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_ancient_tome_found
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_relic
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_precursor_knowledge
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_magisterial_support
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_3
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_3
		}
		
		#Spells
		modifier = {
			factor = 0.75
			has_ruler_flag = ruler_studying_legend_lore
		}
		modifier = {
			factor = 0.75
			has_country_flag = ruler_studying_homunculus_familiar
		}
		
		#Deities
		modifier = {
			factor = 0.75
			has_personal_deity = the_dame
		}
		modifier = {
			factor = 0.9
			has_personal_deity = minara
		}
		modifier = {
			factor = 0.9
			has_personal_deity = ryala
		}
		
		#Resource
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = precursor_relics
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = precursor_relics
				value = yes
			}
		}
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = damestear
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = damestear
				value = yes
			}
		}
		
		
		#Evil
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
		}
		modifier = {
			factor = 0.7
			has_ruler_flag = ruler_studying_forbidden_knowledge
		}
		modifier = {
			factor = 0.6
			has_ruler_flag = ruler_studying_appealed_to_darker_powers
		}
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.2.a
		ai_chance = {
			factor = 1.50
		}
		
		magic_study_level_up_enchantment = yes #not defined
	}
}

#enchantment - Fail
country_event = {
	id = magic_study.12
	title = magic_study.3.t		
	desc = magic_study.3.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_enchantment
	}
	
	mean_time_to_happen = {
		days = 28
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.3.a
		ai_chance = {
			factor = 1.50
		}
		
		#magic_study_level_up_enchantment = yes #not defined
	}
}


#evocation - Menu
country_event = {
	id = magic_study.13
	title = magic_study.13.t	
	desc = magic_realm_evocation.0.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	option = {	#Spend Mana aka rigorous study
		name = magic_study.1.a
		ai_chance = {
			factor = 50
		}
		
		add_mil_power = -50
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 1825
			
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_evocation
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
		
		close_single_menu = yes
	}
	
	option = {	#Spend gold
		name = magic_study.1.b
		ai_chance = {
			factor = 50
		}
		
		add_years_of_income = -0.5
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 3650
			
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_evocation
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
		
		close_single_menu = yes
	}
	
	option = { #Evocation
        name = aelnar.92.i
        ai_chance = { factor = 100 }
		trigger = { NOT = { has_ruler_flag = evocation_3 } has_country_flag = aelnar_empowerment }
		if = {
			limit = { has_ruler_flag = evocation_2 }
			if = {
				limit = { check_variable = { nbConnadh = 10000 } }
				custom_tooltip = upgrade_to_legendary_tooltip
				magic_study_level_up_evocation = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 10000 } }
			}
			else = { custom_tooltip = not_enough_need_10000_tooltip }
		}
		else_if = {
			limit = { has_ruler_flag = evocation_1 }
			if = {
				limit = { check_variable = { nbConnadh = 5000 } }
				custom_tooltip = upgrade_to_renowned_tooltip
				magic_study_level_up_evocation = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 5000 } }
			}
			else = { custom_tooltip = not_enough_need_5000_tooltip }
		}
		else = {
			if = {
				limit = { check_variable = { nbConnadh = 2500 } }
				custom_tooltip = upgrade_to_talented_tooltip
				magic_study_level_up_evocation = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 2500 } }
			}
			else = { custom_tooltip = not_enough_need_2500_tooltip }
		}
		hidden_effect = { country_event = { id = aelnar.109 } }
		close_single_menu = yes
	}
	
	option = {
		name = magic_siege.goback
		ai_chance = {
			factor = 10
		}
		if = {
			limit = {
				ai = yes	#makes ai back out of casting completely to prevent spam
			}
			add_ruler_modifier = { 
				name = magic_study_menu_cooldown
				duration = 730	#prevents them casting for 5 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			country_event = { id = magic_study.0 days = 0 }
		}
	}
}

#evocation - Success
country_event = {
	id = magic_study.14
	title = magic_study.2.t		
	desc = magic_study.2.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_evocation
	}
	
	mean_time_to_happen = {
		days = 84
		
		#Difficulty
		modifier = {
			factor = 1.5
			has_ruler_flag = evocation_1
		}
		modifier = {
			factor = 2
			has_ruler_flag = evocation_2
		}
		modifier = {
			factor = 0.75
			had_ruler_flag = { flag = ruler_studying_evocation		days = 365 }
		}

		#Personality
		modifier = {
			factor = 0.8
			ruler_has_personality = scholar_personality 
		}
		modifier = {
			factor = 0.8
			ruler_has_personality = bold_fighter_personality
		}
		modifier = {
			factor = 0.8
			OR = {
				ruler_culture = sun_elf
			}
		}
		
		#Generic
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_help_from_mages_estate
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_help_from_advisor
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_library_archives
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_ancient_tome_found
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_relic
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_precursor_knowledge
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_magisterial_support
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_3
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_3
		}
		
		#Spells
		modifier = {
			factor = 0.75
			has_ruler_flag = ruler_studying_legend_lore
		}
		modifier = {
			factor = 0.75
			has_country_flag = ruler_studying_homunculus_familiar
		}
		
		#Deities
		modifier = {
			factor = 0.75
			has_personal_deity = the_dame
		}
		modifier = {
			factor = 0.9
			has_personal_deity = corin
		}
		modifier = {
			factor = 0.9
			religion = corinite
		}
		
		#Resource
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = precursor_relics
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = precursor_relics
				value = yes
			}
		}
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = damestear
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = damestear
				value = yes
			}
		}
		
		#Evil
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
		}
		modifier = {
			factor = 0.7
			has_ruler_flag = ruler_studying_forbidden_knowledge
		}
		modifier = {
			factor = 0.6
			has_ruler_flag = ruler_studying_appealed_to_darker_powers
		}
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.2.a
		ai_chance = {
			factor = 1.50
		}
		
		magic_study_level_up_evocation = yes #not defined
	}
}

#evocation - Fail
country_event = {
	id = magic_study.15
	title = magic_study.3.t	
	desc = magic_study.3.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_evocation
	}
	
	mean_time_to_happen = {
		days = 28
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.2.a
		ai_chance = {
			factor = 1.50
		}
		
		#magic_study_level_up_evocation = yes #not defined
	}
}


#illusion - Menu
country_event = {
	id = magic_study.16
	title = magic_study.16.t	
	desc = magic_realm_illusion.0.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	option = {	#Spend Mana aka rigorous study
		name = magic_study.1.a
		ai_chance = {
			factor = 50
		}
		
		add_mil_power = -25
		add_dip_power = -25
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 1825
			
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_illusion
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
		
		close_single_menu = yes
	}
	
	option = {	#Spend gold
		name = magic_study.1.b
		ai_chance = {
			factor = 50
		}
		
		add_years_of_income = -0.5
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 3650
			
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_illusion
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
		
		close_single_menu = yes
	}
	
	option = { #Illusion
        name = aelnar.92.f
        ai_chance = { factor = 100 }
		trigger = { NOT = { has_ruler_flag = illusion_3 } has_country_flag = aelnar_empowerment }
		if = {
			limit = { has_ruler_flag = illusion_2 }
			if = {
				limit = { check_variable = { nbConnadh = 10000 } }
				custom_tooltip = upgrade_to_legendary_tooltip
				magic_study_level_up_illusion = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 10000 } }
			}
			else = { custom_tooltip = not_enough_need_10000_tooltip }
		}
		else_if = {
			limit = { has_ruler_flag = illusion_1 }
			if = {
				limit = { check_variable = { nbConnadh = 5000 } }
				custom_tooltip = upgrade_to_renowned_tooltip
				magic_study_level_up_illusion = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 5000 } }
			}
			else = { custom_tooltip = not_enough_need_5000_tooltip }
		}
		else = {
			if = {
				limit = { check_variable = { nbConnadh = 2500 } }
				custom_tooltip = upgrade_to_talented_tooltip
				magic_study_level_up_illusion = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 2500 } }
			}
			else = { custom_tooltip = not_enough_need_2500_tooltip }
		}
		close_single_menu = yes
	}
	
	option = {
		name = magic_siege.goback
		ai_chance = {
			factor = 10
		}
		if = {
			limit = {
				ai = yes	#makes ai back out of casting completely to prevent spam
			}
			add_ruler_modifier = { 
				name = magic_study_menu_cooldown
				duration = 730	#prevents them studying for 2 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			country_event = { id = magic_study.0 days = 0 }
		}
	}
}

#illusion - Success
country_event = {
	id = magic_study.17
	title = magic_study.2.t		
	desc = magic_study.2.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_illusion
	}
	
	mean_time_to_happen = {
		days = 84
		
		#Difficulty
		modifier = {
			factor = 1.5
			has_ruler_flag = illusion_1
		}
		modifier = {
			factor = 2
			has_ruler_flag = illusion_2
		}
		modifier = {
			factor = 0.75
			had_ruler_flag = { flag = ruler_studying_illusion		days = 365 }
		}

		#Personality
		modifier = {
			factor = 0.8
			ruler_has_personality = scholar_personality 
		}
		modifier = {
			factor = 0.8
			ruler_has_personality = secretive_personality 
		}
		modifier = {
			factor = 0.8
			OR = {
				ruler_culture = imperial_gnome
				ruler_culture = creek_gnome
			}
		}
		
		#Generic
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_help_from_mages_estate
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_help_from_advisor
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_library_archives
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_ancient_tome_found
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_relic
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_precursor_knowledge
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_magisterial_support
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_3
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_3
		}
		
		#Spells
		modifier = {
			factor = 0.75
			has_ruler_flag = ruler_studying_legend_lore
		}
		modifier = {
			factor = 0.75
			has_country_flag = ruler_studying_homunculus_familiar
		}
		
		#Deities
		modifier = {
			factor = 0.75
			has_personal_deity = the_dame
		}
		modifier = {
			factor = 0.8
			has_personal_deity = nathalyne
		}
		
		#Resource
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = precursor_relics
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = precursor_relics
				value = yes
			}
		}
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = damestear
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = damestear
				value = yes
			}
		}
		
		
		#Evil
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
		}
		modifier = {
			factor = 0.7
			has_ruler_flag = ruler_studying_forbidden_knowledge
		}
		modifier = {
			factor = 0.6
			has_ruler_flag = ruler_studying_appealed_to_darker_powers
		}
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.2.a
		ai_chance = {
			factor = 1.50
		}
		
		magic_study_level_up_illusion = yes #not defined
	}
}

#illusion - Fail
country_event = {
	id = magic_study.18
	title = magic_study.3.t		
	desc = magic_study.3.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_illusion
	}
	
	mean_time_to_happen = {
		days = 28
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.3.a
		ai_chance = {
			factor = 1.50
		}
		
		#magic_study_level_up_illusion = yes #not defined
	}
}


#necromancy - Menu
country_event = {
	id = magic_study.19
	title = magic_study.19.t	
	desc = magic_realm_necromancy.0.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	option = {	#Spend Mana aka rigorous study
		name = magic_study.1.a
		ai_chance = {
			factor = 50
		}
		
		add_dip_power = -50
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 1825
			
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_necromancy
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
		
		close_single_menu = yes
		
		increase_witch_king_points_small = yes
	}
	
	option = {	#Spend gold
		name = magic_study.1.b
		ai_chance = {
			factor = 50
		}
		
		add_years_of_income = -0.5
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 3650
			
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_necromancy
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
		
		close_single_menu = yes
		
		increase_witch_king_points_small = yes
	}
	
	option = { #Necromancy
        name = aelnar.92.g
        ai_chance = { factor = 100 }
		trigger = { NOT = { has_ruler_flag = necromancy_3 } has_country_flag = aelnar_empowerment }
		if = {
			limit = { has_ruler_flag = necromancy_2 }
			if = {
				limit = { check_variable = { nbConnadh = 10000 } }
				custom_tooltip = upgrade_to_legendary_tooltip
				magic_study_level_up_necromancy = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 10000 } }
			}
			else = { custom_tooltip = not_enough_need_10000_tooltip }
		}
		else_if = {
			limit = { has_ruler_flag = necromancy_1 }
			if = {
				limit = { check_variable = { nbConnadh = 5000 } }
				custom_tooltip = upgrade_to_renowned_tooltip
				magic_study_level_up_necromancy = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 5000 } }
			}
			else = { custom_tooltip = not_enough_need_5000_tooltip }
		}
		else = {
			if = {
				limit = { check_variable = { nbConnadh = 2500 } }
				custom_tooltip = upgrade_to_talented_tooltip
				magic_study_level_up_necromancy = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 2500 } }
			}
			else = { custom_tooltip = not_enough_need_2500_tooltip }
		}
		close_single_menu = yes
	}
	
	option = {
		name = magic_siege.goback
		ai_chance = {
			factor = 10
		}
		if = {
			limit = {
				ai = yes	#makes ai back out of casting completely to prevent spam
			}
			add_ruler_modifier = { 
				name = magic_study_menu_cooldown
				duration = 730	#prevents them studying for 2 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			country_event = { id = magic_study.0 days = 0 }
		}
	}
}

#necromancy - Success
country_event = {
	id = magic_study.20
	title = magic_study.2.t		
	desc = magic_study.2.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_necromancy
	}
	
	mean_time_to_happen = {
		days = 84
		
		#Difficulty
		modifier = {
			factor = 1.5
			has_ruler_flag = necromancy_1
		}
		modifier = {
			factor = 2
			has_ruler_flag = necromancy_2
		}
		modifier = {
			factor = 0.75
			had_ruler_flag = { flag = ruler_studying_necromancy		days = 365 }
		}

		#Personality
		modifier = {
			factor = 0.8
			ruler_has_personality = scholar_personality 
		}
		modifier = {
			factor = 0.8
			ruler_has_personality = malevolent_personality
		}
		modifier = {
			factor = 0.8
			OR = {
				ruler_culture = corvurian
			}
		}
		
		#Generic
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_help_from_mages_estate
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_help_from_advisor
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_library_archives
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_ancient_tome_found
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_relic
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_precursor_knowledge
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_magisterial_support
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_3
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_3
		}
		
		#Spells
		modifier = {
			factor = 0.75
			has_ruler_flag = ruler_studying_legend_lore
		}
		modifier = {
			factor = 0.75
			has_country_flag = ruler_studying_homunculus_familiar
		}
		
		#Deities
		modifier = {
			factor = 0.75
			has_personal_deity = the_dame
		}
		modifier = {
			factor = 0.9
			has_personal_deity = nerat
		}
		
		#Resource
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = precursor_relics
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = precursor_relics
				value = yes
			}
		}
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = damestear
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = damestear
				value = yes
			}
		}
		
		
		#Evil
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
		}
		modifier = {
			factor = 0.7
			has_ruler_flag = ruler_studying_forbidden_knowledge
		}
		modifier = {
			factor = 0.6
			has_ruler_flag = ruler_studying_appealed_to_darker_powers
		}
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.2.a
		ai_chance = {
			factor = 1.50
		}
		
		magic_study_level_up_necromancy = yes #not defined
	}
}

#necromancy - Fail
country_event = {
	id = magic_study.21
	title = magic_study.3.t		
	desc = magic_study.3.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_necromancy
	}
	
	mean_time_to_happen = {
		days = 28
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.3.a
		ai_chance = {
			factor = 1.50
		}
		
		#magic_study_level_up_necromancy = yes #not defined
		
	}
}


#transmutation - Menu
country_event = {
	id = magic_study.22
	title = magic_study.22.t	
	desc = magic_realm_transmutation.0.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	option = {	#Spend Mana aka rigorous study
		name = magic_study.1.a
		ai_chance = {
			factor = 50
		}
		
		add_dip_power = -25
		add_mil_power = -25
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 1825
			
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_transmutation
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
		
		close_single_menu = yes
	}
	
	option = {	#Spend gold
		name = magic_study.1.b
		ai_chance = {
			factor = 50
		}
		
		add_years_of_income = -0.5
		
		add_ruler_modifier = {
			name = ruler_studying_magic
			duration = 3650
			
		}
		
		set_ruler_flag = ruler_studying_magic_flag
		set_ruler_flag = ruler_studying_transmutation
		
		hidden_effect = { country_event = { id = magic_realm_illusion.4 days = 0 } }
		
		close_single_menu = yes
	}
	
	option = { #Transmutation
        name = aelnar.92.h
        ai_chance = { factor = 100 }
		trigger = { NOT = { has_ruler_flag = transmutation_3 } has_country_flag = aelnar_empowerment }
		if = {
			limit = { has_ruler_flag = transmutation_2 }
			if = {
				limit = { check_variable = { nbConnadh = 10000 } }
				custom_tooltip = upgrade_to_legendary_tooltip
				magic_study_level_up_transmutation = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 10000 } }
			}
			else = { custom_tooltip = not_enough_need_10000_tooltip }
		}
		else_if = {
			limit = { has_ruler_flag = transmutation_1 }
			if = {
				limit = { check_variable = { nbConnadh = 5000 } }
				custom_tooltip = upgrade_to_renowned_tooltip
				magic_study_level_up_transmutation = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 5000 } }
			}
			else = { custom_tooltip = not_enough_need_5000_tooltip }
		}
		else = {
			if = {
				limit = { check_variable = { nbConnadh = 2500 } }
				custom_tooltip = upgrade_to_talented_tooltip
				magic_study_level_up_transmutation = yes
				increase_witch_king_points_large = yes
				hidden_effect = { subtract_variable = { nbConnadh = 2500 } }
			}
			else = { custom_tooltip = not_enough_need_2500_tooltip }
		}
		close_single_menu = yes
	}
	
	option = {
		name = magic_siege.goback
		ai_chance = {
			factor = 10
		}
		if = {
			limit = {
				ai = yes	#makes ai back out of casting completely to prevent spam
			}
			add_ruler_modifier = { 
				name = magic_study_menu_cooldown
				duration = 730	#prevents them studying for 2 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			country_event = { id = magic_study.0 days = 0 }
		}
	}
}

#transmutation - Success
country_event = {
	id = magic_study.23
	title = magic_study.2.t		
	desc = magic_study.2.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_transmutation
	}
	
	mean_time_to_happen = {
		days = 84
		
		#Difficulty
		modifier = {
			factor = 1.5
			has_ruler_flag = transmutation_1
		}
		modifier = {
			factor = 2
			has_ruler_flag = transmutation_2
		}
		modifier = {
			factor = 0.75
			had_ruler_flag = { flag = ruler_studying_transmutation		days = 365 }
		}

		#Personality
		modifier = {
			factor = 0.8
			ruler_has_personality = scholar_personality 
		}
		modifier = {
			factor = 0.8
			ruler_has_personality = midas_touched_personality 
		}
		modifier = {
			factor = 0.8
			OR = {
				ruler_culture = moon_elf
				ruler_culture = cliff_gnome
			}
		}
		
		#Generic
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_help_from_mages_estate
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_help_from_advisor
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_library_archives
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_ancient_tome_found
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_relic
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_magic_precursor_knowledge
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_magisterial_support
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_mana_3
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_1
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_2
		}
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_gold_3
		}
		
		#Spells
		modifier = {
			factor = 0.75
			has_ruler_flag = ruler_studying_legend_lore
		}
		modifier = {
			factor = 0.75
			has_country_flag = ruler_studying_homunculus_familiar
		}
		
		#Deities
		modifier = {
			factor = 0.75
			has_personal_deity = the_dame
		}
		modifier = {
			factor = 0.9
			has_personal_deity = ara
		}
		modifier = {
			factor = 0.9
			has_personal_deity = munas_moonsinger
		}
		
		#Resource
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = precursor_relics
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = precursor_relics
				value = yes
			}
		}
		modifier = {
			factor = 0.9
			any_owned_province = {
				trade_goods = damestear
			}
		}
		modifier = {
			factor = 0.75
			trading_bonus = {
				trade_goods = damestear
				value = yes
			}
		}
		
		
		#Evil
		modifier = {
			factor = 0.9
			has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
		}
		modifier = {
			factor = 0.8
			has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
		}
		modifier = {
			factor = 0.7
			has_ruler_flag = ruler_studying_forbidden_knowledge
		}
		modifier = {
			factor = 0.6
			has_ruler_flag = ruler_studying_appealed_to_darker_powers
		}
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.2.a
		ai_chance = {
			factor = 1.50
		}
		
		magic_study_level_up_transmutation = yes #not defined
	}
}

#transmutation - Fail
country_event = {
	id = magic_study.24
	title = magic_study.3.t		
	desc = magic_study.3.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_ruler_modifier = ruler_studying_magic }
		has_ruler_flag = ruler_studying_transmutation
	}
	
	mean_time_to_happen = {
		days = 28
	}
	
	immediate = {
		magic_study_clear_study_effects = yes
	}
	
	option = {
		name = magic_study.3.a
		ai_chance = {
			factor = 1.50
		}
		
		#magic_study_level_up_transmutation = yes #not defined
	}
}

#Magic Study result picker
country_event = {
	id = magic_study.100
	title = magic_study.100.t		
	desc = magic_study.100.d
	picture = BIG_BOOK_eventPicture
	
	hidden = yes
	
	trigger = {
		has_ruler_flag = ruler_studying_magic_flag
		NOT = { has_ruler_modifier = ruler_studying_magic }
	}
	
	#Abjuration Success
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_abjuration
		}
		ai_chance = {
			factor = 25
		
			#Difficulty
			modifier = {
				factor = 0.66
				has_ruler_flag = abjuration_1
			}
			modifier = {
				factor = 0.5
				has_ruler_flag = abjuration_2
			}
			modifier = {
				factor = 1.33
				had_ruler_flag = { flag = ruler_studying_abjuration		days = 365 }
			}

			#Personality  
			modifier = {
				factor = 1.25
				ruler_has_personality = scholar_personality 
			}
			modifier = {
				factor = 1.25
				ruler_has_personality = careful_personality
			}
			
			#Generic
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_help_from_mages_estate
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_help_from_advisor
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_library_archives
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_ancient_tome_found
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_relic
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_precursor_knowledge
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_magisterial_support
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_3
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_3
			}
			
			#Spells
			modifier = {
				factor = 1.33
				has_ruler_flag = ruler_studying_legend_lore
			}
			modifier = {
				factor = 1.33
				has_country_flag = ruler_studying_homunculus_familiar
			}
			
			#Deities
			modifier = {
				factor = 1.33
				has_personal_deity = the_dame
			}
			modifier = {
				factor = 1.11
				has_personal_deity = balgar
			}
			modifier = {
				factor = 1.11
				has_personal_deity = castellos
			}
			
			#Resource
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = precursor_relics
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = precursor_relics
					value = yes
				}
			}
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = damestear
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = damestear
					value = yes
				}
			}
			
			#Evil
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
			}
			modifier = {
				factor = 1.43
				has_ruler_flag = ruler_studying_forbidden_knowledge
			}
			modifier = {
				factor = 1.66
				has_ruler_flag = ruler_studying_appealed_to_darker_powers
			}
		}
		
		country_event = { id = magic_study.2 }
	}
	#Abjuration Fail
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_abjuration
		}
		ai_chance = {
			factor = 75
		}
		
		country_event = { id = magic_study.3 }
	}
	
	#Conjuration Success
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_conjuration
		}
		ai_chance = {
			factor = 25
		
			#Difficulty
			modifier = {
				factor = 0.66
				has_ruler_flag = conjuration_1
			}
			modifier = {
				factor = 0.5
				has_ruler_flag = conjuration_2
			}
			modifier = {
				factor = 1.33
				had_ruler_flag = { flag = ruler_studying_conjuration		days = 365 }
			}

			#Personality  
			modifier = {
				factor = 1.25
				ruler_has_personality = scholar_personality 
			}
			modifier = {
				factor = 1.25
				ruler_has_personality = industrious_personality
			}
			
			#Generic
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_help_from_mages_estate
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_help_from_advisor
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_library_archives
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_ancient_tome_found
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_relic
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_precursor_knowledge
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_magisterial_support
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_3
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_3
			}
			
			#Spells
			modifier = {
				factor = 1.33
				has_ruler_flag = ruler_studying_legend_lore
			}
			modifier = {
				factor = 1.33
				has_country_flag = ruler_studying_homunculus_familiar
			}
			
			#Deities
			modifier = {
				factor = 1.33
				has_personal_deity = the_dame
			}
			modifier = {
				factor = 1.11
				has_personal_deity = esmaryal
			}
			modifier = {
				factor = 1.11
				has_personal_deity = falah
			}
			
			#Resource
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = precursor_relics
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = precursor_relics
					value = yes
				}
			}
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = damestear
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = damestear
					value = yes
				}
			}
			
			#Evil
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
			}
			modifier = {
				factor = 1.43
				has_ruler_flag = ruler_studying_forbidden_knowledge
			}
			modifier = {
				factor = 1.66
				has_ruler_flag = ruler_studying_appealed_to_darker_powers
			}
		}
		
		country_event = { id = magic_study.5 }
	}
	#Conjuration Fail
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_conjuration
		}
		ai_chance = {
			factor = 75
		}
		
		country_event = { id = magic_study.6 }
	}
	
	#Divination Success
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_divination
		}
		ai_chance = {
			factor = 25
		
			#Difficulty
			modifier = {
				factor = 0.66
				has_ruler_flag = divination_1
			}
			modifier = {
				factor = 0.5
				has_ruler_flag = divination_2
			}
			modifier = {
				factor = 1.33
				had_ruler_flag = { flag = ruler_studying_divination		days = 365 }
			}

			#Personality  
			modifier = {
				factor = 1.25
				ruler_has_personality = scholar_personality 
			}
			modifier = {
				factor = 1.25
				ruler_has_personality = intricate_web_weaver_personality
			}
			
			#Generic
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_help_from_mages_estate
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_help_from_advisor
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_library_archives
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_ancient_tome_found
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_relic
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_precursor_knowledge
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_magisterial_support
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_3
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_3
			}
			
			#Spells
			modifier = {
				factor = 1.33
				has_ruler_flag = ruler_studying_legend_lore
			}
			modifier = {
				factor = 1.33
				has_country_flag = ruler_studying_homunculus_familiar
			}
			
			#Deities
			modifier = {
				factor = 1.33
				has_personal_deity = the_dame
			}
			
			#Resource
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = precursor_relics
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = precursor_relics
					value = yes
				}
			}
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = damestear
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = damestear
					value = yes
				}
			}
			
			#Evil
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
			}
			modifier = {
				factor = 1.43
				has_ruler_flag = ruler_studying_forbidden_knowledge
			}
			modifier = {
				factor = 1.66
				has_ruler_flag = ruler_studying_appealed_to_darker_powers
			}
		}
		
		country_event = { id = magic_study.8 }
	}
	#Divination Fail
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_divination
		}
		ai_chance = {
			factor = 75
		}
		
		country_event = { id = magic_study.9 }
	}
	
	#Enchantment Success
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_enchantment
		}
		ai_chance = {
			factor = 25
		
			#Difficulty
			modifier = {
				factor = 0.66
				has_ruler_flag = enchantment_1
			}
			modifier = {
				factor = 0.5
				has_ruler_flag = enchantment_2
			}
			modifier = {
				factor = 1.33
				had_ruler_flag = { flag = ruler_studying_enchantment		days = 365 }
			}

			#Personality  
			modifier = {
				factor = 1.25
				ruler_has_personality = scholar_personality 
			}
			modifier = {
				factor = 1.25
				ruler_has_personality = silver_tongue_personality
			}
			
			#Generic
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_help_from_mages_estate
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_help_from_advisor
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_library_archives
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_ancient_tome_found
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_relic
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_precursor_knowledge
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_magisterial_support
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_3
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_3
			}
			
			#Spells
			modifier = {
				factor = 1.33
				has_ruler_flag = ruler_studying_legend_lore
			}
			modifier = {
				factor = 1.33
				has_country_flag = ruler_studying_homunculus_familiar
			}
			
			#Deities
			modifier = {
				factor = 1.33
				has_personal_deity = the_dame
			}
			modifier = {
				factor = 1.11
				has_personal_deity = minara
			}
			modifier = {
				factor = 1.11
				has_personal_deity = ryala
			}
			
			#Resource
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = precursor_relics
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = precursor_relics
					value = yes
				}
			}
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = damestear
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = damestear
					value = yes
				}
			}
			
			#Evil
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
			}
			modifier = {
				factor = 1.43
				has_ruler_flag = ruler_studying_forbidden_knowledge
			}
			modifier = {
				factor = 1.66
				has_ruler_flag = ruler_studying_appealed_to_darker_powers
			}
		}
		
		country_event = { id = magic_study.11 }
	}
	#Enchantment Fail
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_enchantment
		}
		ai_chance = {
			factor = 75
		}
		
		country_event = { id = magic_study.12 }
	}
	
	#Evocation Success
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_evocation
		}
		ai_chance = {
			factor = 25
		
			#Difficulty
			modifier = {
				factor = 0.66
				has_ruler_flag = evocation_1
			}
			modifier = {
				factor = 0.5
				has_ruler_flag = evocation_2
			}
			modifier = {
				factor = 1.33
				had_ruler_flag = { flag = ruler_studying_evocation		days = 365 }
			}

			#Personality  
			modifier = {
				factor = 1.25
				ruler_has_personality = scholar_personality 
			}
			modifier = {
				factor = 1.25
				ruler_has_personality = bold_fighter_personality
			}
			modifier = {
				factor = 1.25
				OR = {
					ruler_culture = sun_elf
					ruler_culture = dawn_elf
				}
			}
			
			#Generic
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_help_from_mages_estate
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_help_from_advisor
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_library_archives
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_ancient_tome_found
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_relic
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_precursor_knowledge
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_magisterial_support
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_3
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_3
			}
			
			#Spells
			modifier = {
				factor = 1.33
				has_ruler_flag = ruler_studying_legend_lore
			}
			modifier = {
				factor = 1.33
				has_country_flag = ruler_studying_homunculus_familiar
			}
			
			#Deities
			modifier = {
				factor = 1.33
				has_personal_deity = the_dame
			}
			modifier = {
				factor = 1.11
				has_personal_deity = corin
			}
			modifier = {
				factor = 1.11
				religion = corinite
			}
			
			#Resource
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = precursor_relics
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = precursor_relics
					value = yes
				}
			}
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = damestear
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = damestear
					value = yes
				}
			}
			
			#Evil
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
			}
			modifier = {
				factor = 1.43
				has_ruler_flag = ruler_studying_forbidden_knowledge
			}
			modifier = {
				factor = 1.66
				has_ruler_flag = ruler_studying_appealed_to_darker_powers
			}
		}
		
		country_event = { id = magic_study.14 }
	}
	#Evocation Fail
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_evocation
		}
		ai_chance = {
			factor = 75
		}
		
		country_event = { id = magic_study.15 }
	}
	
	#Illusion Success
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_illusion
		}
		ai_chance = {
			factor = 25
		
			#Difficulty
			modifier = {
				factor = 0.66
				has_ruler_flag = illusion_1
			}
			modifier = {
				factor = 0.5
				has_ruler_flag = illusion_2
			}
			modifier = {
				factor = 1.33
				had_ruler_flag = { flag = ruler_studying_illusion		days = 365 }
			}

			#Personality  
			modifier = {
				factor = 1.25
				ruler_has_personality = scholar_personality 
			}
			modifier = {
				factor = 1.25
				ruler_has_personality = secretive_personality
			}
			modifier = {
				factor = 1.25
				OR = {
					ruler_culture = imperial_gnome
					ruler_culture = creek_gnome
				}
			}
			
			#Generic
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_help_from_mages_estate
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_help_from_advisor
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_library_archives
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_ancient_tome_found
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_relic
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_precursor_knowledge
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_magisterial_support
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_3
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_3
			}
			
			#Spells
			modifier = {
				factor = 1.33
				has_ruler_flag = ruler_studying_legend_lore
			}
			modifier = {
				factor = 1.33
				has_country_flag = ruler_studying_homunculus_familiar
			}
			
			#Deities
			modifier = {
				factor = 1.33
				has_personal_deity = the_dame
			}
			modifier = {
				factor = 1.11
				has_personal_deity = nathalyne
			}
			
			#Resource
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = precursor_relics
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = precursor_relics
					value = yes
				}
			}
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = damestear
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = damestear
					value = yes
				}
			}
			
			#Evil
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
			}
			modifier = {
				factor = 1.43
				has_ruler_flag = ruler_studying_forbidden_knowledge
			}
			modifier = {
				factor = 1.66
				has_ruler_flag = ruler_studying_appealed_to_darker_powers
			}
		}
		
		country_event = { id = magic_study.17 }
	}
	#Illusion Fail
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_illusion
		}
		ai_chance = {
			factor = 75
		}
		
		country_event = { id = magic_study.18 }
	}
	
	#Necromancy Success
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_necromancy
		}
		ai_chance = {
			factor = 25
		
			#Difficulty
			modifier = {
				factor = 0.66
				has_ruler_flag = necromancy_1
			}
			modifier = {
				factor = 0.5
				has_ruler_flag = necromancy_2
			}
			modifier = {
				factor = 1.33
				had_ruler_flag = { flag = ruler_studying_necromancy		days = 365 }
			}

			#Personality  
			modifier = {
				factor = 1.25
				ruler_has_personality = scholar_personality 
			}
			modifier = {
				factor = 1.25
				ruler_has_personality = malevolent_personality
			}
			modifier = {
				factor = 1.25
				OR = {
					ruler_culture = corvurian
				}
			}
			
			#Generic
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_help_from_mages_estate
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_help_from_advisor
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_library_archives
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_ancient_tome_found
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_relic
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_precursor_knowledge
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_magisterial_support
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_3
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_3
			}
			
			#Spells
			modifier = {
				factor = 1.33
				has_ruler_flag = ruler_studying_legend_lore
			}
			modifier = {
				factor = 1.33
				has_country_flag = ruler_studying_homunculus_familiar
			}
			
			#Deities
			modifier = {
				factor = 1.33
				has_personal_deity = the_dame
			}
			modifier = {
				factor = 1.11
				has_personal_deity = nerat
			}
			
			#Resource
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = precursor_relics
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = precursor_relics
					value = yes
				}
			}
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = damestear
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = damestear
					value = yes
				}
			}
			
			#Evil
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
			}
			modifier = {
				factor = 1.43
				has_ruler_flag = ruler_studying_forbidden_knowledge
			}
			modifier = {
				factor = 1.66
				has_ruler_flag = ruler_studying_appealed_to_darker_powers
			}
		}
		
		country_event = { id = magic_study.20 }
	}
	#Necromancy Fail
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_necromancy
		}
		ai_chance = {
			factor = 75
		}
		
		country_event = { id = magic_study.21 }
	}
	
	#Transmutation Success
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_transmutation
		}
		ai_chance = {
			factor = 25
		
			#Difficulty
			modifier = {
				factor = 0.66
				has_ruler_flag = transmutation_1
			}
			modifier = {
				factor = 0.5
				has_ruler_flag = transmutation_2
			}
			modifier = {
				factor = 1.33
				had_ruler_flag = { flag = ruler_studying_transmutation		days = 365 }
			}

			#Personality  
			modifier = {
				factor = 1.25
				ruler_has_personality = scholar_personality 
			}
			modifier = {
				factor = 1.25
				ruler_has_personality = midas_touched_personality
			}
			modifier = {
				factor = 1.25
				OR = {
					ruler_culture = moon_elf
					ruler_culture = cliff_gnome
				}
			}
			
			#Generic
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_help_from_mages_estate
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_help_from_advisor
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_library_archives
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_ancient_tome_found
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_relic
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_magic_precursor_knowledge
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_magisterial_support
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_mana_3
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_1
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_2
			}
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_gold_3
			}
			
			#Spells
			modifier = {
				factor = 1.33
				has_ruler_flag = ruler_studying_legend_lore
			}
			modifier = {
				factor = 1.33
				has_country_flag = ruler_studying_homunculus_familiar
			}
			
			#Deities
			modifier = {
				factor = 1.33
				has_personal_deity = the_dame
			}
			modifier = {
				factor = 1.11
				has_personal_deity = ara
			}
			modifier = {
				factor = 1.11
				OR = {
					has_personal_deity = munas_moonsinger
					has_personal_deity = munas_moonsinger_ibevar
				}
			}
			
			#Resource
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = precursor_relics
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = precursor_relics
					value = yes
				}
			}
			modifier = {
				factor = 1.11
				any_owned_province = {
					trade_goods = damestear
				}
			}
			modifier = {
				factor = 1.33
				trading_bonus = {
					trade_goods = damestear
					value = yes
				}
			}
			
			#Evil
			modifier = {
				factor = 1.11
				has_ruler_flag = ruler_studying_unregulated_research	#most common one to fire, little reprocussions in Escann
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_unsafe_experiments	#crazy events can happen like fucking up provinces
			}
			modifier = {
				factor = 1.25
				has_ruler_flag = ruler_studying_human_test_subjects	#More likely for cruel
			}
			modifier = {
				factor = 1.43
				has_ruler_flag = ruler_studying_forbidden_knowledge
			}
			modifier = {
				factor = 1.66
				has_ruler_flag = ruler_studying_appealed_to_darker_powers
			}
		}
		
		country_event = { id = magic_study.23 }
	}
	#Transmutation Fail
	option = {
		name = magic_study.100.a
		trigger = {
			has_ruler_flag = ruler_studying_transmutation
		}
		ai_chance = {
			factor = 75
		}
		
		country_event = { id = magic_study.24 }
	}
}
