
namespace = flavor_telgeir

# The Vanbury Dynasty
country_event = {
	id = flavor_telgeir.1
	title = flavor_telgeir.1.t
	desc = flavor_telgeir.1.d
	picture = COURT_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		tag = A62
		government = monarchy
		has_government_attribute = heir
		is_free_or_tributary_trigger = yes
		NOT = { dynasty = "of Vanbury" }
		has_new_dynasty = yes
	}
	
	immediate = {
		hidden_effect = {
			random_list = {
				5 = {
					set_saved_name = {
						key = vanbury_name
						type = simple
						name = "Tristan"
					}
				}
				5 = {
					set_saved_name = {
						key = vanbury_name
						type = simple
						name = "Ricard"
					}
				}
				5 = {
					set_saved_name = {
						key = vanbury_name
						type = simple
						name = "Artus"
					}
				}
				5 = {
					set_saved_name = {
						key = vanbury_name
						type = simple
						name = "Adénn"
					}
				}
				5 = {
					set_saved_name = {
						key = vanbury_name
						type = simple
						name = "Adanna"
					}
					set_ruler_flag = vanbury_female
				}
			}
		}
	}
	
	#Vanbury accepted
	option = {
		name = flavor_telgeir.1.b
		ai_chance = {
			factor = 100
		}
		if = {
			limit = { has_ruler_flag = vanbury_female }
			define_ruler = {
				name = vanbury_name
				dynasty = "of Vanbury"
				claim = 80
				female = yes
			}
		}
		else = {
			define_ruler = {
				name = vanbury_name
				dynasty = "of Vanbury"
				claim = 80
			}
		}
	}

	#Vanbury refused
	option = {
		name = flavor_telgeir.1.a
		ai_chance = {
			factor = 0
		}
		set_ruler_flag = vanbury_revolt
		if = {
			limit = { has_ruler_flag = vanbury_female }
			capital_scope = {
				spawn_rebels = {
					type = pretender_rebels
					size = 2
					leader = vanbury_name
					female = yes
				}
			}
		}
		else = {
			capital_scope = {
				spawn_rebels = {
					type = pretender_rebels
					size = 2
					leader = vanbury_name
				}
			}
		}
	}
}

#Kill pretender general that sticks around
country_event = {
	id = flavor_telgeir.2
	title = flavor_telgeir.2.t
	desc = flavor_telgeir.2.d
	picture = COURT_eventPicture
	
	is_triggered_only = yes
	
	hidden = yes
	
	immediate = {
		kill_leader = { type = "Tristan" }
		kill_leader = { type = "Ricard" }
		kill_leader = { type = "Artus" }
		kill_leader = { type = "Adénn" }
		kill_leader = { type = "Adanna" }
	}
}
