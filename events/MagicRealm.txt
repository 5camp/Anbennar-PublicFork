
namespace = magic_realm

#Magic Menu
country_event = {
	id = magic_realm.0
	title = magic_realm.0.t	#Have this title mention the target
	picture = MAGIC_MENU_eventPicture
	desc = magic_realm.0.d
	
	is_triggered_only = yes
	
	immediate = {
		if = { limit = { ai = no }
			hidden_effect = {
				if = { limit = { has_ruler_flag = magical_study_1 }
					set_variable = { ruler_study_experience_target = 1000 }
				}
				else_if = { limit = { has_ruler_flag = magical_study_2 }
					set_variable = { ruler_study_experience_target = 1500 }
				}
				else_if = { limit = { has_ruler_flag = magical_study_3 }
					set_variable = { ruler_study_experience_target = 2000 }
				}
				else = {
					set_variable = { ruler_study_experience_target = 5000 }
				}
				set_variable = { which = ruler_study_experience_ratio which = ruler_study_experience }
				divide_variable = { which = ruler_study_experience_ratio which = ruler_study_experience_target }
			}
		}
	}
	
	option = {
		name = magic_realm.0.a
		ai_chance = {
			factor = 50
		}
		close_single_menu = yes
	}
	
	
	option = {	
		name = magic_realm.0.b
		#trigger = { has_ruler_flag = abjuration_1 }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { has_ruler_flag = abjuration_1 }
			}
			modifier = {
				factor = 2
				is_at_war = yes
			}
		}
		hidden_effect = { country_event = { id = magic_realm.1 } }
	}
	option = {	
		name = magic_realm.0.c
		#trigger = { has_ruler_flag = conjuration_1 }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { has_ruler_flag = conjuration_1 }
			}
		}
		hidden_effect = { country_event = { id = magic_realm.2 } }
	}
	option = {	
		name = magic_realm.0.dd
		#trigger = { has_ruler_flag = divination_1 }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { has_ruler_flag = divination_1 }
			}
		}
		hidden_effect = { country_event = { id = magic_realm.3 } }
	}
	option = {	
		name = magic_realm.0.e
		#trigger = { has_ruler_flag = enchantment_1 }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { has_ruler_flag = enchantment_1 }
			}
		}
		hidden_effect = { country_event = { id = magic_realm.4 } }
	}
	option = {	
		name = magic_realm.0.f
		#trigger = { has_ruler_flag = evocation_1 }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { has_ruler_flag = evocation_1 }
			}
			modifier = {
				factor = 2
				is_at_war = yes
			}
		}
		hidden_effect = { country_event = { id = magic_realm.5 } }
	}
	option = {	
		name = magic_realm.0.g
		#trigger = { has_ruler_flag = illusion_1 }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { has_ruler_flag = illusion_1 }
			}
		}
		hidden_effect = { country_event = { id = magic_realm.6 } }
	}
	option = {	
		name = magic_realm.0.h
		#trigger = { has_ruler_flag = necromancy_1 }
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0
				NOT = { has_ruler_flag = necromancy_1 }
			}
			modifier = {
				factor = 2
				is_at_war = yes
			}
		}
		hidden_effect = { country_event = { id = magic_realm.7 } }
	}
	option = {	
		name = magic_realm.0.i
		#trigger = { has_ruler_flag = transmutation_1 }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { has_ruler_flag = transmutation_1 }
			}
			modifier = {
				factor = 4	#makes em pick this for the rite of conception
				has_ruler_flag = transmutation_2
				has_heir = no
			}
		}
		hidden_effect = { country_event = { id = magic_realm.8 } }
	}
	
	option = {
		name = magic_realm.0.a
		ai_chance = {
			factor = 0
		}
		close_single_menu = yes
	}
}

#Abjuration - Menu
country_event = {
	id = magic_realm.1
	title = magic_realm.1.t	
	desc = magic_realm.1.d
	picture = MAGIC_MENU_ABJURATION_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = { 
			count_provinces_in_capital_area = {
				which = amount_of_capital_area_provinces
			}
		}
	}
	
	#Go back
	option = {
		name = magic_realm.1.z
		ai_chance = { factor = 50 }
		if = { limit = { ai = yes }	#makes ai back out of casting completely to prevent spam
			add_ruler_modifier = { 
				name = magic_realm_menu_cooldown
				duration = 1825	#prevents them casting for 5 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			hidden_effect = { country_event = { id = magic_realm.0 } }
		}
	}
	
	#Study
	option = {
		name = magic_realm.1.a	#available
		trigger = {
			NOT = { has_ruler_flag = abjuration_3 }
			NOT = { ruler_studying_magic = yes }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.2
				OR = {
					has_ruler_flag = abjuration_1
					has_ruler_flag = abjuration_2
				}
			}
		}
		country_event = { id = magic_study.1 }
	}
	option = {
		name = magic_realm.1.as	#stop
		trigger = {
			ai = no
			has_ruler_flag = ruler_studying_abjuration
			NOT = { has_finished_magical_studies = yes }
		}
		magic_study_clear_study_effects = yes
	}
	option = {
		name = magic_realm.1.ax	#unavailable
		trigger = {
			ai = no
			NOT = { has_ruler_flag = ruler_studying_abjuration }
			OR = {
				has_ruler_flag = abjuration_3
				ruler_studying_magic = yes
				has_finished_magical_studies = yes
			}
		}
		custom_tooltip = cant_study_magic_tt
		if = { limit = { has_ruler_flag = abjuration_3 }
			custom_tooltip = school_mastery_at_max_tt
		}
		if = { limit = { ruler_studying_magic = yes }
			custom_tooltip = already_studying_magic_tt
		}
		set_country_flag = abjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
	}
	
	#1 - Ward
	option = {	#available
		name = magic_realm.1.b
		trigger = {
			has_ruler_flag = abjuration_1
			NOT = { has_ruler_flag = abjuration_2 }
			adm_power = 30
			dip_power = 5
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				is_at_war = yes
				NOT = { war_score = 20 }
			}
		}
		
		add_adm_power = -30
		add_dip_power = -5
		magic_casted_spell = yes
		country_event = { id = magic_realm.10 }
		custom_tooltip = magic_selected_province_tt
		tooltip = {
			add_province_modifier = {
				name = magic_realm_abjuration_ward
				duration = 9131
			}
		}
		custom_tooltip = magic_ward_desc_tt
	}
	option = {	#unavailable - too low mastery
		name = magic_realm.1.bm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = abjuration_2 }
			NOT = { has_ruler_flag = abjuration_1 }
		}
		custom_tooltip = school_mastery_not_talented_tt
		
		set_country_flag = abjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -30
			add_dip_power = -5
			magic_casted_spell = yes
			custom_tooltip = magic_selected_province_tt
			add_province_modifier = {
				name = magic_realm_abjuration_ward
				duration = 9131
			}
		}
		custom_tooltip = magic_ward_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.1.bx
		trigger = {
			ai = no
			NOT = { has_ruler_flag = abjuration_2 }
			has_ruler_flag = abjuration_1
			OR = {
				NOT = { adm_power = 30 }
				NOT = { dip_power = 5 }
			}
		}
		if = { limit = { NOT = { adm_power = 30 } }
			custom_tooltip = magic_need_30_adm_tt
		}
		if = { limit = { NOT = { dip_power = 5 } }
			custom_tooltip = magic_need_5_dip_tt
		}
		set_country_flag = abjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -30
			add_dip_power = -5
			magic_casted_spell = yes
			custom_tooltip = magic_selected_province_tt
			add_province_modifier = {
				name = magic_realm_abjuration_ward
				duration = 9131
			}
		}
		custom_tooltip = magic_ward_desc_tt
	}
	
	#2 - Ward II
	option = {	#available
		name = magic_realm.1.c
		trigger = {
			has_ruler_flag = abjuration_2
			adm_power = 30
			dip_power = 5
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				is_at_war = yes
				NOT = { war_score = 20 }
			}
		}
		
		add_adm_power = -30
		add_dip_power = -5
		magic_casted_spell = yes
		country_event = { id = magic_realm.10 }
		custom_tooltip = magic_selected_province_tt
		tooltip = {
			add_province_modifier = {
				name = magic_realm_abjuration_empowered_ward
				duration = 9131
			}
		}
		custom_tooltip = magic_ward_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.1.cm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = abjuration_2 }
		}
		custom_tooltip = school_mastery_not_renowned_tt
		
		set_country_flag = abjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -30
			add_dip_power = -5
			magic_casted_spell = yes
			custom_tooltip = magic_selected_province_tt
			add_province_modifier = {
				name = magic_realm_abjuration_empowered_ward
				duration = 9131
			}
		}
		custom_tooltip = magic_ward_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.1.cx
		trigger = {
			ai = no
			has_ruler_flag = abjuration_2
			OR = {
				NOT = { adm_power = 30 }
				NOT = { dip_power = 5 }
			}
		}
		if = { limit = { NOT = { adm_power = 30 } }
			custom_tooltip = magic_need_30_adm_tt
		}
		
		if = { limit = { NOT = { dip_power = 5 } }
			custom_tooltip = magic_need_5_dip_tt
		}
		
		set_country_flag = abjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -30
			add_dip_power = -5
			magic_casted_spell = yes
			custom_tooltip = magic_selected_province_tt
			add_province_modifier = {
				name = magic_realm_abjuration_empowered_ward
				duration = 9131
			}
		}
		custom_tooltip = magic_ward_desc_tt
	}
	
	#3 - Field of Freedom
	option = {	#available
		name = magic_realm.1.dd
		trigger = {
			has_ruler_flag = abjuration_3
			NOT = {
				any_owned_province = {
					OR = {
						has_province_modifier = magic_realm_abjuration_field_of_freedom
						has_province_modifier = magic_realm_abjuration_field_of_forbiddance
						has_province_modifier = magic_realm_abjuration_field_of_fortification
					}
				}
			}
		}
		ai_chance = {
			factor = 20
			modifier = {
				factor = 5
				is_at_war = yes
				NOT = { war_score = 40 }
			}
		}
		
		hidden_effect = {
			every_owned_province = { 
				limit = { is_in_capital_area = yes }
				add_province_modifier = { 
					name = magic_realm_abjuration_field_of_freedom
					duration = 1825
				}
			}
		}
		magic_field_adm_cost = yes
		magic_casted_spell = yes
		custom_tooltip = magic_field_effect_tt
		tooltip = {
			add_province_modifier = { 
				name = magic_realm_abjuration_field_of_freedom
				duration = 1825
			}
		}
		custom_tooltip = magic_field_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.1.ddm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = abjuration_3 }
		}
		custom_tooltip = school_mastery_not_legendary_tt
		
		set_country_flag = abjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			magic_field_adm_cost = yes 
			custom_tooltip = magic_field_effect_tt
			add_province_modifier = { 
				name = magic_realm_abjuration_field_of_freedom
				duration = 1825
			}
		}
		custom_tooltip = magic_field_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.1.ddx
		trigger = {
			ai = no
			has_ruler_flag = abjuration_3
			any_owned_province = {
				OR = {
					has_province_modifier = magic_realm_abjuration_field_of_freedom
					has_province_modifier = magic_realm_abjuration_field_of_forbiddance
					has_province_modifier = magic_realm_abjuration_field_of_fortification
				}
			}
		}
		custom_tooltip = province_has_abjuration_field_tt
		
		set_country_flag = abjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			magic_field_adm_cost = yes 
			custom_tooltip = magic_field_effect_tt
			add_province_modifier = { 
				name = magic_realm_abjuration_field_of_freedom
				duration = 1825
			}
		}
		custom_tooltip = magic_field_desc_tt
	}
	
	#3 - Field of Forbiddance
	option = {	#available
		name = magic_realm.1.e
		trigger = {
			has_ruler_flag = abjuration_3
			NOT = {
				any_owned_province = {
					OR = {
						has_province_modifier = magic_realm_abjuration_field_of_freedom
						has_province_modifier = magic_realm_abjuration_field_of_forbiddance
						has_province_modifier = magic_realm_abjuration_field_of_fortification
					}
				}
			}
		}
		ai_chance = {
			factor = 20
			modifier = {
				factor = 5
				is_at_war = yes
				NOT = { war_score = 40 }
			}
		}
		
		hidden_effect = {
			every_owned_province = { 
				limit = { is_in_capital_area = yes }
				add_province_modifier = { 
					name = magic_realm_abjuration_field_of_forbiddance
					duration = 365
				}
			}
		}
		
		magic_field_adm_cost = yes		
		magic_casted_spell = yes
		custom_tooltip = magic_field_effect_tt
		tooltip = {
			add_province_modifier = { 
				name = magic_realm_abjuration_field_of_forbiddance
				duration = 1825
			}
		}
		custom_tooltip = magic_field_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.1.em
		trigger = {
			ai = no
			NOT = { has_ruler_flag = abjuration_3 }
		}
		custom_tooltip = school_mastery_not_legendary_tt
		
		set_country_flag = abjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			magic_field_adm_cost = yes 
			custom_tooltip = magic_field_effect_tt
			add_province_modifier = { 
				name = magic_realm_abjuration_field_of_forbiddance
				duration = 1825
			}
		}
		custom_tooltip = magic_field_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.1.ex
		trigger = {
			ai = no
			has_ruler_flag = abjuration_3
			any_owned_province = {
				OR = {
					has_province_modifier = magic_realm_abjuration_field_of_freedom
					has_province_modifier = magic_realm_abjuration_field_of_forbiddance
					has_province_modifier = magic_realm_abjuration_field_of_fortification
				}
			}
		}
		custom_tooltip = province_has_abjuration_field_tt
		
		set_country_flag = abjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			magic_field_adm_cost = yes 
			custom_tooltip = magic_field_effect_tt
			add_province_modifier = { 
				name = magic_realm_abjuration_field_of_forbiddance
				duration = 1825
			}
		}
		custom_tooltip = magic_field_desc_tt
	}
	
	#3 - Field of Fortification
	option = {	#available
		name = magic_realm.1.f
		trigger = {
			has_ruler_flag = abjuration_3
			NOT = {
				any_owned_province = {
					OR = {
						has_province_modifier = magic_realm_abjuration_field_of_freedom
						has_province_modifier = magic_realm_abjuration_field_of_forbiddance
						has_province_modifier = magic_realm_abjuration_field_of_fortification
					}
				}
			}
		}
		ai_chance = {
			factor = 20
			modifier = {
				factor = 5
				is_at_war = yes
				NOT = { war_score = 40 }
			}
		}
		
		hidden_effect = {
			every_owned_province = { 
				limit = { is_in_capital_area = yes }
				add_province_modifier = { 
					name = magic_realm_abjuration_field_of_fortification
					duration = 1825
				}
			}
		}
		
		magic_field_adm_cost = yes		
		magic_casted_spell = yes
		custom_tooltip = magic_field_effect_tt
		tooltip = {
			add_province_modifier = { 
				name = magic_realm_abjuration_field_of_fortification
				duration = 1825
			}
		}
		custom_tooltip = magic_field_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.1.fm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = abjuration_3 }
		}
		custom_tooltip = school_mastery_not_legendary_tt
		
		set_country_flag = abjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			magic_field_adm_cost = yes 
			custom_tooltip = magic_field_effect_tt
			add_province_modifier = { 
				name = magic_realm_abjuration_field_of_fortification
				duration = 1825
			}
		}
		custom_tooltip = magic_field_desc_tt
	}
	option = {	#unavailable
		name = magic_realm.1.fx
		trigger = {
			ai = no
			has_ruler_flag = abjuration_3
			any_owned_province = {
				OR = {
					has_province_modifier = magic_realm_abjuration_field_of_freedom
					has_province_modifier = magic_realm_abjuration_field_of_forbiddance
					has_province_modifier = magic_realm_abjuration_field_of_fortification
				}
			}
		}
		custom_tooltip = province_has_abjuration_field_tt
		
		set_country_flag = abjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			magic_field_adm_cost = yes 
			custom_tooltip = magic_field_effect_tt
			add_province_modifier = { 
				name = magic_realm_abjuration_field_of_fortification
				duration = 1825
			}
		}
		custom_tooltip = magic_field_desc_tt
	}
	
	#Go back
	option = {	
		name = magic_realm.1.z
		trigger = { ai = no }
		hidden_effect = { country_event = { id = magic_realm.0 } }
	}
}

#Conjuration - Menu
country_event = {
	id = magic_realm.2
	title = magic_realm.2.t	
	desc = magic_realm.2.d
	picture = EMPTY_eventPicture
	
	is_triggered_only = yes
	
	#Go back
	option = {
		name = magic_realm.1.z
		ai_chance = { factor = 50 }
		if = { limit = { ai = yes }	#makes ai back out of casting completely to prevent spam
			add_ruler_modifier = { 
				name = magic_realm_menu_cooldown
				duration = 1825	#prevents them casting for 5 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			hidden_effect = { country_event = { id = magic_realm.0 } }
		}
	}
	
	#Study
	option = {
		name = magic_realm.1.a	#available
		trigger = {
			NOT = { has_ruler_flag = conjuration_3 }
			NOT = { ruler_studying_magic = yes }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.2
				OR = {
					has_ruler_flag = conjuration_1
					has_ruler_flag = conjuration_2
				}
			}
		}
		country_event = { id = magic_study.4 }
	}
	option = {
		name = magic_realm.1.as	#stop
		trigger = {
			ai = no
			has_ruler_flag = ruler_studying_conjuration
			NOT = { has_finished_magical_studies = yes }
		}
		magic_study_clear_study_effects = yes
	}
	option = {
		name = magic_realm.1.ax	#unavailable
		trigger = {
			ai = no
			NOT = { has_ruler_flag = ruler_studying_conjuration }
			OR = {
				has_ruler_flag = conjuration_3
				ruler_studying_magic = yes
				has_finished_magical_studies = yes
			}
		}
		custom_tooltip = cant_study_magic_tt
		if = { limit = { has_ruler_flag = conjuration_3 }
			custom_tooltip = school_mastery_at_max_tt
		}
		if = { limit = { ruler_studying_magic = yes }
			custom_tooltip = already_studying_magic_tt
		}
		set_country_flag = conjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
	}
	
	#1 - Host Magnificent Feast I
	option = {	#available
		name = magic_realm.2.b
		trigger = {
			has_ruler_flag = conjuration_1
			dip_power = 15
			NOT = { has_ruler_flag = conjuration_2 }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				personality = ai_diplomat
			}
			modifier = {
				factor = 2
				NOT = { prestige = 20 }
			}
			modifier = {
				factor = 0
				OR = {
					has_ruler_modifier = magic_realm_conjuration_magnificent_feast_1
					has_ruler_modifier = magic_realm_conjuration_magnificent_feast_2
				}
			}
		}
		
		add_dip_power = -15
		magic_casted_spell = yes
		country_event = { id = magic_realm.11 }
		
		custom_tooltip = magic_feast_effect_tt
		custom_tooltip = magic_feast_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.2.bm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = conjuration_2 }
			NOT = { has_ruler_flag = conjuration_1 }
		}
		custom_tooltip = school_mastery_not_talented_tt
		
		set_country_flag = conjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = { add_dip_power = -15 }
		custom_tooltip = magic_feast_effect_tt
		custom_tooltip = magic_feast_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.2.bx
		trigger = {
			ai = no
			NOT = { has_ruler_flag = conjuration_2 }
			has_ruler_flag = conjuration_1
			NOT = { dip_power = 15 }
		}
		custom_tooltip = magic_need_15_dip_tt
		
		set_country_flag = conjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = { add_dip_power = -15 }
		custom_tooltip = magic_feast_effect_tt
		custom_tooltip = magic_feast_desc_tt
	}
	
	#1 - Summon Siege Elemental
	option = {
		name = magic_realm.2.c	#available
		trigger = {
			has_ruler_flag = conjuration_1
			is_at_war = yes
			is_lesser_in_union = no
			any_army = {
				location = {
					fort_level = 1
					sieged_by = ROOT
					unit_has_leader = yes
				}
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				OR = {
					NOT = { adm_power = 20 }
					NOT = { dip_power = 20 }
					NOT = { mil_power = 20 }
				}
			}
		}
		
		country_event = { id = magic_siege.2 days = 0 }
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			add_province_modifier = {
				name = siege_magic_elemental_besieger
				duration = 84
			}
		}
		custom_tooltip = magic_elemental_desc_tt
	}
	option = {
		name = magic_realm.2.cm	#unavailable - low mastery
		trigger = {
			ai = no
			NOT = { has_ruler_flag = conjuration_1 }
		}
		set_country_flag = conjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = school_mastery_not_talented_tt
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			add_province_modifier = {
				name = siege_magic_elemental_besieger
				duration = 84
			}
		}
		custom_tooltip = magic_elemental_desc_tt
	}
	option = {
		name = magic_realm.2.cx	#unavailable - other
		trigger = {
			ai = no
			has_ruler_flag = conjuration_1
			OR = {
				is_at_war = no
				is_lesser_in_union = yes
				NOT = {
					any_army = {
						location = {
							fort_level = 1
							sieged_by = ROOT
							unit_has_leader = yes
						}
					}
				}
			}
		}
		set_country_flag = conjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		if = { limit = { is_at_war = no }
			custom_tooltip = magic_is_at_war_tt
		}
		if = { limit = { is_lesser_in_union = yes }
			custom_tooltip = magic_is_not_in_lesser_union_tt
		}
		if = {
			limit = {
				NOT = {
					any_army = {
						location = {
							fort_level = 1
							sieged_by = ROOT
							unit_has_leader = yes
						}
					}
				}
			}
			custom_tooltip = magic_leadered_army_sieging_tt
		}
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			add_province_modifier = {
				name = siege_magic_elemental_besieger
				duration = 84
			}
		}
		custom_tooltip = magic_elemental_desc_tt
	}
	
	#2 - Host Magnificent Feast II
	option = {	#available
		name = magic_realm.2.dd
		trigger = {
			has_ruler_flag = conjuration_2
			dip_power = 15
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				personality = ai_diplomat
			}
			modifier = {
				factor = 2
				NOT = { prestige = 20 }
			}
			modifier = {
				factor = 0
				OR = {
					has_ruler_modifier = magic_realm_conjuration_magnificent_feast_1
					has_ruler_modifier = magic_realm_conjuration_magnificent_feast_2
				}
			}
		}
		
		add_dip_power = -15
		magic_casted_spell = yes
		country_event = { id = magic_realm.11 }
		custom_tooltip = magic_greater_feast_effect_tt
		custom_tooltip = magic_feast_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.2.ddm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = conjuration_2 }
		}
		custom_tooltip = school_mastery_not_renowned_tt
		
		set_country_flag = conjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = { add_dip_power = -15 }
		custom_tooltip = magic_greater_feast_effect_tt
		custom_tooltip = magic_feast_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.2.ddx
		trigger = {
			ai = no
			has_ruler_flag = conjuration_2
			NOT = { dip_power = 15 }
		}
		custom_tooltip = magic_need_15_dip_tt
		
		set_country_flag = conjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = { add_dip_power = -15 }
		custom_tooltip = magic_greater_feast_effect_tt
		custom_tooltip = magic_feast_desc_tt
	}
	
	#2 - Thunderstorm
	option = {
		name = magic_realm.2.e	#available
		trigger = {
			has_ruler_flag = conjuration_2
			is_at_war = yes
			is_lesser_in_union = no
			any_army = {
				location = {
					fort_level = 1
					sieged_by = ROOT
					unit_has_leader = yes
				}
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				OR = {
					NOT = { adm_power = 20 }
					NOT = { dip_power = 20 }
					NOT = { mil_power = 20 }
				}
			}
		}
		
		country_event = { id = magic_siege.17 days = 0 }
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 5
			add_devastation = 5
			add_province_modifier = {
				name = siege_magic_thunderstorm
				duration = 182
			}
		}
		custom_tooltip = magic_thunderstorm_desc_tt
	}
	option = {
		name = magic_realm.2.em	#unavailable - low mastery
		trigger = {
			ai = no
			NOT = { has_ruler_flag = conjuration_2 }
		}
		set_country_flag = conjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = school_mastery_not_renowned_tt
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 5
			add_devastation = 5
			add_province_modifier = {
				name = siege_magic_thunderstorm
				duration = 182
			}
		}
		custom_tooltip = magic_thunderstorm_desc_tt
	}
	option = {
		name = magic_realm.2.ex	#unavailable - other
		trigger = {
			ai = no
			has_ruler_flag = conjuration_2
			OR = {
				is_at_war = no
				is_lesser_in_union = yes
				NOT = {
					any_army = {
						location = {
							fort_level = 1
							sieged_by = ROOT
							unit_has_leader = yes
						}
					}
				}
			}
		}
		set_country_flag = conjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		if = { limit = { is_at_war = no }
			custom_tooltip = magic_is_at_war_tt
		}
		if = { limit = { is_lesser_in_union = yes }
			custom_tooltip = magic_is_not_in_lesser_union_tt
		}
		if = {
			limit = {
				NOT = {
					any_army = {
						location = {
							fort_level = 1
							sieged_by = ROOT
							unit_has_leader = yes
						}
					}
				}
			}
			custom_tooltip = magic_leadered_army_sieging_tt
		}
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 5
			add_devastation = 5
			add_province_modifier = {
				name = siege_magic_thunderstorm
				duration = 182
			}
		}
		custom_tooltip = magic_thunderstorm_desc_tt
	}
	
	#3 - Conjure Magical Fortress
	option = {	#available
		name = magic_realm.2.f
		trigger = {
			OR = {
				has_ruler_flag = conjuration_3
				AND = {
					has_ruler_flag = conjuration_2
					has_ruler_flag = honored_ancestor_patron
				}
			}
			adm_power = 100
			dip_power = 100
			mil_power = 100
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				is_at_war = yes
				NOT = { war_score = 20 }
			}
			modifier = {
				factor = 4
				OR = {
					personality = ai_militarist
					personality = ai_capitalist 
				}
			}
		}
		
		add_adm_power = -100
		add_dip_power = -100
		add_mil_power = -100
		magic_casted_spell = yes
		country_event = { id = magic_realm.12 }
		custom_tooltip = magic_fortress_effect_tt
		custom_tooltip = magic_fortress_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.2.fm
		trigger = {
			ai = no
			NOT = {
				OR = {
					has_ruler_flag = conjuration_3
					AND = {
						has_ruler_flag = conjuration_2
						has_ruler_flag = honored_ancestor_patron
					}
				}
			}
		}
		custom_tooltip = school_mastery_not_legendary_tt
		
		set_country_flag = conjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -100
			add_dip_power = -100
			add_mil_power = -100
		}
		custom_tooltip = magic_selected_province_tt
		custom_tooltip = magic_fortress_effect_tt
		custom_tooltip = magic_fortress_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.2.fx
		trigger = {
			ai = no
			OR = {
				has_ruler_flag = conjuration_3
				AND = {
					has_ruler_flag = conjuration_2
					has_ruler_flag = honored_ancestor_patron
				}
			}
			OR = {
				NOT = { adm_power = 100 }
				NOT = { dip_power = 100 }
				NOT = { mil_power = 100 }
			}
		}
		if = { limit = { NOT = { adm_power = 100 } }
			custom_tooltip = magic_need_100_adm_tt
		}
		if = { limit = { NOT = { dip_power = 100 } }
			custom_tooltip = magic_need_100_dip_tt
		}
		if = { limit = { NOT = { mil_power = 100 } }
			custom_tooltip = magic_need_100_mil_tt
		}
		
		set_country_flag = conjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -100
			add_dip_power = -100
			add_mil_power = -100
		}
		custom_tooltip = magic_selected_province_tt
		custom_tooltip = magic_fortress_effect_tt
		custom_tooltip = magic_fortress_desc_tt
	}
	
	#3 - Summoning Magic Project
	option = {	#available
		name = magic_realm.2.g
		trigger = {
			capital_scope = { continent = asia }
			OR = {
				has_ruler_flag = conjuration_3
				AND = {
					has_ruler_flag = divination_2
					has_ruler_flag = conjuration_2
				}
			}
			NOT = { has_ruler_flag = magic_project_summoning_complete }
			NOT = { magical_project_in_progress = yes }
			adm_power = 50
			dip_power = 50
			mil_power = 50
		}
		ai_chance = {
			factor = 50
		}
		
		add_adm_power = -50
		add_dip_power = -50
		add_mil_power = -50
		magic_casted_spell = yes
		set_ruler_flag = magic_project_summoning_started
		custom_tooltip = tooltip_magic_project_start
		hidden_effect = { country_event = { id = magic_project_summoning.1 } }
		custom_tooltip = magic_summoning_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.2.gm
		trigger = {
			ai = no
			capital_scope = { continent = asia }
			NOT = {
				OR = {
					has_ruler_flag = conjuration_3
					AND = {
						has_ruler_flag = divination_2
						has_ruler_flag = conjuration_2
					}
				}
			}
		}
		custom_tooltip = school_mastery_not_enough_summoning_tt
		
		set_country_flag = conjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -50
			add_dip_power = -50
			add_mil_power = -50
			custom_tooltip = tooltip_magic_project_start
		}
		custom_tooltip = magic_summoning_desc_tt
	}
	option = {	#unavailable
		name = magic_realm.2.gx
		trigger = {
			ai = no
			capital_scope = { continent = asia }
			OR = {
				has_ruler_flag = conjuration_3
				AND = {
					has_ruler_flag = divination_2
					has_ruler_flag = conjuration_2
				}
			}
			OR = {
				has_ruler_flag = magic_project_summoning_complete
				magical_project_in_progress = yes
				NOT = { adm_power = 50 }
				NOT = { dip_power = 50 }
				NOT = { mil_power = 50 }
			}
		}
		if = { limit = { has_ruler_flag = magic_project_summoning_complete }
			custom_tooltip = magic_project_already_done_tt
		}
		else = {
			if = { limit = { has_ruler_flag = magic_project_summoning_started }
				custom_tooltip = magic_project_started_tt
			}
			else_if = { limit = { magical_project_in_progress = yes }
				custom_tooltip = magic_other_project_in_progress_tt
			}
			if = { limit = { NOT = { adm_power = 50 } }
				custom_tooltip = magic_need_50_adm_tt
			}
			if = { limit = { NOT = { dip_power = 50 } }
				custom_tooltip = magic_need_50_dip_tt
			}
			if = { limit = { NOT = { mil_power = 50 } }
				custom_tooltip = magic_need_50_mil_tt
			}
		}
		
		set_country_flag = conjuration_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -50
			add_dip_power = -50
			add_mil_power = -50
			custom_tooltip = tooltip_magic_project_start
		}
		custom_tooltip = magic_summoning_desc_tt
	}
	
	#Go back
	option = {	
		name = magic_realm.1.z
		trigger = { ai = no }
		hidden_effect = { country_event = { id = magic_realm.0 } }
	}
}

#Divination - Menu
country_event = {
	id = magic_realm.3
	title = magic_realm.3.t	
	desc = magic_realm.3.d
	picture = EMPTY_eventPicture
	
	is_triggered_only = yes
	
	#Go back
	option = {
		name = magic_realm.1.z
		ai_chance = { factor = 50 }
		if = { limit = { ai = yes }	#makes ai back out of casting completely to prevent spam
			add_ruler_modifier = { 
				name = magic_realm_menu_cooldown
				duration = 1825	#prevents them casting for 5 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			hidden_effect = { country_event = { id = magic_realm.0 } }
		}
	}
	
	#Study
	option = {
		name = magic_realm.1.a	#available
		trigger = {
			NOT = { has_ruler_flag = divination_3 }
			NOT = { ruler_studying_magic = yes }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.2
				OR = {
					has_ruler_flag = divination_1
					has_ruler_flag = divination_2
				}
			}
		}
		country_event = { id = magic_study.7 }
	}
	option = {
		name = magic_realm.1.as	#stop
		trigger = {
			ai = no
			has_ruler_flag = ruler_studying_divination
			NOT = { has_finished_magical_studies = yes }
		}
		magic_study_clear_study_effects = yes
	}
	option = {
		name = magic_realm.1.ax	#unavailable
		trigger = {
			ai = no
			NOT = { has_ruler_flag = ruler_studying_divination }
			OR = {
				has_ruler_flag = divination_3
				ruler_studying_magic = yes
				has_finished_magical_studies = yes
			}
		}
		custom_tooltip = cant_study_magic_tt
		if = { limit = { has_ruler_flag = divination_3 }
			custom_tooltip = school_mastery_at_max_tt
		}
		if = { limit = { ruler_studying_magic = yes }
			custom_tooltip = already_studying_magic_tt
		}
		set_country_flag = divination_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
	}
	
	#1 - Scrying
	option = {	#available
		name = magic_realm.3.b
		trigger = {
			has_ruler_flag = divination_1
			adm_power = 50
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_realm.13 }
		
		custom_tooltip = magic_scrying_effect_tt
		custom_tooltip = magic_scrying_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.3.bm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = divination_1 }
		}
		custom_tooltip = school_mastery_not_talented_tt
		
		set_country_flag = divination_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_scrying_effect_tt
		custom_tooltip = magic_scrying_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.3.bx
		trigger = {
			ai = no
			has_ruler_flag = divination_1
			NOT = { adm_power = 50 }
		}
		custom_tooltip = magic_need_50_adm_tt
		
		set_country_flag = divination_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_scrying_effect_tt
		custom_tooltip = magic_scrying_desc_tt
	}
	
	#2 - Loreseeker
	option = {	#available
		name = magic_realm.3.c
		trigger = {
			has_ruler_flag = divination_2
			ruler_studying_magic = yes
		}
		ai_chance = {
			factor = 50
		}
		
		magic_casted_spell = yes
		magic_legend_lore_effect = yes
		custom_tooltip = magic_loreseeker_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.3.cm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = divination_2 }
		}
		custom_tooltip = school_mastery_not_renowned_tt
		
		set_country_flag = divination_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = { magic_legend_lore_effect = yes }
		custom_tooltip = magic_loreseeker_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.3.cx
		trigger = {
			ai = no
			has_ruler_flag = divination_2
			NOT = { ruler_studying_magic = yes }
		}
		custom_tooltip = magic_ruler_studying_magic_tt
		
		set_country_flag = divination_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = { magic_legend_lore_effect = yes }
		custom_tooltip = magic_loreseeker_desc_tt
	}
	
	#3 - Foresight
	option = {	#available
		name = magic_realm.3.dd
		trigger = {
			has_ruler_flag = divination_3
			adm_power = 150
			dip_power = 150
			mil_power = 150
			NOT = { has_ruler_modifier = magic_realm_divination_foresight }
			NOT = { has_ruler_modifier = magic_realm_divination_foresight_madness }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				ruler_has_personality = careful_personality
			}
			modifier = {
				factor = 0.25
				ruler_has_personality = immortal_personality	#long-lived people dont care!
			}
			modifier = {
				factor = 0.5
				OR = {
					has_ruler_flag = foresight_spell_11
					has_ruler_flag = foresight_spell_12
					has_ruler_flag = foresight_spell_13
					has_ruler_flag = foresight_spell_14
					has_ruler_flag = foresight_spell_15
				}
			}
			modifier = {
				factor = 0.25
				OR = {
					has_ruler_flag = foresight_spell_16
					has_ruler_flag = foresight_spell_17
					has_ruler_flag = foresight_spell_18
					has_ruler_flag = foresight_spell_19
					has_ruler_flag = foresight_spell_20
				}
			}
			modifier = {
				factor = 1.5
				OR = {
					ruler_has_personality = naive_personality 
				}
			}
		}
		add_adm_power = -150
		add_dip_power = -150
		add_mil_power = -150
		magic_casted_spell = yes
		casted_foresight_spell_flag = yes
		apply_foresight_spell = yes
		
		custom_tooltip = magic_foresight_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.3.ddm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = divination_3 }
		}
		custom_tooltip = school_mastery_not_legendary_tt
		
		set_country_flag = divination_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			casted_foresight_spell_flag = yes
			apply_foresight_spell = yes
		}
		custom_tooltip = magic_foresight_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.3.ddx
		trigger = {
			ai = no
			has_ruler_flag = divination_3
			OR = {
				NOT = { adm_power = 150 }
				NOT = { dip_power = 150 }
				NOT = { mil_power = 150 }
				has_ruler_modifier = magic_realm_divination_foresight
				has_ruler_modifier = magic_realm_divination_foresight_madness
			}
		}
		if = { limit = { NOT = { adm_power = 150 } }
			custom_tooltip = magic_need_150_adm_tt
		}
		if = { limit = { NOT = { dip_power = 150 } }
			custom_tooltip = magic_need_150_dip_tt
		}
		if = { limit = { NOT = { mil_power = 150 } }
			custom_tooltip = magic_need_150_mil_tt
		}
		if = { limit = { has_ruler_modifier = magic_realm_divination_foresight }
			custom_tooltip = magic_spell_already_active_tt
		}
		if = { limit = { has_ruler_modifier = magic_realm_divination_foresight_madness }
			custom_tooltip = magic_foresight_madness_tt
		}
		set_country_flag = divination_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			casted_foresight_spell_flag = yes
			apply_foresight_spell = yes
		}
		custom_tooltip = magic_foresight_desc_tt
	}
	
	#3 - Summoning Magic Project (copy from Conjuration)
	option = {	#available
		name = magic_realm.2.g
		trigger = {
			capital_scope = { continent = asia }
			OR = {
				has_ruler_flag = divination_3
				AND = {
					has_ruler_flag = divination_2
					has_ruler_flag = conjuration_2
				}
			}
			NOT = { has_ruler_flag = magic_project_summoning_complete }
			NOT = { magical_project_in_progress = yes }
			adm_power = 50
			dip_power = 50
			mil_power = 50
		}
		ai_chance = {
			factor = 50
		}
		
		add_adm_power = -50
		add_dip_power = -50
		add_mil_power = -50
		magic_casted_spell = yes
		set_ruler_flag = magic_project_summoning_started
		custom_tooltip = tooltip_magic_project_start
		hidden_effect = { country_event = { id = magic_project_summoning.1 } }
		custom_tooltip = magic_summoning_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.2.gm
		trigger = {
			ai = no
			capital_scope = { continent = asia }
			NOT = {
				OR = {
					has_ruler_flag = divination_3
					AND = {
						has_ruler_flag = divination_2
						has_ruler_flag = conjuration_2
					}
				}
			}
		}
		custom_tooltip = school_mastery_not_enough_summoning_tt
		
		set_country_flag = divination_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -50
			add_dip_power = -50
			add_mil_power = -50
			custom_tooltip = tooltip_magic_project_start
		}
		custom_tooltip = magic_summoning_desc_tt
	}
	option = {	#unavailable
		name = magic_realm.2.gx
		trigger = {
			ai = no
			capital_scope = { continent = asia }
			OR = {
				has_ruler_flag = divination_3
				AND = {
					has_ruler_flag = divination_2
					has_ruler_flag = conjuration_2
				}
			}
			OR = {
				has_ruler_flag = magic_project_summoning_complete
				magical_project_in_progress = yes
				NOT = { adm_power = 50 }
				NOT = { dip_power = 50 }
				NOT = { mil_power = 50 }
			}
		}
		if = { limit = { has_ruler_flag = magic_project_summoning_complete }
			custom_tooltip = magic_project_already_done_tt
		}
		else = {
			if = { limit = { has_ruler_flag = magic_project_summoning_started }
				custom_tooltip = magic_project_started_tt
			}
			else_if = { limit = { magical_project_in_progress = yes }
				custom_tooltip = magic_other_project_in_progress_tt
			}
			if = { limit = { NOT = { adm_power = 50 } }
				custom_tooltip = magic_need_50_adm_tt
			}
			if = { limit = { NOT = { dip_power = 50 } }
				custom_tooltip = magic_need_50_dip_tt
			}
			if = { limit = { NOT = { mil_power = 50 } }
				custom_tooltip = magic_need_50_mil_tt
			}
		}
		
		set_country_flag = divination_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -50
			add_dip_power = -50
			add_mil_power = -50
			custom_tooltip = tooltip_magic_project_start
		}
		custom_tooltip = magic_summoning_desc_tt
	}
}

#Enchantment - Menu
country_event = {
	id = magic_realm.4
	title = magic_realm.4.t	
	desc = magic_realm.4.d
	picture = EMPTY_eventPicture
	
	is_triggered_only = yes
	
	#Go back
	option = {
		name = magic_realm.1.z
		ai_chance = { factor = 50 }
		if = { limit = { ai = yes }	#makes ai back out of casting completely to prevent spam
			add_ruler_modifier = { 
				name = magic_realm_menu_cooldown
				duration = 1825	#prevents them casting for 5 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			hidden_effect = { country_event = { id = magic_realm.0 } }
		}
	}
	
	#Study
	option = {
		name = magic_realm.1.a	#available
		trigger = {
			NOT = { has_ruler_flag = enchantment_3 }
			NOT = { ruler_studying_magic = yes }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.2
				OR = {
					has_ruler_flag = enchantment_1
					has_ruler_flag = enchantment_2
				}
			}
		}
		country_event = { id = magic_study.10 }
	}
	option = {
		name = magic_realm.1.as	#stop
		trigger = {
			ai = no
			has_ruler_flag = ruler_studying_enchantment
			NOT = { has_finished_magical_studies = yes }
		}
		magic_study_clear_study_effects = yes
	}
	option = {
		name = magic_realm.1.ax	#unavailable
		trigger = {
			ai = no
			NOT = { has_ruler_flag = ruler_studying_enchantment }
			OR = {
				has_ruler_flag = enchantment_3
				ruler_studying_magic = yes
				has_finished_magical_studies = yes
			}
		}
		custom_tooltip = cant_study_magic_tt
		if = { limit = { has_ruler_flag = enchantment_3 }
			custom_tooltip = school_mastery_at_max_tt
		}
		if = { limit = { ruler_studying_magic = yes }
			custom_tooltip = already_studying_magic_tt
		}
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
	}
	
	#1 - Charm I - Estates
	option = {	#available
		name = magic_realm.4.b
		trigger = {
			has_ruler_flag = enchantment_1
			dip_power = 30
			mil_power = 10
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				OR = {
					NOT = { estate_loyalty = { estate = estate_church loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_nobles loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_burghers loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_nomadic_tribes loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_mages loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_adventurers loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_artificers loyalty = 30 } }
				}
			}
		}
		
		add_dip_power = -30
		add_mil_power = -10
		magic_casted_spell = yes
		if = {
			limit = {
				OR = {
					has_ruler_flag = huli_jing_patron
					has_ruler_flag = gumiho_patron
				}
			}
			custom_tooltip = magic_booster_by_patron_tt
			add_estate_loyalty_modifier = {
				estate = all
				desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_1
				loyalty = 6
				duration = 3650
			}
		}
		else = {
			add_estate_loyalty_modifier = {
				estate = all
				desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_1
				loyalty = 3
				duration = 3650
			}
		}
		custom_tooltip = magic_charm_estates_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.4.bm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
			NOT = { has_ruler_flag = enchantment_1 }
		}
		custom_tooltip = school_mastery_not_talented_tt
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_estate_loyalty_modifier = {
					estate = all
					desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_1
					loyalty = 6
					duration = 3650
				}
			}
			else = {
				add_estate_loyalty_modifier = {
					estate = all
					desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_1
					loyalty = 3
					duration = 3650
				}
			}
		}
		custom_tooltip = magic_charm_estates_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.4.bx
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
			has_ruler_flag = enchantment_1
			OR = {
				NOT = { dip_power = 30 }
				NOT = { mil_power = 10 }
			}
		}
		if = { limit = { NOT = { dip_power = 30 } }
			custom_tooltip = magic_need_30_dip_tt
		}
		if = { limit = { NOT = { mil_power = 10 } }
			custom_tooltip = magic_need_10_mil_tt
		}
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_estate_loyalty_modifier = {
					estate = all
					desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_1
					loyalty = 6
					duration = 3650
				}
			}
			else = {
				add_estate_loyalty_modifier = {
					estate = all
					desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_1
					loyalty = 3
					duration = 3650
				}
			}
		}
		custom_tooltip = magic_charm_estates_desc_tt
	}
	
	#1 - Charm I - Diplomats
	option = {	#available
		name = magic_realm.4.c
		trigger = {
			has_ruler_flag = enchantment_1
			dip_power = 30
			mil_power = 10
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_1 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_2 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_3 }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				personality = ai_diplomat
			}
		}
		
		add_dip_power = -30
		add_mil_power = -10
		magic_casted_spell = yes
		if = {
			limit = {
				OR = {
					has_ruler_flag = huli_jing_patron
					has_ruler_flag = gumiho_patron
				}
			}
			custom_tooltip = magic_booster_by_patron_tt
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_impress_foreign_diplomats_1
				duration = 3650
			}
		}
		else = {
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_impress_foreign_diplomats_1
				duration = 1825
			}
		}
		custom_tooltip = magic_charm_diplomats_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.4.cm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
			NOT = { has_ruler_flag = enchantment_1 }
		}
		custom_tooltip = school_mastery_not_talented_tt
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_impress_foreign_diplomats_1
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_impress_foreign_diplomats_1
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_diplomats_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.4.cx
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
			has_ruler_flag = enchantment_1
			OR = {
				NOT = { dip_power = 30 }
				NOT = { mil_power = 10 }
				has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_1
				has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_2
				has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_3
			}
		}
		if = { limit = { NOT = { dip_power = 30 } }
			custom_tooltip = magic_need_30_dip_tt
		}
		if = { limit = { NOT = { mil_power = 10 } }
			custom_tooltip = magic_need_10_mil_tt
		}
		if = {
			limit = {
				OR = {
					has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_1
					has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_2
					has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_3
				}
			}
			custom_tooltip = magic_spell_already_active_tt
		}
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_impress_foreign_diplomats_1
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_impress_foreign_diplomats_1
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_diplomats_desc_tt
	}
	
	#1 - Charm I - Military
	option = {	#available
		name = magic_realm.4.dd
		trigger = {
			has_ruler_flag = enchantment_1
			dip_power = 30
			mil_power = 10
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_1 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_2 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_3 }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				personality = ai_militarist
			}
			modifier = {
				factor = 3
				is_at_war = yes
			}
		}
		
		add_dip_power = -30
		add_mil_power = -10
		magic_casted_spell = yes
		if = {
			limit = {
				OR = {
					has_ruler_flag = huli_jing_patron
					has_ruler_flag = gumiho_patron
				}
			}
			custom_tooltip = magic_booster_by_patron_tt
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_inspire_military_1
				duration = 3650
			}
		}
		else = {
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_inspire_military_1
				duration = 1825
			}
		}
		custom_tooltip = magic_charm_military_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.4.ddm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
			NOT = { has_ruler_flag = enchantment_1 }
		}
		custom_tooltip = school_mastery_not_talented_tt
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_inspire_military_1
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_inspire_military_1
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_military_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.4.ddx
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
			has_ruler_flag = enchantment_1
			OR = {
				NOT = { dip_power = 30 }
				NOT = { mil_power = 10 }
				has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_1
				has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_2
				has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_3
			}
		}
		if = { limit = { NOT = { dip_power = 30 } }
			custom_tooltip = magic_need_30_dip_tt
		}
		if = { limit = { NOT = { mil_power = 10 } }
			custom_tooltip = magic_need_10_mil_tt
		}
		if = {
			limit = {
				OR = {
					has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_1
					has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_2
					has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_3
				}
			}
			custom_tooltip = magic_spell_already_active_tt
		}
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_inspire_military_1
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_inspire_military_1
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_military_desc_tt
	}
	
	#1 - Charm I - Subjects
	option = {	#available
		name = magic_realm.4.e
		trigger = {
			has_ruler_flag = enchantment_1
			dip_power = 30
			mil_power = 10
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_1 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_2 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_3 }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { num_of_subjects = 1 }
			}
			modifier = {
				factor = 5
				any_subject_country = { 
					liberty_desire = 50
				}
			}
		}
		
		add_dip_power = -30
		add_mil_power = -10
		magic_casted_spell = yes
		if = {
			limit = {
				OR = {
					has_ruler_flag = huli_jing_patron
					has_ruler_flag = gumiho_patron
				}
			}
			custom_tooltip = magic_booster_by_patron_tt
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_assuage_subjects_1
				duration = 3650
			}
		}
		else = {
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_assuage_subjects_1
				duration = 1825
			}
		}
		custom_tooltip = magic_charm_subject_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.4.em
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
			NOT = { has_ruler_flag = enchantment_1 }
		}
		custom_tooltip = school_mastery_not_talented_tt
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_assuage_subjects_1
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_assuage_subjects_1
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_subject_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.4.ex
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
			has_ruler_flag = enchantment_1
			OR = {
				NOT = { dip_power = 30 }
				NOT = { mil_power = 10 }
				has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_1
				has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_2
				has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_3
			}
		}
		if = { limit = { NOT = { dip_power = 30 } }
			custom_tooltip = magic_need_30_dip_tt
		}
		if = { limit = { NOT = { mil_power = 10 } }
			custom_tooltip = magic_need_10_mil_tt
		}
		if = {
			limit = {
				OR = {
					has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_1
					has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_2
					has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_3
				}
			}
			custom_tooltip = magic_spell_already_active_tt
		}
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_assuage_subjects_1
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_assuage_subjects_1
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_subject_desc_tt
	}
	
	#2 - Charm II - Estates
	option = {	#available
		name = magic_realm.4.f
		trigger = {
			has_ruler_flag = enchantment_2
			dip_power = 30
			mil_power = 10
			NOT = { has_ruler_flag = enchantment_3 }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				OR = {
					NOT = { estate_loyalty = { estate = estate_church loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_nobles loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_burghers loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_nomadic_tribes loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_mages loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_adventurers loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_artificers loyalty = 30 } }
				}
			}
		}
		
		add_dip_power = -30
		add_mil_power = -10
		magic_casted_spell = yes
		if = {
			limit = {
				OR = {
					has_ruler_flag = huli_jing_patron
					has_ruler_flag = gumiho_patron
				}
			}
			custom_tooltip = magic_booster_by_patron_tt
			add_estate_loyalty_modifier = {
				estate = all
				desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_2
				loyalty = 12
				duration = 3650
			}
		}
		else = {
			add_estate_loyalty_modifier = {
				estate = all
				desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_2
				loyalty = 6
				duration = 3650
			}
		}
		custom_tooltip = magic_charm_estates_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.4.fm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
		}
		custom_tooltip = school_mastery_not_renowned_tt
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_estate_loyalty_modifier = {
					estate = all
					desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_2
					loyalty = 12
					duration = 3650
				}
			}
			else = {
				add_estate_loyalty_modifier = {
					estate = all
					desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_2
					loyalty = 6
					duration = 3650
				}
			}
		}
		custom_tooltip = magic_charm_estates_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.4.fx
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_3 }
			has_ruler_flag = enchantment_2
			OR = {
				NOT = { dip_power = 30 }
				NOT = { mil_power = 10 }
			}
		}
		if = { limit = { NOT = { dip_power = 30 } }
			custom_tooltip = magic_need_30_dip_tt
		}
		if = { limit = { NOT = { mil_power = 10 } }
			custom_tooltip = magic_need_10_mil_tt
		}
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_estate_loyalty_modifier = {
					estate = all
					desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_2
					loyalty = 12
					duration = 3650
				}
			}
			else = {
				add_estate_loyalty_modifier = {
					estate = all
					desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_2
					loyalty = 6
					duration = 3650
				}
			}
		}
		custom_tooltip = magic_charm_estates_desc_tt
	}
	
	#2 - Charm II - Diplomats
	option = {	#available
		name = magic_realm.4.g
		trigger = {
			has_ruler_flag = enchantment_2
			dip_power = 30
			mil_power = 10
			NOT = { has_ruler_flag = enchantment_3 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_1 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_2 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_3 }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				personality = ai_diplomat
			}
		}
		
		add_dip_power = -30
		add_mil_power = -10
		magic_casted_spell = yes
		if = {
			limit = {
				OR = {
					has_ruler_flag = huli_jing_patron
					has_ruler_flag = gumiho_patron
				}
			}
			custom_tooltip = magic_booster_by_patron_tt
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_impress_foreign_diplomats_2
				duration = 3650
			}
		}
		else = {
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_impress_foreign_diplomats_2
				duration = 1825
			}
		}
		custom_tooltip = magic_charm_diplomats_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.4.gm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
		}
		custom_tooltip = school_mastery_not_renowned_tt
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_impress_foreign_diplomats_2
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_impress_foreign_diplomats_2
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_diplomats_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.4.gx
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_3 }
			has_ruler_flag = enchantment_2
			OR = {
				NOT = { dip_power = 30 }
				NOT = { mil_power = 10 }
				has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_1
				has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_2
				has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_3
			}
		}
		if = { limit = { NOT = { dip_power = 30 } }
			custom_tooltip = magic_need_30_dip_tt
		}
		if = { limit = { NOT = { mil_power = 10 } }
			custom_tooltip = magic_need_10_mil_tt
		}
		if = {
			limit = {
				OR = {
					has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_1
					has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_2
					has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_3
				}
			}
			custom_tooltip = magic_spell_already_active_tt
		}
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_impress_foreign_diplomats_2
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_impress_foreign_diplomats_2
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_diplomats_desc_tt
	}
	
	#2 - Charm II - Military
	option = {	#available
		name = magic_realm.4.h
		trigger = {
			has_ruler_flag = enchantment_2
			dip_power = 30
			mil_power = 10
			NOT = { has_ruler_flag = enchantment_3 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_1 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_2 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_3 }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				personality = ai_militarist
			}
			modifier = {
				factor = 3
				is_at_war = yes
			}
		}
		
		add_dip_power = -30
		add_mil_power = -10
		magic_casted_spell = yes
		if = {
			limit = {
				OR = {
					has_ruler_flag = huli_jing_patron
					has_ruler_flag = gumiho_patron
				}
			}
			custom_tooltip = magic_booster_by_patron_tt
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_inspire_military_2
				duration = 3650
			}
		}
		else = {
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_inspire_military_2
				duration = 1825
			}
		}
		custom_tooltip = magic_charm_military_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.4.hm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
		}
		custom_tooltip = school_mastery_not_renowned_tt
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_inspire_military_2
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_inspire_military_2
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_military_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.4.hx
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_3 }
			has_ruler_flag = enchantment_2
			OR = {
				NOT = { dip_power = 30 }
				NOT = { mil_power = 10 }
				has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_1
				has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_2
				has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_3
			}
		}
		if = { limit = { NOT = { dip_power = 30 } }
			custom_tooltip = magic_need_30_dip_tt
		}
		if = { limit = { NOT = { mil_power = 10 } }
			custom_tooltip = magic_need_10_mil_tt
		}
		if = {
			limit = {
				OR = {
					has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_1
					has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_2
					has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_3
				}
			}
			custom_tooltip = magic_spell_already_active_tt
		}
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_inspire_military_2
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_inspire_military_2
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_military_desc_tt
	}
	
	#2 - Charm II - Subjects
	option = {	#available
		name = magic_realm.4.i
		trigger = {
			has_ruler_flag = enchantment_2
			dip_power = 30
			mil_power = 10
			NOT = { has_ruler_flag = enchantment_3 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_1 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_2 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_3 }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { num_of_subjects = 1 }
			}
			modifier = {
				factor = 5
				any_subject_country = { 
					liberty_desire = 50
				}
			}
		}
		
		add_dip_power = -30
		add_mil_power = -10
		magic_casted_spell = yes
		if = {
			limit = {
				OR = {
					has_ruler_flag = huli_jing_patron
					has_ruler_flag = gumiho_patron
				}
			}
			custom_tooltip = magic_booster_by_patron_tt
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_assuage_subjects_2
				duration = 3650
			}
		}
		else = {
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_assuage_subjects_2
				duration = 1825
			}
		}
		custom_tooltip = magic_charm_subject_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.4.im
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_2 }
			NOT = { has_ruler_flag = enchantment_3 }
		}
		custom_tooltip = school_mastery_not_renowned_tt
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_assuage_subjects_2
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_assuage_subjects_2
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_subject_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.4.ix
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_3 }
			has_ruler_flag = enchantment_2
			OR = {
				NOT = { dip_power = 30 }
				NOT = { mil_power = 10 }
				has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_1
				has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_2
				has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_3
			}
		}
		if = { limit = { NOT = { dip_power = 30 } }
			custom_tooltip = magic_need_30_dip_tt
		}
		if = { limit = { NOT = { mil_power = 10 } }
			custom_tooltip = magic_need_10_mil_tt
		}
		if = {
			limit = {
				OR = {
					has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_1
					has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_2
					has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_3
				}
			}
			custom_tooltip = magic_spell_already_active_tt
		}
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_assuage_subjects_2
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_assuage_subjects_2
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_subject_desc_tt
	}
		
	#2 - Modify Memories - Overlook Blunder
	option = {	#available
		name = magic_realm.4.j
		trigger = {
			has_ruler_flag = enchantment_2
			adm_power = 150
			mil_power = 80
			NOT = { has_ruler_modifier = magic_realm_enchantment_modify_memories_overlook_national_blunders }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				prestige = 1
				NOT = { prestige = 50 }
				
			}
		}
		
		add_adm_power = -150
		add_mil_power = -80
		magic_casted_spell = yes
		add_ruler_modifier = {
			name = magic_realm_enchantment_modify_memories_overlook_national_blunders
			duration = 1825
		}
		custom_tooltip = magic_memories_blunder_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.4.jm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_2 }
		}
		custom_tooltip = school_mastery_not_renowned_tt
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -150
			add_mil_power = -80
			add_ruler_modifier = {
				name = magic_realm_enchantment_modify_memories_overlook_national_blunders
				duration = 1825
			}
		}
		custom_tooltip = magic_memories_blunder_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.4.jx
		trigger = {
			ai = no
			has_ruler_flag = enchantment_2
			OR = {
				NOT = { adm_power = 150 }
				NOT = { mil_power = 80 }
				has_ruler_modifier = magic_realm_enchantment_modify_memories_overlook_national_blunders
			}
		}
		if = { limit = { NOT = { adm_power = 150 } }
			custom_tooltip = magic_need_150_adm_tt
		}
		if = { limit = { NOT = { mil_power = 80 } }
			custom_tooltip = magic_need_80_mil_tt
		}
		if = { limit = { has_ruler_modifier = magic_realm_enchantment_modify_memories_overlook_national_blunders }
			custom_tooltip = magic_spell_already_active_tt
		}
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -150
			add_mil_power = -80
			add_ruler_modifier = {
				name = magic_realm_enchantment_modify_memories_overlook_national_blunders
				duration = 1825
			}
		}
		custom_tooltip = magic_memories_blunder_desc_tt
	}
		
	#2 - Modify Memories - Subservience
	option = {	#available
		name = magic_realm.4.k
		trigger = {
			has_ruler_flag = enchantment_2
			adm_power = 150
			mil_power = 80
			NOT = { has_ruler_modifier = magic_realm_enchantment_modify_memories_encourage_subservience }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				prestige = 1
				NOT = { prestige = 50 }
				
			}
		}
		
		add_adm_power = -150
		add_mil_power = -80
		magic_casted_spell = yes
		add_ruler_modifier = {
			name = magic_realm_enchantment_modify_memories_encourage_subservience
			duration = 1825
		}
		custom_tooltip = magic_memories_subservience_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.4.km
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_2 }
		}
		custom_tooltip = school_mastery_not_renowned_tt
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -150
			add_mil_power = -80
			add_ruler_modifier = {
				name = magic_realm_enchantment_modify_memories_encourage_subservience
				duration = 1825
			}
		}
		custom_tooltip = magic_memories_subservience_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.4.kx
		trigger = {
			ai = no
			has_ruler_flag = enchantment_2
			OR = {
				NOT = { adm_power = 150 }
				NOT = { mil_power = 80 }
				has_ruler_modifier = magic_realm_enchantment_modify_memories_encourage_subservience
			}
		}
		if = { limit = { NOT = { adm_power = 150 } }
			custom_tooltip = magic_need_150_adm_tt
		}
		if = { limit = { NOT = { mil_power = 80 } }
			custom_tooltip = magic_need_80_mil_tt
		}
		if = { limit = { has_ruler_modifier = magic_realm_enchantment_modify_memories_encourage_subservience }
			custom_tooltip = magic_spell_already_active_tt
		}
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -150
			add_mil_power = -80
			add_ruler_modifier = {
				name = magic_realm_enchantment_modify_memories_encourage_subservience
				duration = 1825
			}
		}
		custom_tooltip = magic_memories_subservience_desc_tt
	}
		
	#2 - Modify Memories - Atrocities
	option = {	#available
		name = magic_realm.4.l
		trigger = {
			has_ruler_flag = enchantment_2
			adm_power = 150
			mil_power = 80
			NOT = { has_ruler_modifier = magic_realm_enchantment_modify_memories_forget_atrocities }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				prestige = 1
				NOT = { prestige = 50 }
				
			}
		}
		
		add_adm_power = -150
		add_mil_power = -80
		magic_casted_spell = yes
		add_ruler_modifier = {
			name = magic_realm_enchantment_modify_memories_forget_atrocities
			duration = 1825
		}
		custom_tooltip = magic_memories_atrocities_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.4.lm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_2 }
		}
		custom_tooltip = school_mastery_not_renowned_tt
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -150
			add_mil_power = -80
			add_ruler_modifier = {
				name = magic_realm_enchantment_modify_memories_forget_atrocities
				duration = 1825
			}
		}
		custom_tooltip = magic_memories_atrocities_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.4.lx
		trigger = {
			ai = no
			has_ruler_flag = enchantment_2
			OR = {
				NOT = { adm_power = 150 }
				NOT = { mil_power = 80 }
				has_ruler_modifier = magic_realm_enchantment_modify_memories_forget_atrocities
			}
		}
		if = { limit = { NOT = { adm_power = 150 } }
			custom_tooltip = magic_need_150_adm_tt
		}
		if = { limit = { NOT = { mil_power = 80 } }
			custom_tooltip = magic_need_80_mil_tt
		}
		if = { limit = { has_ruler_modifier = magic_realm_enchantment_modify_memories_forget_atrocities }
			custom_tooltip = magic_spell_already_active_tt
		}
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_adm_power = -150
			add_mil_power = -80
			add_ruler_modifier = {
				name = magic_realm_enchantment_modify_memories_forget_atrocities
				duration = 1825
			}
		}
		custom_tooltip = magic_memories_atrocities_desc_tt
	}
	
	#3 - Dominate to Surrender
	option = {
		name = magic_realm.4.m	#available
		trigger = {
			has_ruler_flag = enchantment_3
			is_at_war = yes
			is_lesser_in_union = no
			any_army = {
				location = {
					fort_level = 1
					sieged_by = ROOT
					unit_has_leader = yes
				}
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				OR = {
					NOT = { adm_power = 20 }
					NOT = { dip_power = 20 }
				}
			}
		}
		
		country_event = { id = magic_siege.5 days = 0 }
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_controller = ROOT
		}
		custom_tooltip = magic_dominate_desc_tt
	}
	option = {
		name = magic_realm.4.mm	#unavailable - low mastery
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_3 }
		}
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = school_mastery_not_legendary_tt
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_controller = ROOT
		}
		custom_tooltip = magic_dominate_desc_tt
	}
	option = {
		name = magic_realm.4.mx	#unavailable - other
		trigger = {
			ai = no
			has_ruler_flag = enchantment_3
			OR = {
				is_at_war = no
				is_lesser_in_union = yes
				NOT = {
					any_army = {
						location = {
							fort_level = 1
							sieged_by = ROOT
							unit_has_leader = yes
						}
					}
				}
			}
		}
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		if = { limit = { is_at_war = no }
			custom_tooltip = magic_is_at_war_tt
		}
		if = { limit = { is_lesser_in_union = yes }
			custom_tooltip = magic_is_not_in_lesser_union_tt
		}
		if = {
			limit = {
				NOT = {
					any_army = {
						location = {
							fort_level = 1
							sieged_by = ROOT
							unit_has_leader = yes
						}
					}
				}
			}
			custom_tooltip = magic_leadered_army_sieging_tt
		}
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_controller = ROOT
		}
		custom_tooltip = magic_dominate_desc_tt
	}
	
	#3 - Charm III - Estates
	option = {	#available
		name = magic_realm.4.n
		trigger = {
			has_ruler_flag = enchantment_3
			dip_power = 30
			mil_power = 10
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				OR = {
					NOT = { estate_loyalty = { estate = estate_church loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_nobles loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_burghers loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_nomadic_tribes loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_mages loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_adventurers loyalty = 30 } }
					NOT = { estate_loyalty = { estate = estate_artificers loyalty = 30 } }
				}
			}
		}
		
		add_dip_power = -30
		add_mil_power = -10
		magic_casted_spell = yes
		if = {
			limit = {
				OR = {
					has_ruler_flag = huli_jing_patron
					has_ruler_flag = gumiho_patron
				}
			}
			custom_tooltip = magic_booster_by_patron_tt
			add_estate_loyalty_modifier = {
				estate = all
				desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_3
				loyalty = 20
				duration = 3650
			}
		}
		else = {
			add_estate_loyalty_modifier = {
				estate = all
				desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_3
				loyalty = 10
				duration = 3650
			}
		}
		custom_tooltip = magic_charm_estates_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.4.nm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_3 }
		}
		custom_tooltip = school_mastery_not_legendary_tt
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_estate_loyalty_modifier = {
					estate = all
					desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_3
					loyalty = 20
					duration = 3650
				}
			}
			else = {
				add_estate_loyalty_modifier = {
					estate = all
					desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_3
					loyalty = 10
					duration = 3650
				}
			}
		}
		custom_tooltip = magic_charm_estates_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.4.nx
		trigger = {
			ai = no
			has_ruler_flag = enchantment_3
			OR = {
				NOT = { dip_power = 30 }
				NOT = { mil_power = 10 }
			}
		}
		if = { limit = { NOT = { dip_power = 30 } }
			custom_tooltip = magic_need_30_dip_tt
		}
		if = { limit = { NOT = { mil_power = 10 } }
			custom_tooltip = magic_need_10_mil_tt
		}
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_estate_loyalty_modifier = {
					estate = all
					desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_3
					loyalty = 20
					duration = 3650
				}
			}
			else = {
				add_estate_loyalty_modifier = {
					estate = all
					desc = EST_VAL_REALM_MAGIC_SWAYING_THE_ESTATES_ENCHANTMENT_3
					loyalty = 10
					duration = 3650
				}
			}
		}
		custom_tooltip = magic_charm_estates_desc_tt
	}
	
	#3 - Charm III - Diplomats
	option = {	#available
		name = magic_realm.4.o
		trigger = {
			has_ruler_flag = enchantment_3
			dip_power = 30
			mil_power = 10
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_1 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_2 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_3 }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				personality = ai_diplomat
			}
		}
		
		add_dip_power = -30
		add_mil_power = -10
		magic_casted_spell = yes
		if = {
			limit = {
				OR = {
					has_ruler_flag = huli_jing_patron
					has_ruler_flag = gumiho_patron
				}
			}
			custom_tooltip = magic_booster_by_patron_tt
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_impress_foreign_diplomats_3
				duration = 3650
			}
		}
		else = {
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_impress_foreign_diplomats_3
				duration = 1825
			}
		}
		custom_tooltip = magic_charm_diplomats_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.4.om
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_3 }
		}
		custom_tooltip = school_mastery_not_legendary_tt
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_impress_foreign_diplomats_3
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_impress_foreign_diplomats_3
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_diplomats_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.4.ox
		trigger = {
			ai = no
			has_ruler_flag = enchantment_3
			OR = {
				NOT = { dip_power = 30 }
				NOT = { mil_power = 10 }
				has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_1
				has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_2
				has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_3
			}
		}
		if = { limit = { NOT = { dip_power = 30 } }
			custom_tooltip = magic_need_30_dip_tt
		}
		if = { limit = { NOT = { mil_power = 10 } }
			custom_tooltip = magic_need_10_mil_tt
		}
		if = {
			limit = {
				OR = {
					has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_1
					has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_2
					has_ruler_modifier = magic_realm_enchantment_charm_impress_foreign_diplomats_3
				}
			}
			custom_tooltip = magic_spell_already_active_tt
		}
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_impress_foreign_diplomats_3
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_impress_foreign_diplomats_3
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_diplomats_desc_tt
	}
	
	#3 - Charm III - Military
	option = {	#available
		name = magic_realm.4.p
		trigger = {
			has_ruler_flag = enchantment_3
			dip_power = 30
			mil_power = 10
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_1 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_2 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_3 }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				personality = ai_militarist
			}
			modifier = {
				factor = 3
				is_at_war = yes
			}
		}
		
		add_dip_power = -30
		add_mil_power = -10
		magic_casted_spell = yes
		if = {
			limit = {
				OR = {
					has_ruler_flag = huli_jing_patron
					has_ruler_flag = gumiho_patron
				}
			}
			custom_tooltip = magic_booster_by_patron_tt
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_inspire_military_3
				duration = 3650
			}
		}
		else = {
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_inspire_military_3
				duration = 1825
			}
		}
		custom_tooltip = magic_charm_military_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.4.om
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_3 }
		}
		custom_tooltip = school_mastery_not_legendary_tt
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_inspire_military_3
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_inspire_military_3
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_military_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.4.ox
		trigger = {
			ai = no
			has_ruler_flag = enchantment_3
			OR = {
				NOT = { dip_power = 30 }
				NOT = { mil_power = 10 }
				has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_1
				has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_2
				has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_3
			}
		}
		if = { limit = { NOT = { dip_power = 30 } }
			custom_tooltip = magic_need_30_dip_tt
		}
		if = { limit = { NOT = { mil_power = 10 } }
			custom_tooltip = magic_need_10_mil_tt
		}
		if = {
			limit = {
				OR = {
					has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_1
					has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_2
					has_ruler_modifier = magic_realm_enchantment_charm_inspire_military_3
				}
			}
			custom_tooltip = magic_spell_already_active_tt
		}
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_inspire_military_3
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_inspire_military_3
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_military_desc_tt
	}
	
	#3 - Charm III - Subjects
	option = {	#available
		name = magic_realm.4.q
		trigger = {
			has_ruler_flag = enchantment_3
			dip_power = 30
			mil_power = 10
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_1 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_2 }
			NOT = { has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_3 }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { num_of_subjects = 1 }
			}
			modifier = {
				factor = 5
				any_subject_country = { 
					liberty_desire = 50
				}
			}
		}
		
		add_dip_power = -30
		add_mil_power = -10
		magic_casted_spell = yes
		if = {
			limit = {
				OR = {
					has_ruler_flag = huli_jing_patron
					has_ruler_flag = gumiho_patron
				}
			}
			custom_tooltip = magic_booster_by_patron_tt
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_assuage_subjects_3
				duration = 3650
			}
		}
		else = {
			add_ruler_modifier = {
				name = magic_realm_enchantment_charm_assuage_subjects_3
				duration = 1825
			}
		}
		custom_tooltip = magic_charm_subject_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.4.qm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_3 }
		}
		custom_tooltip = school_mastery_not_legendary_tt
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_assuage_subjects_3
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_assuage_subjects_3
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_subject_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.4.qx
		trigger = {
			ai = no
			has_ruler_flag = enchantment_3
			OR = {
				NOT = { dip_power = 30 }
				NOT = { mil_power = 10 }
				has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_1
				has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_2
				has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_3
			}
		}
		if = { limit = { NOT = { dip_power = 30 } }
			custom_tooltip = magic_need_30_dip_tt
		}
		if = { limit = { NOT = { mil_power = 10 } }
			custom_tooltip = magic_need_10_mil_tt
		}
		if = {
			limit = {
				OR = {
					has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_1
					has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_2
					has_ruler_modifier = magic_realm_enchantment_charm_assuage_subjects_3
				}
			}
			custom_tooltip = magic_spell_already_active_tt
		}
		
		set_country_flag = enchantment_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_dip_power = -30
			add_mil_power = -10
			if = {
				limit = {
					OR = {
						has_ruler_flag = huli_jing_patron
						has_ruler_flag = gumiho_patron
					}
				}
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_assuage_subjects_3
					duration = 3650
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_enchantment_charm_assuage_subjects_3
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_charm_subject_desc_tt
	}
}

#Evocation - Menu
country_event = {
	id = magic_realm.5
	title = magic_realm.5.t	
	desc = magic_realm.5.d
	picture = EMPTY_eventPicture
	
	is_triggered_only = yes
	
	#Go back
	option = {
		name = magic_realm.1.z
		ai_chance = { factor = 50 }
		if = { limit = { ai = yes }	#makes ai back out of casting completely to prevent spam
			add_ruler_modifier = { 
				name = magic_realm_menu_cooldown
				duration = 1825	#prevents them casting for 5 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			hidden_effect = { country_event = { id = magic_realm.0 } }
		}
	}
	
	#Study
	option = {
		name = magic_realm.1.a	#available
		trigger = {
			NOT = { has_ruler_flag = evocation_3 }
			NOT = { ruler_studying_magic = yes }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.2
				OR = {
					has_ruler_flag = evocation_1
					has_ruler_flag = evocation_2
				}
			}
		}
		country_event = { id = magic_study.13 }
	}
	option = {
		name = magic_realm.1.as	#stop
		trigger = {
			ai = no
			has_ruler_flag = ruler_studying_evocation
			NOT = { has_finished_magical_studies = yes }
		}
		magic_study_clear_study_effects = yes
	}
	option = {
		name = magic_realm.1.ax	#unavailable
		trigger = {
			ai = no
			NOT = { has_ruler_flag = ruler_studying_evocation }
			OR = {
				has_ruler_flag = evocation_3
				ruler_studying_magic = yes
				has_finished_magical_studies = yes
			}
		}
		custom_tooltip = cant_study_magic_tt
		if = { limit = { has_ruler_flag = evocation_3 }
			custom_tooltip = school_mastery_at_max_tt
		}
		if = { limit = { ruler_studying_magic = yes }
			custom_tooltip = already_studying_magic_tt
		}
		set_country_flag = evocation_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
	}
	
	#1 - War magic I
	option = {	#available
		name = magic_realm.5.b
		trigger = {
			has_ruler_flag = evocation_1
			mil_power = 50
			NOT = { has_ruler_flag = evocation_2 }
			NOT = { has_ruler_flag = evocation_3 }
			NOT = { has_ruler_modifier = magic_realm_evocation_war_magic_1 }
			NOT = { has_ruler_modifier = magic_realm_evocation_war_magic_2 }
			NOT = { has_ruler_modifier = magic_realm_evocation_war_magic_3 }
		}
		ai_chance = {
			factor = 50
		}
		
		add_mil_power = -50
		magic_casted_spell = yes
		if = { limit = { has_ruler_flag = nature_spirit_patron }
			custom_tooltip = magic_booster_by_patron_tt
			add_ruler_modifier = {
				name = patron_green_war_magic_1
				duration = 1825
			}
		}
		else = {
			add_ruler_modifier = {
				name = magic_realm_evocation_war_magic_1
				duration = 1825
			}
		}
		custom_tooltip = magic_war_magic_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.5.bm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = evocation_1 }
			NOT = { has_ruler_flag = evocation_2 }
			NOT = { has_ruler_flag = evocation_3 }
		}
		custom_tooltip = school_mastery_not_talented_tt
		
		set_country_flag = evocation_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_mil_power = -50
			if = { limit = { has_ruler_flag = nature_spirit_patron }
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = patron_green_war_magic_1
					duration = 1825
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_evocation_war_magic_1
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_war_magic_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.5.bx
		trigger = {
			ai = no
			has_ruler_flag = evocation_1
			NOT = { has_ruler_flag = evocation_2 }
			NOT = { has_ruler_flag = evocation_3 }
			OR = {
				NOT = { mil_power = 50 }
				has_ruler_modifier = magic_realm_evocation_war_magic_1
				has_ruler_modifier = magic_realm_evocation_war_magic_2
				has_ruler_modifier = magic_realm_evocation_war_magic_3
			}
		}
		if = { limit = { NOT = { mil_power = 50 } }
			custom_tooltip = magic_need_50_mil_tt
		}
		if = {
			limit = {
				OR = {
					has_ruler_modifier = magic_realm_evocation_war_magic_1
					has_ruler_modifier = magic_realm_evocation_war_magic_2
					has_ruler_modifier = magic_realm_evocation_war_magic_3
				}
			}
			custom_tooltip = magic_spell_already_active_tt
		}
		
		set_country_flag = evocation_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_mil_power = -50
			if = { limit = { has_ruler_flag = nature_spirit_patron }
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = patron_green_war_magic_1
					duration = 1825
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_evocation_war_magic_1
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_war_magic_desc_tt
	}
	
	#2 - #Earthquake
	option = {
		name = magic_realm.5.c	#available
		trigger = {
			has_ruler_flag = evocation_1
			is_at_war = yes
			is_lesser_in_union = no
			any_army = {
				location = {
					fort_level = 1
					sieged_by = ROOT
					unit_has_leader = yes
				}
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { mil_power = 10 }
			}
		}
		
		country_event = { id = magic_siege.8 days = 0 }
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 1
		}
		custom_tooltip = magic_fireball_desc_tt
	}
	option = {
		name = magic_realm.5.cm	#unavailable - low mastery
		trigger = {
			ai = no
			NOT = { has_ruler_flag = evocation_1 }
		}
		set_country_flag = evocation_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = school_mastery_not_talented_tt
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 1
		}
		custom_tooltip = magic_fireball_desc_tt
	}
	option = {
		name = magic_realm.5.cx	#unavailable - other
		trigger = {
			ai = no
			has_ruler_flag = evocation_1
			OR = {
				is_at_war = no
				is_lesser_in_union = yes
				NOT = {
					any_army = {
						location = {
							fort_level = 1
							sieged_by = ROOT
							unit_has_leader = yes
						}
					}
				}
			}
		}
		set_country_flag = evocation_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		if = { limit = { is_at_war = no }
			custom_tooltip = magic_is_at_war_tt
		}
		if = { limit = { is_lesser_in_union = yes }
			custom_tooltip = magic_is_not_in_lesser_union_tt
		}
		if = {
			limit = {
				NOT = {
					any_army = {
						location = {
							fort_level = 1
							sieged_by = ROOT
							unit_has_leader = yes
						}
					}
				}
			}
			custom_tooltip = magic_leadered_army_sieging_tt
		}
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 1
		}
		custom_tooltip = magic_fireball_desc_tt
	}
	
	#2 - War magic II
	option = {	#available
		name = magic_realm.5.dd
		trigger = {
			has_ruler_flag = evocation_2
			mil_power = 50
			NOT = { has_ruler_flag = evocation_3 }
			NOT = { has_ruler_modifier = magic_realm_evocation_war_magic_1 }
			NOT = { has_ruler_modifier = magic_realm_evocation_war_magic_2 }
			NOT = { has_ruler_modifier = magic_realm_evocation_war_magic_3 }
		}
		ai_chance = {
			factor = 50
		}
		
		add_mil_power = -50
		magic_casted_spell = yes
		if = { limit = { has_ruler_flag = nature_spirit_patron }
			custom_tooltip = magic_booster_by_patron_tt
			add_ruler_modifier = {
				name = patron_green_war_magic_2
				duration = 1825
			}
		}
		else = {
			add_ruler_modifier = {
				name = magic_realm_evocation_war_magic_2
				duration = 1825
			}
		}
		custom_tooltip = magic_war_magic_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.5.ddm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = evocation_2 }
			NOT = { has_ruler_flag = evocation_3 }
		}
		custom_tooltip = school_mastery_not_renowned_tt
		
		set_country_flag = evocation_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_mil_power = -50
			if = { limit = { has_ruler_flag = nature_spirit_patron }
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = patron_green_war_magic_2
					duration = 1825
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_evocation_war_magic_2
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_war_magic_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.5.ddx
		trigger = {
			ai = no
			has_ruler_flag = evocation_2
			NOT = { has_ruler_flag = evocation_3 }
			OR = {
				NOT = { mil_power = 50 }
				has_ruler_modifier = magic_realm_evocation_war_magic_1
				has_ruler_modifier = magic_realm_evocation_war_magic_2
				has_ruler_modifier = magic_realm_evocation_war_magic_3
			}
		}
		if = { limit = { NOT = { mil_power = 50 } }
			custom_tooltip = magic_need_50_mil_tt
		}
		if = {
			limit = {
				OR = {
					has_ruler_modifier = magic_realm_evocation_war_magic_1
					has_ruler_modifier = magic_realm_evocation_war_magic_2
					has_ruler_modifier = magic_realm_evocation_war_magic_3
				}
			}
			custom_tooltip = magic_spell_already_active_tt
		}
		
		set_country_flag = evocation_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_mil_power = -50
			if = { limit = { has_ruler_flag = nature_spirit_patron }
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = patron_green_war_magic_2
					duration = 1825
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_evocation_war_magic_2
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_war_magic_desc_tt
	}
	
	#2 - #Earthquake
	option = {
		name = magic_realm.5.e	#available
		trigger = {
			has_ruler_flag = evocation_2
			is_at_war = yes
			is_lesser_in_union = no
			any_army = {
				location = {
					fort_level = 1
					sieged_by = ROOT
					unit_has_leader = yes
				}
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { adm_power = 20 }
				NOT = { mil_power = 5 }
			}
		}
		
		country_event = { id = magic_siege.11 days = 0 }
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 3
			add_province_modifier = {
				name = siege_magic_earthquake
				duration = 365
			}
			add_devastation = 10
		}
		custom_tooltip = magic_earthquake_desc_tt
	}
	option = {
		name = magic_realm.5.em	#unavailable - low mastery
		trigger = {
			ai = no
			NOT = { has_ruler_flag = evocation_2 }
		}
		set_country_flag = evocation_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = school_mastery_not_renowned_tt
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 3
			add_province_modifier = {
				name = siege_magic_earthquake
				duration = 365
			}
			add_devastation = 10
		}
		custom_tooltip = magic_earthquake_desc_tt
	}
	option = {
		name = magic_realm.5.ex	#unavailable - other
		trigger = {
			ai = no
			has_ruler_flag = evocation_2
			OR = {
				is_at_war = no
				is_lesser_in_union = yes
				NOT = {
					any_army = {
						location = {
							fort_level = 1
							sieged_by = ROOT
							unit_has_leader = yes
						}
					}
				}
			}
		}
		set_country_flag = evocation_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		if = { limit = { is_at_war = no }
			custom_tooltip = magic_is_at_war_tt
		}
		if = { limit = { is_lesser_in_union = yes }
			custom_tooltip = magic_is_not_in_lesser_union_tt
		}
		if = {
			limit = {
				NOT = {
					any_army = {
						location = {
							fort_level = 1
							sieged_by = ROOT
							unit_has_leader = yes
						}
					}
				}
			}
			custom_tooltip = magic_leadered_army_sieging_tt
		}
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 3
			add_province_modifier = {
				name = siege_magic_earthquake
				duration = 365
			}
			add_devastation = 10
		}
		custom_tooltip = magic_earthquake_desc_tt
	}
	
	#3 - War magic III
	option = {	#available
		name = magic_realm.5.f
		trigger = {
			has_ruler_flag = evocation_3
			mil_power = 50
			NOT = { has_ruler_modifier = magic_realm_evocation_war_magic_1 }
			NOT = { has_ruler_modifier = magic_realm_evocation_war_magic_2 }
			NOT = { has_ruler_modifier = magic_realm_evocation_war_magic_3 }
		}
		ai_chance = {
			factor = 50
		}
		
		add_mil_power = -50
		magic_casted_spell = yes
		if = { limit = { has_ruler_flag = nature_spirit_patron }
			custom_tooltip = magic_booster_by_patron_tt
			add_ruler_modifier = {
				name = patron_green_war_magic_3
				duration = 1825
			}
		}
		else = {
			add_ruler_modifier = {
				name = magic_realm_evocation_war_magic_3
				duration = 1825
			}
		}
		custom_tooltip = magic_war_magic_desc_tt
	}
	option = {	#unavailable - low mastery
		name = magic_realm.5.fm
		trigger = {
			ai = no
			NOT = { has_ruler_flag = evocation_3 }
		}
		custom_tooltip = school_mastery_not_legendary_tt
		
		set_country_flag = evocation_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_mil_power = -50
			if = { limit = { has_ruler_flag = nature_spirit_patron }
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = patron_green_war_magic_3
					duration = 1825
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_evocation_war_magic_3
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_war_magic_desc_tt
	}
	option = {	#unavailable - other
		name = magic_realm.5.fx
		trigger = {
			ai = no
			has_ruler_flag = evocation_3
			OR = {
				NOT = { mil_power = 50 }
				has_ruler_modifier = magic_realm_evocation_war_magic_1
				has_ruler_modifier = magic_realm_evocation_war_magic_2
				has_ruler_modifier = magic_realm_evocation_war_magic_3
			}
		}
		if = { limit = { NOT = { mil_power = 50 } }
			custom_tooltip = magic_need_50_mil_tt
		}
		if = {
			limit = {
				OR = {
					has_ruler_modifier = magic_realm_evocation_war_magic_1
					has_ruler_modifier = magic_realm_evocation_war_magic_2
					has_ruler_modifier = magic_realm_evocation_war_magic_3
				}
			}
			custom_tooltip = magic_spell_already_active_tt
		}
		
		set_country_flag = evocation_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_mil_power = -50
			if = { limit = { has_ruler_flag = nature_spirit_patron }
				custom_tooltip = magic_booster_by_patron_tt
				add_ruler_modifier = {
					name = patron_green_war_magic_3
					duration = 1825
				}
			}
			else = {
				add_ruler_modifier = {
					name = magic_realm_evocation_war_magic_3
					duration = 1825
				}
			}
		}
		custom_tooltip = magic_war_magic_desc_tt
	}
	
	#3 - #Meteor Strike
	option = {
		name = magic_realm.5.g	#available
		trigger = {
			has_ruler_flag = evocation_3
			is_at_war = yes
			is_lesser_in_union = no
			any_army = {
				location = {
					fort_level = 1
					sieged_by = ROOT
					unit_has_leader = yes
				}
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { mil_power = 50 }
			}
		}
		
		country_event = { id = magic_siege.14 days = 0 }
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 10
			add_devastation = 50
		}
		custom_tooltip = magic_meteor_desc_tt
	}
	option = {
		name = magic_realm.5.gm	#unavailable - low mastery
		trigger = {
			ai = no
			NOT = { has_ruler_flag = evocation_3 }
		}
		set_country_flag = evocation_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		custom_tooltip = school_mastery_not_legendary_tt
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 10
			add_devastation = 50
		}
		custom_tooltip = magic_meteor_desc_tt
	}
	option = {
		name = magic_realm.5.gx	#unavailable - other
		trigger = {
			ai = no
			has_ruler_flag = evocation_3
			OR = {
				is_at_war = no
				is_lesser_in_union = yes
				NOT = {
					any_army = {
						location = {
							fort_level = 1
							sieged_by = ROOT
							unit_has_leader = yes
						}
					}
				}
			}
		}
		set_country_flag = evocation_menu
		hidden_effect = { country_event = { id = magic_realm.9 } }
		
		if = { limit = { is_at_war = no }
			custom_tooltip = magic_is_at_war_tt
		}
		if = { limit = { is_lesser_in_union = yes }
			custom_tooltip = magic_is_not_in_lesser_union_tt
		}
		if = {
			limit = {
				NOT = {
					any_army = {
						location = {
							fort_level = 1
							sieged_by = ROOT
							unit_has_leader = yes
						}
					}
				}
			}
			custom_tooltip = magic_leadered_army_sieging_tt
		}
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 10
			add_devastation = 50
		}
		custom_tooltip = magic_meteor_desc_tt
	}
}

#Illusion - Menu
country_event = {
	id = magic_realm.6
	title = magic_realm.6.t	
	desc = magic_realm.6.d
	picture = EMPTY_eventPicture
	
	is_triggered_only = yes
	
	#Go back
	option = {
		name = magic_realm.1.z
		ai_chance = { factor = 50 }
		if = { limit = { ai = yes }	#makes ai back out of casting completely to prevent spam
			add_ruler_modifier = { 
				name = magic_realm_menu_cooldown
				duration = 1825	#prevents them casting for 5 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			hidden_effect = { country_event = { id = magic_realm.0 } }
		}
	}
}

#Necromancy - Menu
country_event = {
	id = magic_realm.7
	title = magic_realm.7.t	
	desc = magic_realm.7.d
	picture = EMPTY_eventPicture
	
	is_triggered_only = yes
	
	#Go back
	option = {
		name = magic_realm.1.z
		ai_chance = { factor = 50 }
		if = { limit = { ai = yes }	#makes ai back out of casting completely to prevent spam
			add_ruler_modifier = { 
				name = magic_realm_menu_cooldown
				duration = 1825	#prevents them casting for 5 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			hidden_effect = { country_event = { id = magic_realm.0 } }
		}
	}
}

#Transmutation - Menu
country_event = {
	id = magic_realm.8
	title = magic_realm.8.t	
	desc = magic_realm.8.d
	picture = EMPTY_eventPicture
	
	is_triggered_only = yes
	
	#Go back
	option = {
		name = magic_realm.1.z
		ai_chance = { factor = 50 }
		if = { limit = { ai = yes }	#makes ai back out of casting completely to prevent spam
			add_ruler_modifier = { 
				name = magic_realm_menu_cooldown
				duration = 1825	#prevents them casting for 5 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			hidden_effect = { country_event = { id = magic_realm.0 } }
		}
	}
}

#
country_event = {
	id = magic_realm.9
	title = magic_realm.9.t
	desc = magic_realm.9.d
	picture = EMPTY_eventPicture
	
	is_triggered_only = yes
	hidden = yes
	
	option = {
		name = magic_realm.9.a
		trigger_switch = {
			on_trigger = has_country_flag
			abjuration_menu = { country_event = { id = magic_realm.1 } clr_country_flag = abjuration_menu }
			conjuration_menu = { country_event = { id = magic_realm.2 } clr_country_flag = conjuration_menu }
			divination_menu = { country_event = { id = magic_realm.3 } clr_country_flag = divination_menu }
			enchantment_menu = { country_event = { id = magic_realm.4 } clr_country_flag = enchantment_menu }
			evocation_menu = { country_event = { id = magic_realm.5 } clr_country_flag = evocation_menu }
			illusion_menu = { country_event = { id = magic_realm.6 } clr_country_flag = illusion_menu }
			necromancy_menu = { country_event = { id = magic_realm.7 } clr_country_flag = necromancy_menu }
			transmutation_menu = { country_event = { id = magic_realm.8 } clr_country_flag = transmutation_menu }
		}
	}
}


#-----# Abjuration Spells #-----#

#Ward
country_event = {
	id = magic_realm.10
	title = magic_realm.10.t
	desc = magic_realm_abjuration.1.d
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			 random_owned_province = {
				limit = {
					has_no_ward_province_modifiers = yes
					is_city = yes
				 }
				 save_event_target_as = ward_province_1
			 }
			 random_owned_province = {	#random province
				 limit = {
					 has_no_ward_province_modifiers = yes
					 is_city = yes
					 is_in_capital_area = yes
				 }
				 save_event_target_as = ward_province_1
			 }
			 random_owned_province = {
				 limit = {
					 has_no_ward_province_modifiers = yes
					 is_city = yes
				 }
				 save_event_target_as = ward_province_2
			 }
			 random_owned_province = {	#province with fort
				 limit = {
					 has_no_ward_province_modifiers = yes
					 is_city = yes
					 fort_level = 3
				 }
				 save_event_target_as = ward_province_2
			 }
			 random_owned_province = {
				 limit = {
					 has_no_ward_province_modifiers = yes
					 is_city = yes
				 }
				 save_event_target_as = ward_province_3
			 }
			 random_owned_province = {	#high dev
				 limit = {
					 has_no_ward_province_modifiers = yes
					 is_city = yes
					 development = 12
				 }
				 save_event_target_as = ward_province_3
			 }
			 random_owned_province = {
				 limit = {
					 has_no_ward_province_modifiers = yes
					 is_city = yes
				 }
				 save_event_target_as = ward_province_4
			 }
			 random_owned_province = {	#ruler general location
				 limit = {
					 has_no_ward_province_modifiers = yes
					 is_city = yes
					 has_ruler_leader_from = ROOT
				 }
				 save_event_target_as = ward_province_4
			 }
		}
	}
	
	option = {	# Create Wards on
		name = magic_realm_abjuration.1.a
		ai_chance = { factor = 50 }
		goto = ward_province_1
		
		if = { limit = { has_ruler_flag = abjuration_2 }
			event_target:ward_province_1 = {
				add_province_modifier = {
					name = magic_realm_abjuration_empowered_ward
					duration = 9131
				}
			}
		}
		else = {
			event_target:ward_province_1 = {
				add_province_modifier = {
					name = magic_realm_abjuration_ward
					duration = 9131
				}
			}
		}
	}
	
	option = {	# Create Wards on
		name = magic_realm_abjuration.1.b
		ai_chance = { factor = 50 }
		goto = ward_province_2
		
		if = { limit = { has_ruler_flag = abjuration_2 }
			event_target:ward_province_2 = {
				add_province_modifier = {
					name = magic_realm_abjuration_empowered_ward
					duration = 9131
				}
			}
		}
		else = {
			event_target:ward_province_2 = {
				add_province_modifier = {
					name = magic_realm_abjuration_ward
					duration = 9131
				}
			}
		}
	}
	
	option = {	# Create Wards on
		name = magic_realm_abjuration.1.c
		ai_chance = { factor = 50 }
		goto = ward_province_3
		
		if = { limit = { has_ruler_flag = abjuration_2 }
			event_target:ward_province_3 = {
				add_province_modifier = {
					name = magic_realm_abjuration_empowered_ward
					duration = 9131
				}
			}
		}
		else = {
			event_target:ward_province_3 = {
				add_province_modifier = {
					name = magic_realm_abjuration_ward
					duration = 9131
				}
			}
		}
	}
	
	option = {	# Create Wards on
		name = magic_realm_abjuration.1.e
		ai_chance = { factor = 50 }
		goto = ward_province_4
		
		if = { limit = { has_ruler_flag = abjuration_2 }
			event_target:ward_province_4 = {
				add_province_modifier = {
					name = magic_realm_abjuration_empowered_ward
					duration = 9131
				}
			}
		}
		else = {
			event_target:ward_province_4 = {
				add_province_modifier = {
					name = magic_realm_abjuration_ward
					duration = 9131
				}
			}
		}
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 5
		}
		add_adm_power = 30
		add_dip_power = 5
		if = {
			limit = {
				ai = yes	#makes ai back out of casting completely to prevent spam
			}
			add_ruler_modifier = { 
				name = magic_realm_menu_cooldown
				duration = 1825	#prevents them casting for 5 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			hidden_effect = { country_event = { id = magic_realm.1 } }
		}
	}	
}

#Host Magical Feast
country_event = {
	id = magic_realm.11
	title = magic_realm.11.t
	desc = magic_realm_conjuration.1.d
	picture = KING_DOING_GREAT_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			random_ally = {
				save_event_target_as = magic_ally_1
			}
			if = {
				limit = { num_of_allies = 2 }
				random_ally = {
					save_event_target_as = magic_ally_2
				}
			}
			if = {
				limit = { num_of_allies = 3 }
				random_ally = {
					save_event_target_as = magic_ally_3
				}
			}
			if = {
				limit = { num_of_allies = 4 }
				random_ally = {
					save_event_target_as = magic_ally_4
				}
			}
		}
	}
	
	option = {	#Ally 1
		name = magic_realm_conjuration.1.a
		trigger = {
			has_ruler_flag = conjuration_1
		}
		ai_chance = {
			factor = 50
		}
		goto = magic_ally_1
		
		if = {
			limit = { has_ruler_flag = conjuration_2 }
			event_target:magic_ally_1 = {
				add_opinion = {
					who = ROOT
					modifier = opinion_magical_feast_greater
					years = 5
				}
			}
		}
		else = {
			event_target:magic_ally_1 = {
				add_opinion = {
					who = ROOT
					modifier = opinion_magical_feast
					years = 5
				}
			}
		}
	}

	option = {	#Ally 2
		name = magic_realm_conjuration.1.b
		trigger = {
			num_of_allies = 2
		}
		ai_chance = {
			factor = 50
		}
		goto = magic_ally_2
		
		if = {
			limit = { has_ruler_flag = conjuration_2 }
			event_target:magic_ally_2 = {
				add_opinion = {
					who = ROOT
					modifier = opinion_magical_feast_greater
					years = 5
				}
			}
		}
		else = {
			event_target:magic_ally_2 = {
				add_opinion = {
					who = ROOT
					modifier = opinion_magical_feast
					years = 5
				}
			}
		}
	}

	option = {	#Ally 3
		name = magic_realm_conjuration.1.c
		trigger = {
			num_of_allies = 3
		}
		ai_chance = {
			factor = 50
		}
		goto = magic_ally_3
		
		if = {
			limit = { has_ruler_flag = conjuration_2 }
			event_target:magic_ally_3 = {
				add_opinion = {
					who = ROOT
					modifier = opinion_magical_feast_greater
					years = 5
				}
			}
		}
		else = {
			event_target:magic_ally_3 = {
				add_opinion = {
					who = ROOT
					modifier = opinion_magical_feast
					years = 5
				}
			}
		}
	}

	option = {	#Ally 4
		name = magic_realm_conjuration.1.e
		trigger = {
			num_of_allies = 4
		}
		ai_chance = {
			factor = 50
		}
		goto = magic_ally_4
		
		if = {
			limit = { has_ruler_flag = conjuration_2 }
			event_target:magic_ally_4 = {
				add_opinion = {
					who = ROOT
					modifier = opinion_magical_feast_greater
					years = 5
				}
			}
		}
		else = {
			event_target:magic_ally_4 = {
				add_opinion = {
					who = ROOT
					modifier = opinion_magical_feast
					years = 5
				}
			}
		}
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 5
		}
		add_dip_power = 15
		if = {
			limit = {
				ai = yes	#makes ai back out of casting completely to prevent spam
			}
			add_ruler_modifier = { 
				name = magic_realm_menu_cooldown
				duration = 1825	#prevents them casting for 5 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			hidden_effect = { country_event = { id = magic_realm.1 } }
		}
	}
}

#Conjure Magical Fortress
country_event = {
	id = magic_realm.12
	title = magic_realm.12.t
	desc = magic_realm.12.d
	picture = KING_DOING_GREAT_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			 random_owned_province = {
				 limit = {
					 NOT = { has_building = fort_magic }
					 is_core = ROOT
					 is_city = yes
				 }
				 save_event_target_as = fort_magic_province_1
			 }
			 random_owned_province = {	#random province
				 limit = {
					 NOT = { has_building = fort_magic }
					 is_core = ROOT
					 is_city = yes
					 is_in_capital_area = yes
				 }
				 save_event_target_as = fort_magic_province_1
			 }
			 random_owned_province = {
				 limit = {
					 NOT = { has_building = fort_magic }
					 is_core = ROOT
					 is_city = yes
				 }
				 save_event_target_as = fort_magic_province_2
			 }
			 random_owned_province = {	#province with fort
				 limit = {
					 NOT = { has_building = fort_magic }
					 is_core = ROOT
					 is_city = yes
					 fort_level = 3
				 }
				 save_event_target_as = fort_magic_province_2
			 }
			 random_owned_province = {
				 limit = {
					 NOT = { has_building = fort_magic }
					 is_core = ROOT
					 is_city = yes
				 }
				 save_event_target_as = fort_magic_province_3
			 }
			 random_owned_province = {	#high dev
				 limit = {
					 NOT = { has_building = fort_magic }
					 is_core = ROOT
					 is_city = yes
					 development = 12
				 }
				 save_event_target_as = fort_magic_province_3
			 }
		}
	}
	
	#1
	option = {
		name = magic_realm_conjuration.3.a
		ai_chance = {
			factor = 50
		}
		goto = fort_magic_province_1
		
		event_target:fort_magic_province_1 = {
			add_building_construction = {
				building = fort_magic
				speed = 0.5
				cost = 0
			}
		}
	}
	
	#2
	option = {
		name = magic_realm_conjuration.3.b
		ai_chance = {
			factor = 50
		}
		goto = fort_magic_province_2
		
		event_target:fort_magic_province_2 = {
			add_building_construction = {
				building = fort_magic
				speed = 0.5
				cost = 0
			}
		}
	}
	
	#3
	option = {
		name = magic_realm_conjuration.3.c
		ai_chance = {
			factor = 50
		}
		goto = fort_magic_province_3
		
		event_target:fort_magic_province_3 = {
			add_building_construction = {
				building = fort_magic
				speed = 0.5
				cost = 0
			}
		}
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 5
		}
		add_adm_power = 100
		add_dip_power = 100
		add_mil_power = 100
		if = {
			limit = {
				ai = yes	#makes ai back out of casting completely to prevent spam
			}
			add_ruler_modifier = { 
				name = magic_realm_menu_cooldown
				duration = 1825	#prevents them casting for 5 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			hidden_effect = { country_event = { id = magic_realm.1 } }
		}
	}	
}

#Scrying
country_event = {
	id = magic_realm.13
	title = magic_realm.13.t
	desc = magic_realm.13.d
	picture = CITY_VIEW_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = { 
			count_provinces_owned_by_rivals_effect = {
				which = amount_of_rival_provinces
			}
		}
		hidden_effect = { 
			count_provinces_owned_by_neighbours_effect = {
				which = amount_of_neighbour_provinces
			}
		}
		hidden_effect = { 
			count_provinces_owned_by_country_effect = {
				which = amount_of_owned_provinces
			}
		}
		hidden_effect = { 
			count_provinces_owned_by_war_enemies_effect = {
				which = amount_of_war_enemy_provinces
			}
		}
	}
	
	option = {
		name = magic_realm_unavailable.0.a
		trigger = {
			AND = {
				has_ruler_modifier = magic_realm_divination_scrying_internal_dissidents
				has_ruler_modifier = magic_realm_divination_scrying_rivals
				has_ruler_modifier = magic_realm_divination_scrying_neighbours
				has_ruler_modifier = magic_realm_divination_scrying_affairs
			}
		}
		custom_tooltip = tooltip_magic_realm_unavailable_cooldown
		if = {
			limit = {
				ai = yes	#makes ai back out of casting completely to prevent spam
			}
			add_ruler_modifier = { 
				name = magic_realm_menu_cooldown
				duration = 1825	#prevents them casting for 5 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			country_event = { id = magic_realm_divination.0 days = 0 }
		}
	}
	
	option = {	#Spy on our rivals
		name = magic_realm_divination.1.a
		ai_chance = {
			factor = 50
			modifier = {
				factor = 4
				is_great_power = yes
			}
		}
		
		trigger = {
			any_rival_country  = {
				exists = yes
			}
			NOT = { has_ruler_modifier = magic_realm_divination_scrying_rivals }
		}
		#Supernal Scrying for Patrons
		if = {
			limit = { has_ruler_flag = honored_ancestor_patron }
			add_country_modifier = {
				name = magic_realm_divination_scrying_rivals
				duration = 362
			}
		}
		#Normal Scrying
		else = {
			add_country_modifier = {
				name = magic_realm_divination_scrying_rivals
				duration = 182
			}
		}
		every_rival_country = {
			remove_fow = 6
		}
		
		magic_casted_spell = yes

		
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 1 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 5 } }
			}
			
			add_adm_power = -25
			add_dip_power = -25
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 5 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 10 } }
			}
			add_adm_power = -30
			add_dip_power = -30
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 10 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 15 } }
			}
			add_adm_power = -35
			add_dip_power = -35
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 15 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 20 } }
			}
			add_years_of_income = -0.4
			add_adm_power = -40
			add_dip_power = -40
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 20 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 30 } }
			}
			add_years_of_income = -0.5
			add_adm_power = -45	
			add_dip_power = -45
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 30 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 40 } }
			}
			add_years_of_income = -0.6
			add_adm_power = -50
			add_dip_power = -50
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 40 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 50 } }
			}
			add_years_of_income = -0.7
			add_adm_power = -55	
			add_dip_power = -55
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 50 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 60 } }
			}
			add_years_of_income = -0.8
			add_adm_power = -60
			add_dip_power = -60
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 60 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 70 } }
			}
			add_years_of_income = -0.9
			add_adm_power = -65
			add_dip_power = -65
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 70 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 80 } }
			}
			add_years_of_income = -1
			add_adm_power = -70	
			add_dip_power = -70
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 80 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 90 } }
			}
			add_years_of_income = -1.1
			add_adm_power = -75
			add_dip_power = -75
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 90 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 100 } }
			}
			add_years_of_income = -1.2
			add_adm_power = -80
			add_dip_power = -80
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 100 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 200 } }
			}
			
			add_adm_power = -85
			add_dip_power = -85
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 200 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 300 } }
			}
			add_years_of_income = -1.4
			add_adm_power = -90
			add_dip_power = -90
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 200 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 300 } }
			}
			
			add_adm_power = -95
			add_dip_power = -95
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 300 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 400 } }
			}
			add_years_of_income = -1.6
			add_adm_power = -100
			add_dip_power = -100
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 400 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 500 } }
			}
			add_years_of_income = -1.7
			add_adm_power = -105
			add_dip_power = -105
		}
		if = {
			limit = {
				check_variable = { which = amount_of_rival_provinces value = 500 }
				NOT = { check_variable = { which = amount_of_rival_provinces value = 1000 } }
			}
			add_years_of_income = -3
			add_adm_power = -150
			add_dip_power = -150
		}
	}
	
	option = {	#Spy on our neighbours
		name = magic_realm_divination.1.b
		ai_chance = {
			factor = 50
			modifier = {
				factor = 4
				personality = ai_diplomat
			}
		}
		
		#Check to see if the country actually has any neighbours
		trigger = {
			any_country = {
				is_neighbor_of = ROOT
			}
			NOT = { has_ruler_modifier = magic_realm_divination_scrying_neighbours }
		}
		#Supernal Scrying for Patrons
		if = {
			limit = { has_ruler_flag = honored_ancestor_patron }
			add_country_modifier = {
				name = magic_realm_divination_scrying_neighbours
				duration = 362
			}
		}
		#Normal Scrying
		else = {
			add_country_modifier = {
				name = magic_realm_divination_scrying_neighbours
				duration = 182
			}
		}
		every_country = {
			limit = { 
				is_neighbor_of  = ROOT 
			}
			remove_fow = 6
		}
		
		magic_casted_spell = yes

		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 1 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 5 } }
			}
			
			add_adm_power = -50	#adm power is the administrative cost of watching all these scrying balls
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 5 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 10 } }
			}
			add_adm_power = -60	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 10 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 15 } }
			}
			add_adm_power = -70
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 15 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 20 } }
			}
			add_adm_power = -80
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 20 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 30 } }
			}
			add_adm_power = -90	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 30 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 40 } }
			}
			add_adm_power = -100	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 40 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 50 } }
			}
			add_adm_power = -110	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 50 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 60 } }
			}
			add_adm_power = -120
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 60 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 70 } }
			}
			add_adm_power = -130	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 70 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 80 } }
			}
			add_adm_power = -140	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 80 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 90 } }
			}
			add_adm_power = -150
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 90 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 100 } }
			}
			add_adm_power = -160
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 100 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 200 } }
			}
			
			add_adm_power = -170
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 200 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 300 } }
			}
			add_adm_power = -180
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 200 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 300 } }
			}
			
			add_adm_power = -190
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 300 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 400 } }
			}
			add_adm_power = -200
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 400 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 500 } }
			}
			add_adm_power = -210
		}
		if = {
			limit = {
				check_variable = { which = amount_of_neighbour_provinces value = 500 }
				NOT = { check_variable = { which = amount_of_neighbour_provinces value = 1000 } }
			}
			add_adm_power = -300
		}
	}
	
	option = {	#Scry on internal dissidents
		name = magic_realm_divination.1.c
		trigger = {
			NOT = { has_ruler_modifier = magic_realm_divination_scrying_internal_dissidents }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 4
				average_unrest = 5
			}
			modifier = {
				factor = 4
				NOT = { stability = 1 }
			}
			modifier = {
				factor = 8
				any_subject_country = {
					liberty_desire = 50
				}
			}
		}
		#Supernal Scrying for Patrons
		if = {
			limit = { has_ruler_flag = honored_ancestor_patron }
			add_country_modifier = {
				name = magic_realm_divination_scrying_internal_dissidents
				duration = 2192
			}
		}
		#Normal Scrying
		else = {
			add_country_modifier = {
				name = magic_realm_divination_scrying_internal_dissidents
				duration = 1096
			}
		}
		
		magic_casted_spell = yes
		
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 1 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 5 } }
			}
			
			add_adm_power = -50	#adm power is the administrative cost of watching all these scrying balls
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 5 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 10 } }
			}
			add_adm_power = -60	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 10 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 15 } }
			}
			add_adm_power = -70
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 15 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 20 } }
			}
			add_adm_power = -80
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 20 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 30 } }
			}
			add_adm_power = -90	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 30 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 40 } }
			}
			add_adm_power = -100	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 40 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 50 } }
			}
			add_adm_power = -110	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 50 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 60 } }
			}
			add_adm_power = -120
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 60 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 70 } }
			}
			add_adm_power = -130	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 70 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 80 } }
			}
			add_adm_power = -140	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 80 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 90 } }
			}
			add_adm_power = -150
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 90 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 100 } }
			}
			add_adm_power = -160
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 100 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 200 } }
			}
			add_adm_power = -170
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 200 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 300 } }
			}
			add_adm_power = -180
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 200 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 300 } }
			}
			add_adm_power = -190
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 300 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 400 } }
			}
			add_adm_power = -200
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 400 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 500 } }
			}
			add_adm_power = -210
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 500 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 1000 } }
			}
			add_adm_power = -300
		}
	}
	
	option = {	#Scry the affairs of the realm
		name = magic_realm_divination.1.dd
		trigger = {
			NOT = { has_ruler_modifier = magic_realm_divination_scrying_affairs }
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 8
				OR = {
					adm_power = 200
					dip_power = 200
					mil_power = 200
				}
			}
		}
		
		magic_casted_spell = yes
		#Supernal Scrying for Patrons
		if = {
			limit = { has_ruler_flag = honored_ancestor_patron }
			add_country_modifier = {
				name = magic_realm_divination_scrying_affairs
				duration = 2192
			}
		}
		#Normal Scrying
		else = {
			add_country_modifier = {
				name = magic_realm_divination_scrying_affairs
				duration = 1096
			}
		}
	
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 1 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 5 } }
			}
			
			add_adm_power = -50	#adm power is the administrative cost of watching all these scrying balls
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 5 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 10 } }
			}
			add_adm_power = -60	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 10 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 15 } }
			}
			add_adm_power = -70
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 15 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 20 } }
			}
			add_adm_power = -80
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 20 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 30 } }
			}
			add_adm_power = -90	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 30 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 40 } }
			}
			add_adm_power = -100	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 40 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 50 } }
			}
			add_adm_power = -110	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 50 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 60 } }
			}
			add_adm_power = -120
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 60 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 70 } }
			}
			add_adm_power = -130	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 70 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 80 } }
			}
			add_adm_power = -140	
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 80 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 90 } }
			}
			add_adm_power = -150
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 90 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 100 } }
			}
			add_adm_power = -160
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 100 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 200 } }
			}
			add_adm_power = -170
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 200 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 300 } }
			}
			add_adm_power = -180
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 200 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 300 } }
			}
			add_adm_power = -190
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 300 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 400 } }
			}
			add_adm_power = -200
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 400 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 500 } }
			}
			add_adm_power = -210
		}
		if = {
			limit = {
				check_variable = { which = amount_of_owned_provinces value = 500 }
				NOT = { check_variable = { which = amount_of_owned_provinces value = 1000 } }
			}
			add_adm_power = -300
		}
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 5
		}
		if = {
			limit = {
				ai = yes	#makes ai back out of casting completely to prevent spam
			}
			add_ruler_modifier = { 
				name = magic_realm_menu_cooldown
				duration = 1825	#prevents them casting for 5 years
				hidden = yes
			}
			close_single_menu = yes
		}
		else = {
			country_event = { id = magic_realm_divination.0 days = 0 }
		}
	}
}

country_event = {
	id = magic_realm.100
	title = magic_realm.100.t
	desc = magic_realm.100.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	hidden = yes
	
	option = {
		if = {
			limit = {
				mil = 0
				NOT = { mil = 1 }
			}
			define_ruler_to_general = {
				fire = 1
				shock = 6
				manuever = 0
				siege = 1
				trait = war_wizard_personality
			}
		}
		else_if = {
			limit = {
				mil = 1
				NOT = { mil = 2 }
			}
			define_ruler_to_general = {
				fire = 1
				shock = 7
				manuever = 0
				siege = 2
				trait = war_wizard_personality
			}
		}
		else_if = {
			limit = {
				mil = 2
				NOT = { mil = 3 }
			}
			define_ruler_to_general = {
				fire = 2
				shock = 7
				manuever = 1
				siege = 3
				trait = war_wizard_personality
			}
		}
		else_if = {
			limit = {
				mil = 3
				NOT = { mil = 4 }
			}
			define_ruler_to_general = {
				fire = 2
				shock = 8
				manuever = 1
				siege = 4
				trait = war_wizard_personality
			}
		}
		else_if = {
			limit = {
				mil = 4
				NOT = { mil = 5 }
			}
			define_ruler_to_general = {
				fire = 2
				shock = 9
				manuever = 2
				siege = 5
				trait = war_wizard_personality
			}
		}
		else_if = {
			limit = {
				mil = 5
				NOT = { mil = 6 }
			}
			define_ruler_to_general = {
				fire = 3
				shock = 10
				manuever = 3
				siege = 6
				trait = war_wizard_personality
			}
		}
		else_if = {
			limit = {
				mil = 6
			}
			define_ruler_to_general = {
				fire = 3
				shock = 11
				manuever = 4
				siege = 7
				trait = war_wizard_personality
			}
		}
		else = {
			convert_ruler_to_general = yes
		}
	}
}
