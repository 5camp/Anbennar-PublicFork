#Allclan Events

namespace = allclan

# Pragmatic Codification
country_event = {
	id = allclan.1
	title = allclan.1.title
	desc = allclan.1.desc
	picture = CIVIL_WAR_eventPicture

	fire_only_once = yes

	trigger =	{
		tag = I98
		mission_completed = I98_setting_a_precedent
		NOT = {
			has_country_flag = I98_pragmatic_codification_flag
			has_country_modifier = monstrous_nation
		}
	}

	immediate = {
		hidden_effect = {
			change_government = republic
			add_government_reform = pentapandemonium_reform
			set_estate_privilege = estate_artificers_organization_discombobulatorium
			set_variable = {
			    which = metachaosCount
			    value = 0
			}
		}
	}
	
	option = { # Smash the Rock
		name = allclan.1.a
		tooltip = {
			add_government_reform = pentapandemonium_reform
			set_estate_privilege = estate_artificers_organization_discombobulatorium
		}
		custom_tooltip = allclan_linebreak_tt
		add_stability = -3
		add_pandemonium = { amount = 10 }
	}
}

# Goblins are Great
country_event = {
	id = allclan.2
	title = allclan.2.title
	desc = allclan.2.desc
	picture = CIVIL_WAR_eventPicture

	is_triggered_only = yes
	
	option = {
		name = allclan.2.a
		add_pandemonium = { amount = 5 }
		add_republican_tradition = 10
		add_country_modifier = { name = I98_overgobulation_4 duration = -1 }
		custom_tooltip = I98_too_many_goblins_tt
	}
}

# The Erecting Frenzy
country_event = {
	id = allclan.3
	title = allclan.3.title
	desc = allclan.3.desc
	picture = CIVIL_WAR_eventPicture

	is_triggered_only = yes
	
	option = {
		name = allclan.3.a
		custom_tooltip = I98_frenzy_event_tt
	}
}

# hidden event to handle removing the frenzy
country_event = {
	id = allclan.4
	title = allclan.4.title
	desc = allclan.4.desc
	picture = CIVIL_WAR_eventPicture

	fire_only_once = yes
	hidden = yes

	trigger = {
		tag = I98
		has_country_flag = I98_frenzy_flag
		NOT = { has_country_flag = I98_property_plunge_flag }
		NOT = { has_country_flag = I98_frenzy_stopped_flag }
		OR = {
			AND = {
				NOT = { mission_completed = I98_rabid_constructions }
				had_country_flag = {
					flag = I98_frenzy_flag
					days = 9125
				}
			}
			AND = {
				mission_completed = I98_rabid_constructions
				NOT = { mission_completed = I98_delirium_of_the_hammer }
				had_country_flag = {
					flag = I98_frenzy_flag
					days = 12775
				}
			}
			AND = {
				mission_completed = I98_delirium_of_the_hammer
				had_country_flag = {
					flag = I98_frenzy_flag
					days = 16425
				}
			}
			mission_completed = I98_lesson_in_moderation
		}
	}

	immediate = {
		hidden_effect = {
			country_event = { id = allclan.9 }
			clr_country_flag = I98_frenzy_flag
			set_country_flag = I98_frenzy_stopped_flag
		}
	}
	
	option = {
		name = allclan.4.a
	}
}

# A Cure for Homelessness
country_event = {
	id = allclan.5
	title = allclan.5.title
	desc = allclan.5.desc
	picture = CIVIL_WAR_eventPicture

	fire_only_once = yes

	trigger = {
		tag = I98
		had_country_flag = {
			flag = I98_frenzy_flag
			days = 72
		}
	}
	
	option = {
		name = allclan.5.a
		I98_decrease_overgobulation = yes
	}
}

# Gobonomics
country_event = {
	id = allclan.6
	title = allclan.6.title
	desc = allclan.6.desc
	picture = CIVIL_WAR_eventPicture

	fire_only_once = yes

	trigger = {
		tag = I98
		had_country_flag = {
			flag = I98_frenzy_flag
			days = 1825
		}
	}
	

	immediate = {
		hidden_effect = {
			country_event = {
				id = allclan.14
				days = 800
				random = 20
			}
		}
	}

	option = {
		name = allclan.6.a
		add_years_of_income = 1.5
	}
}

country_event = {
	id = allclan.7
	title = allclan.7.title
	desc = allclan.7.desc
	picture = CIVIL_WAR_eventPicture

	fire_only_once = yes

	trigger = {
		tag = I98
		had_country_flag = {
			flag = I98_frenzy_flag
			days = 3650
		}
	}
	
	option = {
		name = allclan.7.a
		add_country_modifier = {
			name = I98_debtor_subsidized_erection
			duration = 1825
		}
		I98_decrease_overgobulation = yes
	}
}

# Minor Loan Defaults
country_event = {
	id = allclan.8
	title = allclan.8.title
	desc = allclan.8.desc
	picture = CIVIL_WAR_eventPicture

	fire_only_once = yes

	trigger = {
		tag = I98
		had_country_flag = {
			flag = I98_frenzy_flag
			days = 7300
		}
	}
	
	option = {
		name = allclan.8.a
		add_years_of_income = -1
		I98_increase_overgobulation = yes
	}
}

# A Bloody Morning on the Natvirod
country_event = {
	id = allclan.9
	title = allclan.9.title
	desc = allclan.9.desc
	picture = CIVIL_WAR_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			set_country_flag = I98_property_plunge_flag
			set_country_flag = I98_frenzy_stopped_flag
			clr_country_flag = I98_frenzy_flag
			if = {
				limit = { has_country_flag = I98_severity_0 }
				add_country_modifier = {
					name = I98_property_plunge_0
					duration = -1
				}
			}
			else_if = {
				limit = { has_country_flag = I98_severity_1 }
				add_country_modifier = {
					name = I98_property_plunge_1
					duration = -1
				}
			}
			else_if = {
				limit = { has_country_flag = I98_severity_2 }
				add_country_modifier = {
					name = I98_property_plunge_2
					duration = -1
				}
			}
			else_if = {
				limit = { has_country_flag = I98_severity_3 }
				add_country_modifier = {
					name = I98_property_plunge_3
					duration = -1
				}
			}
			else_if = {
				limit = { has_country_flag = I98_severity_4 }
				add_country_modifier = {
					name = I98_property_plunge_4
					duration = -1
				}
			}
			else_if = {
				limit = { has_country_flag = I98_severity_5 }
				add_country_modifier = {
					name = I98_property_plunge_5
					duration = -1
				}
			}
			complete_mission = I98_rabid_constructions
			complete_mission = I98_delirium_of_the_hammer
			complete_mission = I98_lesson_in_moderation
			complete_mission = I98_establish_building_standards
			complete_mission = I98_municipal_zoning
		}
	}
	
	option = {
		name = allclan.9.a
		if = {
			limit = { has_country_flag = I98_severity_0 }
			add_country_modifier = {
				name = I98_property_plunge_0
				duration = -1
			}
		}
		else_if = {
			limit = { has_country_flag = I98_severity_1 }
			add_country_modifier = {
				name = I98_property_plunge_1
				duration = -1
			}
		}
		else_if = {
			limit = { has_country_flag = I98_severity_2 }
			add_country_modifier = {
				name = I98_property_plunge_2
				duration = -1
			}
		}
		else_if = {
			limit = { has_country_flag = I98_severity_3 }
			add_country_modifier = {
				name = I98_property_plunge_3
				duration = -1
			}
		}
		else_if = {
			limit = { has_country_flag = I98_severity_4 }
			add_country_modifier = {
				name = I98_property_plunge_4
				duration = -1
			}
		}
		else_if = {
			limit = { has_country_flag = I98_severity_5 }
			add_country_modifier = {
				name = I98_property_plunge_5
				duration = -1
			}
		}
		add_pandemonium = { amount = 25 }
		I98_increase_overgobulation = yes
		I98_increase_overgobulation = yes
	}
}

# Properties Repossessed
country_event = {
	id = allclan.10
	title = allclan.10.title
	desc = allclan.10.desc
	picture = CIVIL_WAR_eventPicture

	fire_only_once = yes

	trigger = {
		tag = I98
		had_country_flag = {
			flag = I98_property_plunge_flag
			days = 550
		}
	}
	
	option = {
		name = allclan.10.a
		I98_increase_overgobulation = yes
	}
}

# Riots in the Streets
country_event = {
	id = allclan.11
	title = allclan.11.title
	desc = allclan.11.desc
	picture = CIVIL_WAR_eventPicture

	fire_only_once = yes

	trigger = {
		tag = I98
		had_country_flag = {
			flag = I98_property_plunge_flag
			days = 1100
		}
	}

	immediate = {
		every_owned_province = {
			limit = {
				OR = {
					has_terrain = dwarven_road
					has_terrain = dwarven_hold
				}
			}
			random_list = {
				1 = {
					I98_devastate_province = yes
				}
				1 = {
					# Do nothing
					modifier = {
						factor = 0
						NOT = { num_free_building_slots = 1 }
					}
				}
			}
		}
	}
	
	option = {
		name = allclan.11.a
		custom_tooltip = I98_riots_tt
	}
}

# Investors Recoup Losses
country_event = {
	id = allclan.12
	title = allclan.12.title
	desc = allclan.12.desc
	picture = CIVIL_WAR_eventPicture

	fire_only_once = yes

	trigger = {
		tag = I98
		had_country_flag = {
			flag = I98_property_plunge_flag
			days = 1650
		}
	}

	option = {
		name = allclan.12.a
		add_country_modifier = {
			name = I98_plunging_toilet
			duration = 1825
		}
	}
}

# Goblinomic Miracle
country_event = {
	id = allclan.13
	title = allclan.13.title
	desc = allclan.13.desc
	picture = CIVIL_WAR_eventPicture

	fire_only_once = yes

	trigger = {
		tag = I98
		had_country_flag = {
			flag = I98_property_plunge_flag
			days = 3475
		}
	}

	option = {
		name = allclan.13.a
		remove_country_modifier = I98_property_plunge_0
		remove_country_modifier = I98_property_plunge_1
		remove_country_modifier = I98_property_plunge_2
		remove_country_modifier = I98_property_plunge_3
		remove_country_modifier = I98_property_plunge_4
		remove_country_modifier = I98_property_plunge_5
		add_country_modifier = {
			name = I98_slow_goblinomic_growth
			duration = 1825
		}
		set_country_flag = I98_plunge_over_tt
	}
}

# The Natvirod Market
country_event = {
	id = allclan.14
	title = allclan.14.title
	desc = allclan.14.desc
	picture = CIVIL_WAR_eventPicture

	is_triggered_only = yes
	
	option = {
		name = allclan.14.a
		if = {
			limit = { 2986 = { owned_by = ROOT } }
			2986 = { add_province_modifier = { name = I98_natvirod_market duration = -1 } }
		}
	}
}

# The Gob for the Job
country_event = {
	id = allclan.15
	title = allclan.15.title
	desc = allclan.15.desc
	picture = CIVIL_WAR_eventPicture

	is_triggered_only = yes
	
	option = {
		name = allclan.15.a
		2863 = {
			change_trade_goods = glass
			add_province_modifier = {
				name = I98_chem_lab
				duration = 7300
			}
		}
		define_advisor = {
			type = natural_scientist
			skill = 3
			cost_multiplier = 0.3
		}
	}

	option = {
		name = allclan.15.b
		2863 = {
			add_center_of_trade_level = 1
			add_province_modifier = {
				name = I98_dealers_point
				duration = 7300
			}
		}
		define_advisor = {
			type = trader
			skill = 3
			cost_multiplier = 0.3
		}
	}
}


# more goblins in the northern pass
country_event = {
	id = allclan.16
	title = allclan.16.title
	desc = allclan.16.desc
	picture = CIVIL_WAR_eventPicture

	is_triggered_only = yes

	immediate = {
		if = {
			limit = { has_global_flag = I98_goblintide }
			random_province = {
				limit = { region = northern_pass_region }
				owner = {
					country_event = {
						id = allclan.16
						days = 365
						random = 30
					}
				}
			}
		}
		if = {
			limit = {
				had_global_flag = {
					flag = I98_goblintide
					days = 5475
				}
			}
			clr_global_flag = I98_goblintide
		}
	}
	
	option = {
		name = allclan.16.a
		random_owned_province = {
			limit = { region = northern_pass_region }
			if = {
				limit = { has_large_goblin_minority_trigger = yes }
				random_list = {
					25 = {
						I98_goblintide_effect = yes
					}
					75 = {
						add_base_production = 1
					}
				}
			}
			else = {
				add_goblin_minority_size_effect = yes
			}
		}
	}
}

# tidal pool preparation
country_event = {
	id = allclan.17
	title = allclan.17.title
	desc = allclan.17.desc
	picture = CIVIL_WAR_eventPicture

	is_triggered_only = yes
	
	option = {
		name = allclan.17.a
		add_country_modifier = {
			name = I98_tidal_pool_experiments
			duration = 3650
		}
		jorkad_lake_area = {
			add_province_modifier = {
				name = I98_minor_flooding
				duration = 7300
			}
		}
	}
}

# Lmao Loser get nuked
province_event = {
	id = allclan.100
	title = allclan.100.t
	desc = allclan.100.d
	picture = INVENTION_eventPicture

	is_triggered_only = yes

	option = {
		name = artifice_inventions.100.a
		add_devastation = 100
		if = {
			limit = { base_tax = 4 }
			set_base_tax = 3
		}
		if = {
			limit = { base_production = 4 }
			set_base_production = 3
		}
		if = {
			limit = { base_manpower = 4 }
			set_base_manpower = 3
		}
		add_province_modifier = {
			name = I98_province_nuked
			duration = 7300
		}
		area = {
			add_devastation = 25
			add_province_modifier = {
				name = I98_province_nuked
				duration = 1825
			}
		}
		I98 = {
			add_country_modifier = {
				name = I98_nuke_used
				duration = 7300
			}
		}
	}
}

# Bombnar Expedition
province_event = {
	id = allclan.101
	title = allclan.101.t
	desc = allclan.101.d
	picture = INVENTION_eventPicture

	is_triggered_only = yes

	option = {
		name = artifice_inventions.101.a
		add_devastation = 25
		add_base_tax = -1
		add_base_production = -1
		add_base_manpower = -1
		spawn_expedition = yes
	}
}


# Drilling Cannon Shells Invention
country_event = {
	id = allclan.1001
	title = allclan.1001.t
	desc = allclan.1001.d
	picture = INVENTION_eventPicture

	is_triggered_only = yes

	option = {
		name = artifice_inventions.69.a
		custom_tooltip = new_artifice_invention_tooltip
	}
}

# Super Duper Boots Invention
country_event = {
	id = allclan.1002
	title = allclan.1002.t
	desc = allclan.1002.d
	picture = INVENTION_eventPicture

	is_triggered_only = yes

	option = {
		name = artifice_inventions.69.a
		custom_tooltip = new_artifice_invention_tooltip
	}
}

# Debug
country_event = {
	id = allclan.999
	title = allclan.999.t
	desc = allclan.999.d
	picture = INVENTION_eventPicture

	is_triggered_only = yes

	option = {
		name = artifice_inventions.69.a
		mission_reward_artifice_points_5 = yes
		mission_reward_artifice_points_5 = yes
		mission_reward_artifice_points_5 = yes
		mission_reward_artifice_points_5 = yes
		mission_reward_artifice_points_5 = yes
		mission_reward_artifice_points_5 = yes
		mission_reward_artifice_points_5 = yes
		mission_reward_artifice_points_5 = yes
		mission_reward_artifice_points_5 = yes
		mission_reward_artifice_points_5 = yes
		mission_reward_artifice_points_5 = yes
	}
}