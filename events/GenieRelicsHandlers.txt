namespace = sarhal_relics

#repairing
country_event = { #
    id = sarhal_relics.0
    title = sarhal_relics.0.t
    desc = sarhal_relics.0.d
    picture = RELIGION_eventPicture

    is_triggered_only = yes


    immediate = {
    }

    option = {
        name = relic.0.a

        if = {
            limit = {
                has_country_flag = relic_repairing_dark_chains
            }
            clr_country_flag = relic_broken_dark_chains
        }
        else_if = {
            limit = {
                has_country_flag = relic_repairing_emerald_rattle
            }
            clr_country_flag = relic_broken_emerald_rattle
            set_variable = {
                which = EmeraldRattleCharges
                value = 3
            }
        }
        else_if = {
            limit = {
                has_country_flag = relic_repairing_pyre_flame
            }
            clr_country_flag = relic_broken_pyre_flame
            set_variable = {
                which = PyreFlameCharges
                value = 3
            }
        }
        else_if = {
            limit = {
                has_country_flag = relic_repairing_samias_anklet
            }
            clr_country_flag = relic_broken_samias_anklet
            set_variable = {
                which = SamiasAnkletCharges
                value = 3
            }
        }
        else_if = {
            limit = {
                has_country_flag = relic_repairing_baladi_hookah
            }
            clr_country_flag = relic_broken_baladi_hookah
            set_variable = {
                which = BaladiHookahCharges
                value = 3
            }
        }
        else_if = {
            limit = {
                has_country_flag = relic_repairing_wondrous_oven
            }
            clr_country_flag = relic_broken_wondrous_oven
        }
        else_if = {
            limit = {
                has_country_flag = relic_repairing_haingo_valiha
            }
            clr_country_flag = relic_broken_haingo_valiha
        }
        else_if = {
            limit = {
                has_country_flag = relic_repairing_ardim_qarast
            }
            clr_country_flag = relic_broken_ardim_qarast
        }
        else_if = {
            limit = {
                has_country_flag = relic_repairing_pillar_of_gates
            }
            clr_country_flag = relic_broken_pillar_of_gates
        }
        else_if = {
            limit = {
                has_country_flag = relic_repairing_nail_of_the_damned
            }
            clr_country_flag = relic_broken_nail_of_the_damned
        }
        else_if = {
            limit = {
                has_country_flag = relic_repairing_ring_of_baashi
            }
            clr_country_flag = relic_broken_ring_of_baashi
        }
        else_if = {
            limit = {
                has_country_flag = relic_repairing_silver_mirror
            }
            clr_country_flag = relic_broken_silver_mirror
        }
        else_if = {
            limit = {
                has_country_flag = relic_repairing_hammer_of_kvanga
            }
            clr_country_flag = relic_broken_hammer_of_kvanga
        }
        else_if = {
            limit = {
                has_country_flag = relic_repairing_tablet_myths
            }
            clr_country_flag = relic_broken_tablet_of_myths
        }
        else_if = {
            limit = {
                has_country_flag = relic_repairing_mantle_of_dominance
            }
            clr_country_flag = relic_broken_mantle_of_dominance
        }
        #remove_country_modifier = relic_cooldown_mod
		ai_chance = {
			factor = 1
		}
    }
}


#Dark Chains 

#repair
country_event = {
    id = sarhal_relics.1
    title = sarhal_relics.1.t
    desc = sarhal_relics.1.d
    picture = RELIGION_eventPicture

    is_triggered_only = yes


    immediate = {
    }

    option = {
        name = relic.1.a

        trigger = {
            adm_power = 100
        }

        add_adm_power = -100
        add_country_modifier = { name = relic_cooldown_mod duration = 1825 desc = RELIC_COOLDOWN }
        set_country_flag = relic_repairing_dark_chains
        country_event = { id = sarhal_relics.0 days = 1825 }
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.1.b

        trigger = {
            NOT = { adm_power = 100 }
        }
        custom_tooltip = "You need 100 administrative power to repair this relic"
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.1.c

        #exit
		ai_chance = {
			factor = 0
		}
    }
}

#activate
country_event = {
    id = sarhal_relics.2
    title = sarhal_relics.2.t
    desc = sarhal_relics.2.d
    picture = RELIGION_eventPicture

    is_triggered_only = yes


    immediate = {
    }

    option = {
        name = relic.2.a

        trigger = {
            OR = {
                religion = xhazobkult
                legitimacy_equivalent = 60
            }
        }

        if = {
            limit = {
                NOT = { religion = xhazobkult }
            }
            add_legitimacy = -60
            add_republican_tradition = -60
            add_devotion = -60
            add_horde_unity = -60
            add_meritocracy = -60
        }
        add_country_modifier = { name = relic_cooldown_mod duration = 1825 desc = RELIC_COOLDOWN }
        set_country_flag = relic_broken_dark_chains
        country_event = { id = sarhal_relics.31 }
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.2.b

        trigger = {
            NOT = {
                AND = {
                    religion = xhazobkult
                    legitimacy_equivalent = 60
                }
            }
        }
        custom_tooltip = "As a non Xhazobkult nation, you need 60 legitimacy (or equivalent) to activate the Dark Chains"
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.2.c

        #exit
		ai_chance = {
			factor = 0
		}
    }
}

country_event = {
    id = sarhal_relics.31
    title = sarhal_relics.31.t
    desc = sarhal_relics.31.d
    picture = RELIGION_eventPicture

    is_triggered_only = yes


    immediate = {
    }

    option = {
        name = relic.31.a

        trigger = {
            religion = xhazobkult
        }
        random_list = {
            1 = {
                kill_ruler = yes
            }

            2 = {
                add_ruler_modifier = { name = dark_chains_hyena_demon duration = -1 }
                modifier = {
                    factor = 3
                    patriarch_authority = 0.75
                }
            }
        }
		ai_chance = {
			factor = 100
		}
    }

    option = {
        name = relic.31.b

        random_list = {
            1 = {
                kill_ruler = yes
            }

            1 = {
                add_ruler_modifier = { name = dark_chains_tyranny_demon duration = -1 }

                modifier = {
                    factor = 2
                    religion = xhazobkult
                }
                modifier = {
                    factor = 3
                    patriarch_authority = 0.5
                }
            }
        }
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.31.c

        random_list = {
            1 = {
                kill_ruler = yes
            }

            1 = {
                add_ruler_modifier = { name = dark_chains_corruption_demon duration = -1 }

                modifier = {
                    factor = 2
                    religion = xhazobkult
                }
                modifier = {
                    factor = 3
                    patriarch_authority = 0.5
                }
            }
        }
		ai_chance = {
			factor = 1
		}
    }
    option = {
        name = relic.31.d

        random_list = {
            1 = {
                kill_ruler = yes
            }

            1 = {
                add_ruler_modifier = { name = dark_chains_slaughter_demon duration = -1 }

                modifier = {
                    factor = 2
                    religion = xhazobkult
                }
                modifier = {
                    factor = 3
                    patriarch_authority = 0.5
                }
            }
        }
		ai_chance = {
			factor = 1
		}
    }
}

#Emerald Rattle

#repair
country_event = {
    id = sarhal_relics.3
    title = sarhal_relics.3.t
    desc = sarhal_relics.3.d
    picture = RELIGION_eventPicture

    is_triggered_only = yes


    immediate = {
    }

    option = {
        name = relic.3.a

        trigger = {
            adm_power = 100
        }

        add_adm_power = -100
        add_country_modifier = { name = relic_cooldown_mod duration = 1825 desc = RELIC_COOLDOWN }
        set_country_flag = relic_repairing_emerald_rattle
        country_event = { id = sarhal_relics.0 days = 1825 }
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.3.b

        trigger = {
            NOT = { adm_power = 100 }
        }
        custom_tooltip = "You need 100 administrative power to repair this relic"
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.1.c

        #exit
		ai_chance = {
			factor = 0
		}
    }
}

#activate
country_event = {
    id = sarhal_relics.4
    title = sarhal_relics.4.t
    desc = sarhal_relics.4.d
    picture = RELIGION_eventPicture

    is_triggered_only = yes


    immediate = {
    }

    option = {
        name = relic.4.a

        trigger = {
            treasury = 800
            adm_power = 50
        }

        add_treasury = -800
        add_adm_power = -50
        add_country_modifier = { name = relic_cooldown_mod duration = 1825 desc = RELIC_COOLDOWN }
        country_event = { id = sarhal_relics.32 }
        hidden_effect = {
            change_variable = {
                which = EmeraldRattleCharges
                value = -1
            }
        }
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = EmeraldRattleCharges
                        value = 0
                    }
                }
            }
            set_country_flag = relic_broken_emerald_rattle
        }
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.4.b

        trigger = {
            NOT = {
                treasury = 800
                adm_power = 50
            }
        }
        custom_tooltip = "You lack the 800 ducats and 50 adm power to activate the Emerald Rattle"
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.2.c

        #exit
		ai_chance = {
			factor = 0
		}
    }
}

country_event = {
    id = sarhal_relics.32
    title = sarhal_relics.32.t
    desc = sarhal_relics.32.d
    picture = RELIGION_eventPicture

    is_triggered_only = yes


    immediate = {
    }

    option = {
        name = relic.32.a

        add_country_modifier = { name = earth_elemental_construction duration = 1825 }
		ai_chance = {
			factor = 100
		}
    }

    option = {
        name = relic.32.b

        define_general = {
            name = "Elder Earth Elemental"
            fire = 0
            shock = 2
            maneuver = 3
            siege = 8
            trait = earth_elemental_personality
        }
		ai_chance = {
			factor = 100
		}
    }
}


#Pyre Flame

#repair
country_event = {
    id = sarhal_relics.5
    title = sarhal_relics.5.t
    desc = sarhal_relics.5.d
    picture = RELIGION_eventPicture

    is_triggered_only = yes


    immediate = {
    }

    option = {
        name = relic.5.a

        add_years_of_income = -1
        add_country_modifier = { name = relic_cooldown_mod duration = 1825 desc = RELIC_COOLDOWN }
        set_country_flag = relic_repairing_pyre_flame
        country_event = { id = sarhal_relics.0 days = 1825 }
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.1.c

        #exit
		ai_chance = {
			factor = 0
		}
    }
}

#activate
country_event = {
    id = sarhal_relics.6
    title = sarhal_relics.6.t
    desc = sarhal_relics.6.d
    picture = RELIGION_eventPicture

    is_triggered_only = yes


    immediate = {
    }

    option = {
        name = relic.6.a

        trigger = {
            dip_power = 50
            OR = {
                culture = kaino
                NOT = {
                    has_country_modifier = undead_military
                }
            }
        }

        add_dip_power = -50
        add_country_modifier = { name = relic_cooldown_mod duration = 1825 desc = RELIC_COOLDOWN }
        set_country_flag = pyre_flame_flag
        hidden_effect = {
            change_variable = {
                which = PyreFlameCharges
                value = -1
            }
        }
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = PyreFlameCharges
                        value = 0
                    }
                }
            }
            set_country_flag = relic_broken_pyre_flame
        }
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.6.b

        trigger = {
            dip_power = 50
            OR = {
                has_country_modifier = undead_military
                culture = kaino
            }
        }

        add_dip_power = -50
        add_country_modifier = { name = relic_cooldown_mod duration = 1825 desc = RELIC_COOLDOWN }
        define_general = {
            name = "Flamewraith"
            shock = 4
            fire = 2
            maneuver = 6
            siege = 0
            trait = flamewraith_personality
        }
        add_manpower = 40
        add_yearly_manpower = 1
        if = { limit = { culture = kaino } country_event = { id = sarhal_relics.33 } }
        hidden_effect = {
            change_variable = {
                which = PyreFlameCharges
                value = -1
            }
        }
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = PyreFlameCharges
                        value = 0
                    }
                }
            }
            set_country_flag = relic_broken_pyre_flame
        }
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.6.c

        trigger = {
            NOT = {
                dip_power = 50
            }
        }
        custom_tooltip = "You lack the 50 dip power to activate the Pyre Flame"
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.2.c

        #exit
		ai_chance = {
			factor = 0
		}
    }
}

country_event = {
    id = sarhal_relics.33
    title = sarhal_relics.33.t
    desc = sarhal_relics.33.d
    picture = RELIGION_eventPicture

    is_triggered_only = yes


    immediate = {
    }

    option = {
        name = relic.33.a

        if = {
			limit = {
				NOT = { has_country_modifier = undead_military }
			}
			clear_racial_military = yes
			add_country_modifier = {
				name = undead_military
				duration = -1
			}
		}
		
		if = {
			limit = {
				NOT = { unit_type = tech_undead }
				has_any_racial_military = yes
			}
			
			change_unit_type = tech_undead
		}
		ai_chance = {
			factor = 100
		}
    }
}

#Samia's Anklet

#repair
country_event = {
    id = sarhal_relics.7
    title = sarhal_relics.7.t
    desc = sarhal_relics.7.d
    picture = RELIGION_eventPicture

    is_triggered_only = yes


    immediate = {
    }

    option = {
        name = relic.7.a

        trigger = {
            dip_power = 100
        }

        add_dip_power = -100
        add_country_modifier = { name = relic_cooldown_mod duration = 1825 desc = RELIC_COOLDOWN }
        set_country_flag = relic_repairing_samias_anklet
        country_event = { id = sarhal_relics.0 days = 1825 }
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.1.c

        #exit
		ai_chance = {
			factor = 0
		}
    }
}

#activate
country_event = {
    id = sarhal_relics.8
    title = sarhal_relics.8.t
    desc = sarhal_relics.8.d
    picture = RELIGION_eventPicture

    is_triggered_only = yes


    immediate = {
    }

    option = {
        name = relic.8.a

        trigger = {
            adm_power = 100
        }

        add_adm_power = -100
        add_country_modifier = { name = relic_cooldown_mod duration = 1825 desc = RELIC_COOLDOWN }
        hidden_effect = {
            every_owned_province = {
                limit = {
                    OR = {
                        trade_goods = grain
                        trade_good = coffee
                        trade_goods = silk
                        trade_goods = sugar
                        trade_goods = cocoa
                        trade_goods = tea
                        trade_goods = tropical_wood
                        trade_goods = wine
                        trade_goods = spices
                        trade_goods = cotton 
                        trade_goods = tobacco
                        trade_goods = dyes
                        trade_goods = cloves
                    }
                }
                add_province_modifier = {
                    name = anklets_rain_blessing
                    duration = 3650
                }
            }
        }
        hidden_effect = {
            change_variable = {
                which = SamiasAnkletCharges
                value = -1
            }
        }
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = SamiasAnkletCharges
                        value = 0
                    }
                }
            }
            set_country_flag = relic_broken_samias_anklet
        }
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.8.b

        trigger = {
            NOT = {
                adm_power = 100
            }
        }
        custom_tooltip = "You lack the 100 adm power to activate Samia's Annklet"
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.2.c

        #exit
		ai_chance = {
			factor = 0
		}
    }
}


#Raas Baladi's Hookah

#repair
country_event = {
    id = sarhal_relics.9
    title = sarhal_relics.9.t
    desc = sarhal_relics.9.d
    picture = RELIGION_eventPicture

    is_triggered_only = yes


    immediate = {
    }

    option = {
        name = relic.9.a

        trigger = {
            mil_power = 100
        }

        add_mil_power = -100
        add_country_modifier = { name = relic_cooldown_mod duration = 1825 desc = RELIC_COOLDOWN }
        set_country_flag = relic_repairing_pyre_flame
        country_event = { id = sarhal_relics.0 days = 1825 }
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.9.b

        trigger = {
            NOT = { mil_power = 100 }
        }
        
        custom_tooltip = "Needs 100 mil power to repair"
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.1.c

        #exit
		ai_chance = {
			factor = 0
		}
    }
}

#activate
country_event = {
    id = sarhal_relics.10
    title = sarhal_relics.10.t
    desc = sarhal_relics.10.d
    picture = RELIGION_eventPicture

    is_triggered_only = yes


    immediate = {
    }

    option = {
        name = relic.10.a

        add_years_of_income = -1
        add_prestige = 10
        add_country_modifier = { name = relic_cooldown_mod duration = 1825 desc = RELIC_COOLDOWN }
        capital_scope = {
           area = {
                limit = { owned_by = ROOT }
                add_province_modifier = { name = raas_baladis_performance duration = 1825 }
            }
        }
        hidden_effect = {
            change_variable = {
                which = BaladiHookahCharges
                value = -1
            }
        }
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = BaladiHookahCharges
                        value = 0
                    }
                }
            }
            set_country_flag = relic_broken_baladi_hookah
        }
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.10.b

        add_years_of_income = -3
        add_prestige = 50
        add_country_modifier = { name = relic_cooldown_mod duration = 1825 desc = RELIC_COOLDOWN }
        capital_scope = {
            region = {
                limit = { owned_by = ROOT }
                add_province_modifier = { name = raas_baladis_performance duration = 1825 }
            }
        }
        hidden_effect = {
            change_variable = {
                which = BaladiHookahCharges
                value = -1
            }
        }
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = BaladiHookahCharges
                        value = 0
                    }
                }
            }
            set_country_flag = relic_broken_baladi_hookah
        }
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.10.c

        add_years_of_income = -10
        add_prestige = 100
        add_country_modifier = { name = relic_cooldown_mod duration = 1825 desc = RELIC_COOLDOWN }
        add_country_modifier = { name = raas_baladis_grand_performance duration = 1825}
        hidden_effect = {
            change_variable = {
                which = BaladiHookahCharges
                value = -1
            }
        }
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = BaladiHookahCharges
                        value = 0
                    }
                }
            }
            set_country_flag = relic_broken_baladi_hookah
        }
		ai_chance = {
			factor = 1
		}
    }

    option = {
        name = relic.2.c

        #exit
		ai_chance = {
			factor = 0
		}
    }
}