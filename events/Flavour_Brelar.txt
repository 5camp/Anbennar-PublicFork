
namespace = flavour_brelar

#Old tales in the ironhouses
country_event = {
	id = flavour_brelar.1
	title = flavour_brelar.1.t
	desc = flavour_brelar.1.d
	picture = RIOTING_workers_eventPicture

	is_triggered_only = yes

	trigger = {
		mission_completed = g27_argan_ironhouses
	}

	immediate = {
		set_country_flag = g27_architect_research_1
	}

	option = {
		name = flavour_brelar.1.a
		ai_chance = {
			factor = 1
		}
	}
}

#Tracing the past
country_event = {
	id = flavour_brelar.2
	title = flavour_brelar.2.t
	desc = flavour_brelar.2.d
	picture = RIOTING_workers_eventPicture

	trigger = {
		has_country_flag = g27_architect_research_1
	}

	mean_time_to_happen = {
		days = 3650
		modifier = {
			factor = 0.5
			mission_completed = g27_restart_mills
		}
		modifier = {
			factor = 0.5
			mission_completed = g27_marbelous_infrastructure
		}
		modifier = {
			factor = 0.5
			mission_completed = g27_steel_city
		}
		modifier = {
			factor = 0.5
			employed_advisor = {
				type = spymaster
			}
		}
		modifier = {
			factor = 0.5
			employed_advisor = {
				type = court_mage
			}
		}
		modifier = {
			factor = 0.5
			ruler_has_personality = scholar_personality
		}
		modifier = {
			factor = 0.5
			ruler_has_personality = intricate_web_weaver_personality
		}
	}

	immediate = {
		hidden_effect = {
			clr_country_flag = g27_architect_research_1
			set_country_flag = g27_architect_research_2
		}
	}

	option = {
		name = flavour_brelar.2.a
		ai_chance = {
			factor = 1
		}
	}
}

#Secrets of the Glory days
country_event = {
	id = flavour_brelar.3
	title = flavour_brelar.3.t
	desc = flavour_brelar.3.d
	picture = RIOTING_workers_eventPicture
	
	trigger = {
		has_country_flag = g27_architect_research_2
	}

	mean_time_to_happen = {
		days = 3650
		modifier = {
			factor = 0.5
			mission_completed = g27_restart_mills
		}
		modifier = {
			factor = 0.5
			mission_completed = g27_marbelous_infrastructure
		}
		modifier = {
			factor = 0.5
			mission_completed = g27_steel_city
		}
		modifier = {
			factor = 0.5
			employed_advisor = {
				type = spymaster
			}
		}
		modifier = {
			factor = 0.5
			employed_advisor = {
				type = court_mage
			}
		}
		modifier = {
			factor = 0.5
			ruler_has_personality = intricate_web_weaver_personality
		}
	}

	immediate = {
		hidden_effect = {
			clr_country_flag = g27_architect_research_2
			set_country_flag = g27_architect_research_3
		}
	}

	option = {
		name = flavour_brelar.3.a
		ai_chance = {
			factor = 1
		}
	}
}

#the knowledge to tame the river
country_event = {
	id = flavour_brelar.4
	title = flavour_brelar.4.t
	desc = flavour_brelar.4.d
	picture = RIOTING_workers_eventPicture

	trigger = {
		has_country_flag = g27_architect_research_3
	}

	mean_time_to_happen = {
		days = 3650
		modifier = {
			factor = 0.5
			mission_completed = g27_restart_mills
		}
		modifier = {
			factor = 0.5
			mission_completed = g27_marbelous_infrastructure
		}
		modifier = {
			factor = 0.5
			mission_completed = g27_steel_city
		}
		modifier = {
			factor = 0.5
			employed_advisor = {
				type = natural_scientist
			}
		}
		modifier = {
			factor = 0.5
			employed_advisor = {
				type = fortification_expert
			}
		}
		modifier = {
			factor = 0.5
			ruler_has_personality = architectural_visionary_personality
		}
		modifier = {
			factor = 0.5
			ruler_has_personality = scholar_personality
		}
		modifier = {
			factor = 0.5
			ruler_has_personality = free_thinker_personality
		}
	}

	immediate = {
		hidden_effect = {
			clr_country_flag = g27_architect_research_3
		}
	}

	option = {
		name = flavour_brelar.4.a
		ai_chance = {
			factor = 1
		}
		unlock_estate_privilege = {
			estate_privilege = estate_burghers_brelari_dam_architects
		}
	}
}

#Dam Upgrade lvl 1
province_event = {
	id = flavour_brelar.5
	title = flavour_brelar.5.t
	desc = flavour_brelar.5.d
	picture = CITY_DEVELOPMENT_eventPicture

	trigger = {
		owner = {
			OR = {
				has_estate_privilege = estate_burghers_brelari_dam_architects
				overlord = {
					has_estate_privilege = estate_burghers_brelari_dam_architects
				}
			}
		}
		OR = {
			has_great_project = {
				type = ynnic_dam_adbrabohvi
				tier = 0
			}
			has_great_project = {
				type = ynnic_dam_bosancovac
				tier = 0
			}
			has_great_project = {
				type = ynnic_dam_mocbarja
				tier = 0
			}
			has_great_project = {
				type = ynnic_dam_vels_bacar
				tier = 0
			}
		}
		development = 10
	}

	mean_time_to_happen = {
		days = 3650
		#faster depending on stuff from MT
	}

	option = {
		name = flavour_brelar.5.a
		ai_chance = {
			factor = 1
		}
		if = {
			limit = {
				has_great_project = {
					type = ynnic_dam_adbrabohvi
					tier = 0
				}
			}
			add_great_project_tier = {
				type = ynnic_dam_adbrabohvi
				tier = 1
			}
		}
		else_if = {
			limit = {
				has_great_project = {
					type = ynnic_dam_vels_bacar
					tier = 0
				}
			}
			add_great_project_tier = {
				type = ynnic_dam_vels_bacar
				tier = 1
			}
		}
		else_if = {
			limit = {
				has_great_project = {
					type = ynnic_dam_bosancovac
					tier = 0
				}
			}
			add_great_project_tier = {
				type = ynnic_dam_bosancovac
				tier = 1
			}
		}
		else_if = {
			limit = {
				has_great_project = {
					type = ynnic_dam_mocbarja
					tier = 0
				}
			}
			add_great_project_tier = {
				type = ynnic_dam_mocbarja
				tier = 1
			}
		}
		owner = {
			add_splendor = 100
			if = {
				limit = {
					is_subject = yes
				}
				overlord = {
					add_splendor = 100
				}
			}
		}
	}
}

#Dam Upgrade lvl 2
province_event = {
	id = flavour_brelar.6
	title = flavour_brelar.6.t
	desc = flavour_brelar.6.d
	picture = CITY_DEVELOPMENT_eventPicture

	trigger = {
		owner = {
			OR = {
				has_estate_privilege = estate_burghers_brelari_dam_architects
				overlord = {
					has_estate_privilege = estate_burghers_brelari_dam_architects
				}
			}
		}
		OR = {
			has_great_project = {
				type = ynnic_dam_adbrabohvi
				tier = 1
			}
			has_great_project = {
				type = ynnic_dam_bosancovac
				tier = 1
			}
			has_great_project = {
				type = ynnic_dam_mocbarja
				tier = 1
			}
			has_great_project = {
				type = ynnic_dam_vels_bacar
				tier = 1
			}
		}
		development = 20
	}

	mean_time_to_happen = {
		days = 7300
		#faster depending on stuff from MT
	}

	option = {
		name = flavour_brelar.6.a
		ai_chance = {
			factor = 1
		}
		if = {
			limit = {
				has_great_project = {
					type = ynnic_dam_adbrabohvi
					tier = 1
				}
			}
			add_great_project_tier = {
				type = ynnic_dam_adbrabohvi
				tier = 1
			}
		}
		else_if = {
			limit = {
				has_great_project = {
					type = ynnic_dam_vels_bacar
					tier = 1
				}
			}
			add_great_project_tier = {
				type = ynnic_dam_vels_bacar
				tier = 1
			}
		}
		else_if = {
			limit = {
				has_great_project = {
					type = ynnic_dam_bosancovac
					tier = 1
				}
			}
			add_great_project_tier = {
				type = ynnic_dam_bosancovac
				tier = 1
			}
		}
		else_if = {
			limit = {
				has_great_project = {
					type = ynnic_dam_mocbarja
					tier = 1
				}
			}
			add_great_project_tier = {
				type = ynnic_dam_mocbarja
				tier = 1
			}
		}
		owner = {
			add_splendor = 100
			if = {
				limit = {
					is_subject = yes
				}
				overlord = {
					add_splendor = 100
				}
			}
		}
	}
}

#Dam Upgrade lvl 3
province_event = {
	id = flavour_brelar.7
	title = flavour_brelar.7.t
	desc = flavour_brelar.7.d
	picture = FAR_AND_WIDE_eventPicture

	trigger = {
		owner = {
			OR = {
				has_estate_privilege = estate_burghers_brelari_dam_architects
				overlord = {
					has_estate_privilege = estate_burghers_brelari_dam_architects
				}
			}
		}
		OR = {
			has_great_project = {
				type = ynnic_dam_adbrabohvi
				tier = 2
			}
			has_great_project = {
				type = ynnic_dam_bosancovac
				tier = 2
			}
			has_great_project = {
				type = ynnic_dam_mocbarja
				tier = 2
			}
			has_great_project = {
				type = ynnic_dam_vels_bacar
				tier = 2
			}
		}
		development = 30
	}

	mean_time_to_happen = {
		days = 10950
		#faster depending on stuff from MT
	}

	option = {
		name = flavour_brelar.7.a
		ai_chance = {
			factor = 1
		}
		if = {
			limit = {
				has_great_project = {
					type = ynnic_dam_adbrabohvi
					tier = 2
				}
			}
			add_great_project_tier = {
				type = ynnic_dam_adbrabohvi
				tier = 1
			}
		}
		else_if = {
			limit = {
				has_great_project = {
					type = ynnic_dam_vels_bacar
					tier = 2
				}
			}
			add_great_project_tier = {
				type = ynnic_dam_vels_bacar
				tier = 1
			}
		}
		else_if = {
			limit = {
				has_great_project = {
					type = ynnic_dam_bosancovac
					tier = 2
				}
			}
			add_great_project_tier = {
				type = ynnic_dam_bosancovac
				tier = 1
			}
		}
		else_if = {
			limit = {
				has_great_project = {
					type = ynnic_dam_mocbarja
					tier = 2
				}
			}
			add_great_project_tier = {
				type = ynnic_dam_mocbarja
				tier = 1
			}
		}
		owner = {
			add_splendor = 100
			if = {
				limit = {
					is_subject = yes
				}
				overlord = {
					add_splendor = 100
				}
			}
		}
	}
}

#The whirr of the valley
country_event = {
	id = flavour_brelar.8
	title = flavour_brelar.8.t
	desc = flavour_brelar.8.d
	picture = TEXTILE_INDUSTRY_eventPicture

	is_triggered_only = yes

	option = {
		name = flavour_brelar.8.a
		ai_chance = {
			factor = 1
		}
		2488 = {
			add_province_modifier = {
				name = g27_up_mill_down_mine
				duration = 4975
			}
		}
		2838 = {
			add_province_modifier = {
				name = g27_up_mill_down_mine
				duration = 4975
			}
		}
	}
}

#Malacynn Canal 
country_event = {
	id = flavour_brelar.9
	title = flavour_brelar.9.t
	desc = flavour_brelar.9.d
	picture = MALAYAN_PORT_eventPicture

	is_triggered_only = yes

	option = {
		name = flavour_brelar.9.a
		ai_chance = {
			factor = 1
		}
		2488 = {
			add_center_of_trade_level = 1
		}
		1169 = {
			add_base_production = 2
			add_province_modifier = {
				name = g27_malacynn_canal
				duration = -1
			}
		}
		1170 = {
			add_base_production = 2
			add_province_modifier = {
				name = g27_malacynn_canal
				duration = -1
			}
		}
	}
}

#Solicitations in secret
country_event = {
	id = flavour_brelar.10
	title = flavour_brelar.10.t
	desc = flavour_brelar.10.d
	picture = ASSASSINATION_eventPicture

	is_triggered_only = yes

	option = {
		name = flavour_brelar.10.a
		ai_chance = {
			factor = 1
		}
		hidden_effect = {
			remove_advisor_by_category = DIP
		}
		define_advisor = {
			type = spymaster
			skill = 1
			cost_multiplier = 0.5
			location = 2488
			culture = ROOT
			religion = ROOT
		}
		add_ruler_personality = secretive_personality
		change_adm = 1
	}

	option = {
		name = flavour_brelar.10.b
		ai_chance = {
			factor = 1
		}
		hidden_effect = {
			remove_advisor_by_category = DIP
		}
		define_advisor = {
			type = spymaster
			skill = 1
			cost_multiplier = 0.5
			location = 2488
			culture = ROOT
			religion = ROOT
		}
		add_ruler_personality = intricate_web_weaver_personality
		change_mil = 1
	}
}

#Restructure the Order
country_event = {
	id = flavour_brelar.11
	title = flavour_brelar.11.t
	desc = flavour_brelar.11.d
	picture = BATTLE_eventPicture

	is_triggered_only = yes

	immediate = {
		1172 = {
			spawn_rebels = {
				type = noble_rebels
				use_monarch_as_leader = yes
				size = 2
			}
		}
	}

	option = {
		name = flavour_brelar.11.a
		ai_chance = {
			factor = 1
		}
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -10
		}
		add_country_modifier = {
			name = g27_returning_amethyst_exiles
			duration = 3650
		}
	}
}

#The Boats' Uprising
country_event = {
	id = flavour_brelar.12
	title = flavour_brelar.12.t
	desc = flavour_brelar.12.d
	picture = REVOLT_eventPicture

	is_triggered_only = yes
	major = yes

	trigger = {
		has_country_flag = g27_boats_uprising_flag
		1165 = {
			NOT = {
				has_province_flag = g27_rebels_supported
			}
		}
	}

	option = {
		name = flavour_brelar.12.a
		ai_chance = {
			factor = 1
		}
		1165 = {
			set_province_flag = g27_rebels_supported
			create_revolt = yes
		}
	}
}

#The Boats' Return
country_event = {
	id = flavour_brelar.13
	title = flavour_brelar.13.t
	desc = flavour_brelar.13.d
	picture = REVOLUTION_eventPicture

	is_triggered_only = yes
	major = yes

	immediate = {
		hidden_effect = {
			random_known_country = {
				limit = {
					has_country_flag = g27_boats_uprising_flag
				}
			}
			save_event_target_as = g27_brelar_boats
		}
	}

	option = {
		name = flavour_brelar.13.a
		ai_chance = {
			factor = 1
		}
		if = {
			limit = {
				G33 = {
					exists = no
				}
			}
			G33 = {
				every_core_province = {
					limit = {
						country_or_non_sovereign_subject_holds = FROM
					}
					cede_province = G33
				}
				create_subject = {
					subject_type = ynnic_iosahar
					who = event_target:g27_brelar_boats
				}
				change_government = republic
				add_government_reform = oligarchic_republic
			}	
		}
		else_if = {
			limit = {
				1165 = {
					NOT = {
						owned_by = G33
					}
				}
			}
			1165 = {
				cede_province = G33
			}
			G33 = {
				create_subject = {
					subject_type = ynnic_iosahar
					who = event_target:g27_brelar_boats
				}
				change_government = republic
				add_government_reform = oligarchic_republic
			}
		}
		else = {
			create_subject = {
				subject_type = ynnic_iosahar
				who = event_target:g27_brelar_boats
			}
			change_government = republic
			add_government_reform = oligarchic_republic
		}
		event_target:g27_brelar_boats = {
			add_stability = 1
			add_scaled_republican_tradition = 15
		}
	}

	after = {
		1165 = {
			clr_province_flag = g27_rebels_supported
			remove_province_modifier = g27_boats_revolt
		}
		event_target:g27_brelar_boats = {
			clr_country_flag = g27_boats_uprising_flag
		}
	}
}