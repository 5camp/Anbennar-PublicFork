namespace = verkalozovar_events

#Elephant Grove
country_event = {
	id = verkalozovar_events.1
	title = verkalozovar_events.1.title
	desc = verkalozovar_events.1.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = verkalozovar_events.1.a
		ai_chance = { factor = 1 }

		custom_tooltip = Y63_elephant_grove_tt
		set_country_flag = Y63_elephant_grove_flag
	}

	option = {
		name = verkalozovar_events.1.b
		ai_chance = { factor = 0 }
	}
}

#Elephant Grove Rebellion
country_event = {
	id = verkalozovar_events.2
	title = verkalozovar_events.2.title
	desc = verkalozovar_events.2.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			if = {
				limit = { 4761 = { country_or_non_sovereign_subject_holds = Y66 } }
				4761 = { cede_province = Y70 }
			}
			if = {
				limit = { 4967 = { country_or_non_sovereign_subject_holds = Y66 } }
				4967 = { cede_province = Y70 }
			}
			Y70 = {
				capital_scope = {
					infantry = PREV
					infantry = PREV
					infantry = PREV
					infantry = PREV
					cavalry = PREV
					cavalry = PREV
				}
			}
			Y63 = {
				create_subject = {
					subject_type = patronate
					subject = Y70
				}
				country_event = {
					id = verkalozovar_events.3
				}
			}
		}
	}
	
	option = {
		name = verkalozovar_events.2.a
		ai_chance = { factor = 1 }
	}
}

#Elephant Grove Rebellion, VO version
country_event = {
	id = verkalozovar_events.3
	title = verkalozovar_events.3.title
	desc = verkalozovar_events.3.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = verkalozovar_events.3.a
		ai_chance = { factor = 1 }

		custom_tooltip = Y63_phonan_tt
	}
}

country_event = {
	id = verkalozovar_events.4
	title = verkalozovar_events.4.title
	desc = verkalozovar_events.4.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = verkalozovar_events.4.a
		ai_chance = { factor = 1 }

		
		# Installs Ma Hoang
		every_owned_province = {
			limit = {
				OR = {
					culture = khom
					is_core = Y66
				}
			}
			cede_province = Y67
		}
		every_subject_country = {
			limit = {
				NOT = { tag = Y70 }
			}
			every_owned_province = {
				limit = {
					OR = {
						is_core = Y66
						is_core = Y67
					}
					OR = {
						culture = khom
						culture = phonan
					}
				}
				cede_province = Y67
			}
		}

		#releases phonan
		if = {
			limit = { has_country_flag = Y63_elephant_grove_flag }
			every_owned_province = {
				limit = {
					is_core = Y70
					NOT = { is_capital = yes }
				}
				cede_province = Y70
			}
			every_subject_country = {
				limit = {
					any_owned_province = { culture = phonan }
				}
				every_owned_province = {
					limit = { culture = phonan }
					cede_province = Y70
				}
			}
			create_subject = {
			    subject_type = patronate
			    subject = Y70
			}
		}
	}
}

country_event = { # Treaty of Kai
	id = verkalozovar_events.5
	title = verkalozovar_events.5.title
	desc = verkalozovar_events.5.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			add_country_modifier = {
				name = Y63_treaty_happened
				duration = 1825
				hidden = yes
			}
		}
	}
	
	option = {
		name = verkalozovar_events.5.a
		Y63 = { country_event = { id = verkalozovar_events.6 } }
	}
}

country_event = { # The Duandi Treaty
	id = verkalozovar_events.6
	title = verkalozovar_events.6.title
	desc = verkalozovar_events.6.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = { # we accept
		name = verkalozovar_events.6.a
		medium_increase_of_dwarven_tolerance_effect = yes
		FROM = { country_event = { id = verkalozovar_events.7 } }
	}
}

country_event = { # The Duandi Treaty
	id = verkalozovar_events.7
	title = verkalozovar_events.7.title
	desc = verkalozovar_events.7.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = { # they accepted yay
		name = verkalozovar_events.7.a
		add_trust = {
			who = FROM
			value = 10
			mutual = yes
		}
		medium_increase_of_human_tolerance_effect = yes
	}
}

country_event = { # Duandi Open Renegotiation
	id = verkalozovar_events.8
	title = verkalozovar_events.8.title
	desc = verkalozovar_events.8.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = { # accept
		name = verkalozovar_events.8.a
		FROM = {
			country_event = { id = verkalozovar_events.9 }
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 100
				NOT = { total_development = FROM }
			}
		}
	}
	
	option = { # refuse
		name = verkalozovar_events.8.b
		FROM = {
			country_event = { id = verkalozovar_events.10 }
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 100
				total_development = FROM
			}
		}
	}
}

country_event = { # Dihn Accepts!
	id = verkalozovar_events.9
	title = verkalozovar_events.9.title
	desc = verkalozovar_events.9.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = verkalozovar_events.9.a
		create_subject = {
			subject = Y67
			subject_type = autonomous_vassal
		}
	}
}

country_event = { # Dihn Refuses!
	id = verkalozovar_events.10
	title = verkalozovar_events.10.title
	desc = verkalozovar_events.10.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = { # show em who's the boss
		name = verkalozovar_events.10.a
		declare_war_with_cb = {
			who = Y67
			casus_belli = cb_vassalize_mission
		}
	}
	
	option = { # nah
		name = verkalozovar_events.10.b
		add_stability = -1
		add_prestige = -10
	}
}

country_event = { # The Place of Runesmithing
	id = verkalozovar_events.11
	title = verkalozovar_events.11.title
	desc = verkalozovar_events.11.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = verkalozovar_events.11.a
		set_estate_privilege = estate_mages_organization_runesmiths
		define_advisor = {
			type = court_mage
			culture = nephrite_dwarf
			discount = yes
			cost_multiplier = 0.5
		}
	}
}

country_event = { # A Brief Conversation
	id = verkalozovar_events.12
	title = verkalozovar_events.12.title
	desc = verkalozovar_events.12.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		set_ruler_flag = Y63_conversed_with_oz_amekh
	}
	
	option = { # learn from him
		name = verkalozovar_events.12.a
		if = {
			limit = { num_of_ruler_traits = { amount = 3 } }
			hidden_effect = {
				clear_ruler_personalities = yes
				add_ruler_personality = immortal_personality
			}
		}
		add_ruler_personality = mage_personality
		set_country_flag = Y63_oz_amekh_teachings
	}
	
	option = { # he should stay
		name = verkalozovar_events.13.a
		every_subject_country = {
			add_country_modifier = {
				name = Y63_oz_amekh_guide
				duration = -1
			}
		}
		set_country_flag = Y63_oz_amekh_ending
	}
}

country_event = { # Ancestral Grip
	id = verkalozovar_events.13
	title = verkalozovar_events.13.title
	desc = verkalozovar_events.13.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = {
		name = verkalozovar_events.13.a
		add_country_modifier = {
			name = Y63_oz_amekh_seized_power
			duration = -1
		}
		clr_country_flag = Y63_oz_amekh_teachings
		set_country_flag = Y63_oz_amekh_ending
	}
}

country_event = { # Palace of the Mountain Wizard
	id = verkalozovar_events.14
	title = verkalozovar_events.14.title
	desc = verkalozovar_events.14.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = { # king
		name = verkalozovar_events.14.a
		custom_tooltip = Y63_building_nephrite_palace_tt
		custom_tooltip = Y63_nephrite_palace_king_tt
		set_country_flag = Y63_occupancy_king
	}
	
	option = { # oz-amekh
		name = verkalozovar_events.14.b
		custom_tooltip = Y63_building_nephrite_palace_tt
		custom_tooltip = Y63_nephrite_palace_oz_amekh_tt
		set_country_flag = Y63_occupancy_oz_amekh
		set_country_flag = Y63_oz_amekh_ending
	}
}

country_event = { # The Grand Projection
	id = verkalozovar_events.15
	title = verkalozovar_events.15.title
	desc = verkalozovar_events.15.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = verkalozovar_events.15.a
		custom_tooltip = Y63_unlocked_grand_runes_tt
		set_country_flag = Y63_unlocked_grand_runes
	}
}

country_event = { # Brothers Revolt Succeded
	id = verkalozovar_events.16
	title = verkalozovar_events.16.title
	desc = verkalozovar_events.16.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = verkalozovar_events.16.a
		create_subject = {
			subject = FROM
			subject_type = vassal
		}
	}
}

country_event = { # Brothers Revolt Failed - hidden
	id = verkalozovar_events.17
	title = verkalozovar_events.17.title
	desc = verkalozovar_events.17.desc
	picture = DIPLOMACY_eventPicture
	
	fire_only_once = yes
	
	hidden = yes
	
	trigger = {
		has_country_flag = Y63_brothers_revolt_flag
		NOT = { num_of_rebel_armies = 1 }
		NOT = { num_of_rebel_controlled_provinces = 1 }
	}
	
	option = {
		name = verkalozovar_events.17.a
		clr_country_flag = Y63_brothers_revolt_flag
		Y63 = { country_event = { id = verkalozovar_events.18 } }
	}
}

country_event = { # Brothers Revolt Failed - Notification
	id = verkalozovar_events.18
	title = verkalozovar_events.18.title
	desc = verkalozovar_events.18.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = verkalozovar_events.18.a
		add_casus_belli = {
			target = FROM
			type = cb_vassalize_mission
		}
	}
}




# Runes System Events

country_event = { # Runes Menu
	id = verkalozovar_events.100
	title = verkalozovar_events.100.title
	desc = verkalozovar_events.100.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = { # go back
		name = verkalozovar_events.100.a
		highlight = yes
		clr_country_flag = V63_runes_menu_open
	}
	
	option = { # minor runes
		trigger = { has_country_flag = Y63_unlocked_minor_runes }
		name =  verkalozovar_events.100.b
	}
	
	option = { # grand runes
		trigger = { has_country_flag = Y63_unlocked_grand_runes }
		name =  verkalozovar_events.100.c
	}
}

country_event = { # Minor Runes
	id = verkalozovar_events.101
	title = verkalozovar_events.101.title
	desc = verkalozovar_events.101.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = { # go back
		name = verkalozovar_events.101.a
		highlight = yes
		set_country_flag = Y86_rune_menu_go_back
		hidden_effect = { country_event = { id = verkalozovar_events.100 } }
	}
	
	option = {
		name =  verkalozovar_events.101.b
	}
	
	option = {
		name =  verkalozovar_events.101.c
	}
	
	after = {
		if = {
			limit = { has_country_flag = Y86_rune_menu_go_back }
			clr_country_flag = Y86_rune_menu_go_back
		}
		else = {
			set_country_flag = Y86_rune_menu_101
			country_event = { id = verkalozovar_events.1000 }
		}
	}
}



country_event = { # Refresh Runes Menu
	id = verkalozovar_events.1000
	title = verkalozovar_events.1000.title
	desc = verkalozovar_events.1000.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	hidden = yes
	
	option = { # go back
		name = verkalozovar_events.1000.a
		if = {
			limit = { has_country_flag = Y86_rune_menu_101 }
			clr_country_flag = Y86_rune_menu_101
			country_event = { id = verkalozovar_events.101 }
		}
		else_if = {
			
		}
	}
}