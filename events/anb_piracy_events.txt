namespace = anb_piracy

country_event = {
	id = anb_piracy.1
	title = "anb_piracy.1.t"
	picture = PIRATE_CAPTAINS_eventPicture
	desc = "anb_piracy.1.d"

	fire_only_once = yes

	trigger = {
		has_dlc = "Golden Century"
		NOT = { exists = M03 }
		has_global_flag = golden_age_of_piracy
		NOT = { has_reform = pirate_republic_reform }
		OR = {
			AND = {
				owns_core_province = 1100
				is_subject = no
				num_of_cities = 2
			}
			any_subject_country = {
				owns_core_province = 1100
				num_of_cities = 2
			}
		}
		1100 = { # must be privateering in node
			privateer_power = {
				country = ROOT
				share = 5
			}
		}
		OR = {
			1100 = {
				recent_treasure_ship_passage = yes
			}
			1100 = {
				trade_share = {
					country = ROOT
					share = 10
				}
			}
			any_country = {
				capital_scope = {
					region = ruined_sea_region
				}
				war_exhaustion = 5
			}
		}
	}

	immediate = {
		hidden_effect = {
			1100 = {
				discover_country = M03
				add_core = M03
			}
			random_country = {
				limit = {
					is_rival = ROOT
					any_subject_country = {
						any_owned_province = {
						#	OR = {
								region = ruined_sea_region
						#		region = colombia_region
						#	}
						}
					}
				}
			#	save_event_target_as = spanish_main_country
			}
		}
	}

	mean_time_to_happen = {
		months = 12
		# modifiers
	}

	option = { # play as the pirates
		name = "pirates.6.a"
		trigger = {
			ai = no
		}
		1100 = {
			owner = {
				release = M03
			}
		}
		M03 = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			adopt_reform_progress = ROOT
			change_religion = ROOT
			change_primary_culture = ROOT
			discover_provinces = ROOT
			add_republican_tradition = 50
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
			}
			define_ruler = {
				name = "John Davis"
				adm = 2
				dip = 2
				mil = 5
			}
			if = {
				limit = {
					NOT = { has_idea_group = pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			swap_non_generic_missions = yes
			set_ruler_flag = historical_pirate
			add_ruler_personality = legendary_pirate_personality
		}
		switch_tag = M03
	}
	option = { # pirates get released
		name = "pirates.6.b"
		1100 = {
			owner = {
				release = PRY
			}
		}
		M03 = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			adopt_reform_progress = ROOT
			change_religion = ROOT
			change_primary_culture = ROOT
			add_republican_tradition = 50
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
			}
			define_ruler = {
				name = "John Davis"
				adm = 2
				dip = 2
				mil = 5
			}
			if = {
				limit = {
					NOT = { has_idea_group = pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			swap_non_generic_missions = yes
			set_ruler_flag = historical_pirate
			add_ruler_personality = legendary_pirate_personality
		}
	}
}

# Tortuga - Brethren of the Coast
country_event = {
	id = pirates.7
	title = "pirates.7.t"
	picture = PIRATE_CAPTAINS_eventPicture
	desc = "pirates.7.d"

	fire_only_once = yes

	trigger = {
		has_dlc = "Golden Century"
		NOT = { exists = TOR }
		NOT = { has_reform = pirate_republic_reform }
		489 = {
			OR = {
				religion = protestant
				religion = anglican
				religion = reformed
				religion = hussite
			}
		}
		has_global_flag = golden_age_of_piracy
		OR = {
			AND = {
				owns_core_province = 489
				is_subject = no
				num_of_cities = 2
			}
			any_subject_country = {
				owns_core_province = 489
				num_of_cities = 2
			}
		}
		OR = {
			489 = {
				recent_treasure_ship_passage = yes
			}
			489 = {
				privateer_power = { share = 1 }
			}
			any_country = {
				capital_scope = {
					region = carribeans_region
				}
				war_exhaustion = 5
			}
		}
	}

	immediate = {
		hidden_effect = {
			489 = {
				discover_country = TOR
				add_core = TOR
			}
		}
	}

	mean_time_to_happen = {
		months = 12
	}

	option = { # play as the pirates
		name = "pirates.7.a"
		# play as TOR
		trigger = {
			ai = no
		}
		489 = {
			owner = {
				release = TOR
			}
		}
		TOR = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			change_religion = ROOT
			change_primary_culture = ROOT
			discover_provinces = ROOT
			adopt_reform_progress = ROOT
			add_republican_tradition = 50
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
			}
			define_ruler = {
				name = "Henry Morgan"
				adm = 3
				dip = 5
				mil = 4
			}
			if = {
				limit = {
					NOT = { has_idea_group = pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			swap_non_generic_missions = yes
			set_ruler_flag = historical_pirate
			add_ruler_personality = legendary_pirate_personality
		}
		switch_tag = TOR
	}
	option = { # pirates get released
		name = "pirates.7.b"
		489 = {
			owner = {
				release = TOR
			}
		}
		TOR = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			add_republican_tradition = 50
			change_religion = ROOT
			change_primary_culture = ROOT
			adopt_reform_progress = ROOT
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
			}
			define_ruler = {
				name = "Henry Morgan"
				adm = 3
				dip = 5
				mil = 4
			}
			if = {
				limit = {
					NOT = { has_idea_group = pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			swap_non_generic_missions = yes
			set_ruler_flag = historical_pirate
			add_ruler_personality = legendary_pirate_personality
		}
	}
}
