
namespace = flavor_seghdihr
#1-49 missions
#50-99 goblin incursions
#100+ SGC

#Missions
#
#goblin initial attack
country_event = {
	id = flavor_seghdihr.1
	title = flavor_seghdihr.1.t
	desc = flavor_seghdihr.1.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = flavor_seghdihr.1.a
		4090 = { 
			add_devastation = 25
			spawn_rebels = {
				type = cave_goblin_rebel
				size = 1
			}
		}
		4218 = {
			add_devastation = 30
			spawn_rebels = {
				type = cave_goblin_rebel
				size = 2
			}
		}
		custom_tooltip = flavor_seghdihr.1.tooltip
		hidden_effect = { 
			#####set up incursions
			set_country_flag = seghdihr_incursions_active
			set_variable = { which = incursion_gathering_strength value = 0 }
			set_variable = { which = incursion_mission_bonus value = 0 }
			seghdihr_calculate_incursion_strength = yes
		}
		ai_chance = { factor = 5 }
	}
}

#VG event
country_event = {
	id = flavor_seghdihr.2
	title = flavor_seghdihr.2.t
	desc = flavor_seghdihr.2.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = flavor_seghdihr.2.a
		reverse_add_opinion = { who = H78 modifier = opinion_disappointed }
		add_prestige = 15
		H78 = { country_event = { id = flavor_seghdihr.3 } }
		ai_chance = { factor = 5 }
	}
}

#Seghdihr gets reply
country_event = {
	id = flavor_seghdihr.3
	title = flavor_seghdihr.3.t
	desc = flavor_seghdihr.3.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = flavor_seghdihr.3.a
		add_casus_belli = { type = cb_vassalize_mission target = F47 }
		ai_chance = { factor = 5 }
	}
}

#kings dilemma
country_event = {
	id = flavor_seghdihr.4
	title = flavor_seghdihr.4.t
	desc = flavor_seghdihr.4.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = flavor_seghdihr.4.a
		if = {
			limit = { has_country_modifier = seghdihr_seg_band_contract }
			remove_country_modifier = seghdihr_seg_band_contract
		}
		if = {
			limit = { NOT = { has_estate_privilege = estate_adventurers_organization_licensed_adventurers } }
			set_estate_privilege = estate_adventurers_organization_licensed_adventurers
		}
		else_if = {
			limit = { has_estate_privilege = estate_adventurers_ennoblement_of_adventurers }
			remove_estate_privilege = estate_adventurers_ennoblement_of_adventurers
		}
		else_if = {
			limit = { has_estate_privilege = estate_adventurers_free_company_rosters }
			remove_estate_privilege = estate_adventurers_free_company_rosters
		}
		else_if = {
			limit = { has_estate_privilege = estate_adventurers_heroes_in_the_army }
			remove_estate_privilege = estate_adventurers_heroes_in_the_army
		}
		else_if = {
			limit = { has_estate_privilege = estate_adventurers_advisors }
			remove_estate_privilege = estate_adventurers_advisors
		}
		add_estate_loyalty = { estate = estate_adventurers loyalty = -10 }
		ai_chance = { factor = 5 }
	}
}

#true unity
country_event = {
	id = flavor_seghdihr.5
	title = flavor_seghdihr.5.t
	desc = flavor_seghdihr.5.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = flavor_seghdihr.5.a
		#take diplo if vassal fed
		custom_tooltip = flavor_seghdihr.5.tooltip
		hidden_effect = {
			F47 = {
				every_owned_province = {
					limit = {
						NOT = { area = verkal_gulan_area }
						NOT = { province_id = 2915 }
					}
					ROOT = { add_dip_power = -5 }
				}
			}
			I15 = {
				every_owned_province = {
					limit = { NOT = { area = hehos_legacy_area  } }
					ROOT = { add_dip_power = -5 }
				}
			}
			I14 = {
				every_owned_province = {
					limit = { NOT = { area = vazumbrog_area } }
					ROOT = { add_dip_power = -5 }
				}
			}
			I17 = {
				every_owned_province = {
					limit = { NOT = { area = ozumbrog_area } }
					ROOT = { add_dip_power = -5 }
				}
			}
		}

		#change to historical cultures and inherit
		verkal_gulan_area = { change_culture = gold_dwarf }
		2915 = { change_culture = gold_dwarf }
		inherit = F47
		hehos_legacy_area = { change_culture = pyrite_dwarf }
		inherit = I15
		vazumbrog_area = { change_culture = titanium_dwarf }
		inherit = I14
		ozumbrog_area = { change_culture = topaz_dwarf }
		inherit = I17

		#colonization buff if needed
		if = {
			limit = {
				middle_dwarovar_region = {
					calc_true_if = {
						amount = 10
						NOT = { is_city = yes }
					}
				}
			}
			add_country_modifier = { name = seghdihr_colonization_buff duration = 7300 }
		}

		#gov reform, name, and missions
		add_government_reform = seghdihr_segbandal_reform
		override_country_name = THE_SEGBANDAL
		set_country_flag = seghdihr_part2
		swap_non_generic_missions = yes
		ai_chance = { factor = 5 }
	}
}








######Goblin Incursions######
country_event = {
	id = flavor_seghdihr.50
	title = flavor_seghdihr.50.t
	desc = flavor_seghdihr.50.d
	picture = FORT_eventPicture
	
	#hidden = yes
	is_triggered_only = yes
	
	trigger = {
		tag = H78
		has_country_flag = seghdihr_incursions_active
	}


	immediate = {
		seghdihr_calculate_incursion_strength = yes
		#incursion_base_strength
	}



	option = {
		name = flavor_seghdihr.4.a
		
		ai_chance = { factor = 5 }
	}
}