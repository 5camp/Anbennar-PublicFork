namespace = diggy_surface_mine

#########################################
#Diggy Events
#########################################

#Add Base Mine
country_event = {
	id = diggy_surface_mine.1
	title = diggy_surface_mine.1.t
	desc = diggy_surface_mine.1.d
	picture = TRADEGOODS_eventPicture
	goto = spawn_province

	is_triggered_only = no
	trigger = {
		has_country_flag = land_survey_complete
		any_owned_province = {
			had_province_flag = {
				flag = build_surface_mine0
				days = 1734
			}
		}
	}

	mean_time_to_happen = { days = 91 }

	option = {
		name = diggy_surface_mine.1.a
		ai_chance = { factor = 100 }
			random_owned_province = {
				limit = { 
					had_province_flag = {
						flag = build_surface_mine0
						days = 1734
					}
				}
				save_event_target_as = diaspora_event
				province_event = { 
					id = diggy_surface_mine.5
					days = 5475
					random = 3650
				}
				add_dwarven_minority_size_effect = yes
				add_orcish_minority_size_effect = yes
				add_orcish_minority_size_effect = yes
				add_devastation = 20
				clr_province_flag = build_surface_mine0
				set_province_flag = surface_mine0
				random_list = {
					10 = {
						add_permanent_province_modifier = { 	
							name = surface_mine0a
							duration = -1  
							hidden = no
						}
					}
					10 = {
						add_permanent_province_modifier = { 	
							name = surface_mine0b
							duration = -1  
							hidden = no
						}
					}
					10 = {
						add_permanent_province_modifier = { 	
							name = surface_mine0c
							duration = -1  
							hidden = no
						}
					}
					10 = {
						add_permanent_province_modifier = { 	
							name = surface_mine0d
							duration = -1  
							hidden = no
						}
					}
					10 = {
						add_permanent_province_modifier = { 	
							name = surface_mine0e
							duration = -1  
							hidden = no
						}
					}
					10 = {
						add_permanent_province_modifier = { 	
							name = surface_mine0f
							duration = -1  
							hidden = no
						}
					}
					10 = {
						add_permanent_province_modifier = { 	
							name = surface_mine0g
							duration = -1  
							hidden = no
						}
					}
				}
				random_list = {
					25 = {
						change_trade_goods = copper
					}
					40 = {
						change_trade_goods = iron
					}
					25 = {
						change_trade_goods = gems
					}
					5 = {
						change_trade_goods = gold
					}
					2 = {
						change_trade_goods = coal
					}
					2 = {
						change_trade_goods = damestear
						add_permanent_province_modifier = {
							name = damestear_rich_deposit
							duration = -1
						}
					}
					1 = {
						change_trade_goods = precursor_relics
						hidden_effect = {
							set_add_relics_count = yes
						}
					}
				}
			}
	}
}

#Serial Service Winches
province_event = {
	id = diggy_surface_mine.2
	title = diggy_surface_mine.2.t
	desc = diggy_surface_mine.2.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = diggy_surface_mine.2.a
		ai_chance = { factor = 100 }
				owner = { clr_country_flag = silverforge_diggy_event_open }
				if = {	
					limit = {
						has_province_modifier = surface_mine0a
					}
					remove_province_modifier = surface_mine0a
					add_permanent_province_modifier = {
						name = surface_mine1a
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine0b
					}
					remove_province_modifier = surface_mine0b
					add_permanent_province_modifier = {
						name = surface_mine1b
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine0c
					}
					remove_province_modifier = surface_mine0c
					add_permanent_province_modifier = {
						name = surface_mine1c
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine0d
					}
					remove_province_modifier = surface_mine0d
					add_permanent_province_modifier = {
						name = surface_mine1d
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine0e
					}
					remove_province_modifier = surface_mine0e
					add_permanent_province_modifier = {
						name = surface_mine1e
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine0f
					}
					remove_province_modifier = surface_mine0f
					add_permanent_province_modifier = {
						name = surface_mine1f
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine0g
					}
					remove_province_modifier = surface_mine0g
					add_permanent_province_modifier = {
						name = surface_mine1g
						duration = -1
					}
				}

	}
}

#Terraced Housing
province_event = {
	id = diggy_surface_mine.3
	title = diggy_surface_mine.3.t
	desc = diggy_surface_mine.3.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = diggy_surface_mine.3.a
		ai_chance = { factor = 100 }
				owner = { clr_country_flag = silverforge_diggy_event_open }
				if = {	
					limit = {
						has_province_modifier = surface_mine1a
					}
					remove_province_modifier = surface_mine1a
					add_permanent_province_modifier = {
						name = surface_mine2a
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine1b
					}
					remove_province_modifier = surface_mine1b
					add_permanent_province_modifier = {
						name = surface_mine2b
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine1c
					}
					remove_province_modifier = surface_mine1c
					add_permanent_province_modifier = {
						name = surface_mine2c
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine1d
					}
					remove_province_modifier = surface_mine1d
					add_permanent_province_modifier = {
						name = surface_mine2d
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine1e
					}
					remove_province_modifier = surface_mine1e
					add_permanent_province_modifier = {
						name = surface_mine2e
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine1f
					}
					remove_province_modifier = surface_mine1f
					add_permanent_province_modifier = {
						name = surface_mine2f
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine1g
					}
					remove_province_modifier = surface_mine1g
					add_permanent_province_modifier = {
						name = surface_mine2g
						duration = -1
					}
				}
	}
}

#Terraced Farms
province_event = {
	id = diggy_surface_mine.4
	title = diggy_surface_mine.4.t
	desc = diggy_surface_mine.4.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = diggy_surface_mine.4.a
		ai_chance = { factor = 100 }
				owner = { clr_country_flag = silverforge_diggy_event_open }
				if = {	
					limit = {
						has_province_modifier = surface_mine2a
					}
					remove_province_modifier = surface_mine2a
					add_permanent_province_modifier = {
						name = surface_mine3a
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine2b
					}
					remove_province_modifier = surface_mine2b
					add_permanent_province_modifier = {
						name = surface_mine3b
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine2c
					}
					remove_province_modifier = surface_mine2c
					add_permanent_province_modifier = {
						name = surface_mine3c
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine2d
					}
					remove_province_modifier = surface_mine2d
					add_permanent_province_modifier = {
						name = surface_mine3d
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine2e
					}
					remove_province_modifier = surface_mine2e
					add_permanent_province_modifier = {
						name = surface_mine3e
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine2f
					}
					remove_province_modifier = surface_mine2f
					add_permanent_province_modifier = {
						name = surface_mine3f
						duration = -1
					}
				}
				else_if = {
					limit = {
						has_province_modifier = surface_mine2g
					}
					remove_province_modifier = surface_mine2g
					add_permanent_province_modifier = {
						name = surface_mine3g
						duration = -1
					}
				}
	}
}

#Majority Leaves
province_event = {
	id = diggy_surface_mine.5
	title = diggy_surface_mine.5.t
	desc = diggy_surface_mine.5.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = diggy_surface_mine.5.a
			ai_chance = { factor = 0 }
			event_target:diaspora_event = {
				change_culture = silver_dwarf
				province_event = { 
					id = diggy_surface_mine.6
					days = 5475
					random = 3650
				}
				if = {
					limit = {
						base_tax = 3
					}
					add_base_tax = -2
					add_base_production = 1
					random_list = {
						33 = {
							912 = { add_base_tax = 1 }
						}
						66 = { }
					}
				}
				else = { add_base_tax = -1 }
				if = {
					limit = {
						base_manpower = 3
					}
					add_base_manpower = -2
					add_base_production = 1
					random_list = {
						33 = {
							912 = { add_base_manpower = 1 }
						}
						66 = { }
					}
				}
				else = { add_base_manpower = -1 }
			}
	}
}

#Large Minority Leaves
province_event = {
	id = diggy_surface_mine.6
	title = diggy_surface_mine.6.t
	desc = diggy_surface_mine.6.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = diggy_surface_mine.6.a
		ai_chance = { factor = 0 }
			event_target:diaspora_event = {
				if = {
					limit = {
						has_province_modifier = elven_minority_oppressed_large
					}
					remove_province_modifier = elven_minority_oppressed_large
					add_province_modifier = {
						name = elven_minority_oppressed_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = elven_minority_coexisting_large
					}
					remove_province_modifier = elven_minority_coexisting_large
					add_province_modifier = {
						name = elven_minority_coexisting_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = elven_minority_integrated_large
					}
					remove_province_modifier = elven_minority_integrated_large
					add_province_modifier = {
						name = elven_minority_integrated_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				if = {
					limit = {
						has_province_modifier = halfling_minority_oppressed_large
					}
					remove_province_modifier = halfling_minority_oppressed_large
					add_province_modifier = {
						name = halfling_minority_oppressed_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = halfling_minority_coexisting_large
					}
					remove_province_modifier = halfling_minority_coexisting_large
					add_province_modifier = {
						name = halfling_minority_coexisting_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = halfling_minority_integrated_large
					}
					remove_province_modifier = halfling_minority_integrated_large
					add_province_modifier = {
						name = halfling_minority_integrated_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				if = {
					limit = {
						has_province_modifier = gnomish_minority_oppressed_large
					}
					remove_province_modifier = gnomish_minority_oppressed_large
					add_province_modifier = {
						name = gnomish_minority_oppressed_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = gnomish_minority_coexisting_large
					}
					remove_province_modifier = gnomish_minority_coexisting_large
					add_province_modifier = {
						name = gnomish_minority_coexisting_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = gnomish_minority_integrated_large
					}
					remove_province_modifier = gnomish_minority_integrated_large
					add_province_modifier = {
						name = gnomish_minority_integrated_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				if = {
					limit = {
						has_province_modifier = half_orcish_minority_oppressed_large
					}
					remove_province_modifier = half_orcish_minority_oppressed_large
					add_province_modifier = {
						name = half_orcish_minority_oppressed_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = half_orcish_minority_coexisting_large
					}
					remove_province_modifier = half_orcish_minority_coexisting_large
					add_province_modifier = {
						name = half_orcish_minority_coexisting_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = half_orcish_minority_integrated_large
					}
					remove_province_modifier = half_orcish_minority_integrated_large
					add_province_modifier = {
						name = half_orcish_minority_integrated_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				if = {
					limit = {
						has_province_modifier = human_minority_oppressed_large
					}
					remove_province_modifier = human_minority_oppressed_large
					add_province_modifier = {
						name = human_minority_oppressed_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = human_minority_coexisting_large
					}
					remove_province_modifier = human_minority_coexisting_large
					add_province_modifier = {
						name = human_minority_coexisting_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = human_minority_integrated_large
					}
					remove_province_modifier = human_minority_integrated_large
					add_province_modifier = {
						name = human_minority_integrated_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				if = {
					limit = {
						has_province_modifier = gnollish_minority_oppressed_large
					}
					remove_province_modifier = gnollish_minority_oppressed_large
					add_province_modifier = {
						name = gnollish_minority_oppressed_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = gnollish_minority_coexisting_large
					}
					remove_province_modifier = gnollish_minority_coexisting_large
					add_province_modifier = {
						name = gnollish_minority_coexisting_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = gnollish_minority_integrated_large
					}
					remove_province_modifier = gnollish_minority_integrated_large
					add_province_modifier = {
						name = gnollish_minority_integrated_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				if = {
					limit = {
						has_province_modifier = ruinborn_minority_oppressed_large
					}
					remove_province_modifier = ruinborn_minority_oppressed_large
					add_province_modifier = {
						name = ruinborn_minority_oppressed_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = ruinborn_minority_coexisting_large
					}
					remove_province_modifier = ruinborn_minority_coexisting_large
					add_province_modifier = {
						name = ruinborn_minority_coexisting_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = ruinborn_minority_integrated_large
					}
					remove_province_modifier = ruinborn_minority_integrated_large
					add_province_modifier = {
						name = ruinborn_minority_integrated_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				if = {
					limit = {
						has_province_modifier = harpy_minority_oppressed_large
					}
					remove_province_modifier = harpy_minority_oppressed_large
					add_province_modifier = {
						name = harpy_minority_oppressed_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = harpy_minority_coexisting_large
					}
					remove_province_modifier = harpy_minority_coexisting_large
					add_province_modifier = {
						name = harpy_minority_coexisting_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = harpy_minority_integrated_large
					}
					remove_province_modifier = harpy_minority_integrated_large
					add_province_modifier = {
						name = harpy_minority_integrated_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				if = {
					limit = {
						has_province_modifier = troll_minority_oppressed_large
					}
					remove_province_modifier = troll_minority_oppressed_large
					add_province_modifier = {
						name = troll_minority_oppressed_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = troll_minority_coexisting_large
					}
					remove_province_modifier = troll_minority_coexisting_large
					add_province_modifier = {
						name = troll_minority_coexisting_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = troll_minority_integrated_large
					}
					remove_province_modifier = troll_minority_integrated_large
					add_province_modifier = {
						name = troll_minority_integrated_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				if = {
					limit = {
						has_province_modifier = half_elven_minority_oppressed_large
					}
					remove_province_modifier = half_elven_minority_oppressed_large
					add_province_modifier = {
						name = half_elven_minority_oppressed_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = half_elven_minority_coexisting_large
					}
					remove_province_modifier = half_elven_minority_coexisting_large
					add_province_modifier = {
						name = half_elven_minority_coexisting_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = half_elven_minority_integrated_large
					}
					remove_province_modifier = half_elven_minority_integrated_large
					add_province_modifier = {
						name = half_elven_minority_integrated_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				if = {
					limit = {
						has_province_modifier = ogre_minority_oppressed_large
					}
					remove_province_modifier = ogre_minority_oppressed_large
					add_province_modifier = {
						name = ogre_minority_oppressed_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = ogre_minority_coexisting_large
					}
					remove_province_modifier = ogre_minority_coexisting_large
					add_province_modifier = {
						name = ogre_minority_coexisting_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = ogre_minority_integrated_large
					}
					remove_province_modifier = ogre_minority_integrated_large
					add_province_modifier = {
						name = ogre_minority_integrated_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				if = {
					limit = {
						has_province_modifier = harimari_minority_oppressed_large
					}
					remove_province_modifier = harimari_minority_oppressed_large
					add_province_modifier = {
						name = harimari_minority_oppressed_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = harimari_minority_coexisting_large
					}
					remove_province_modifier = harimari_minority_coexisting_large
					add_province_modifier = {
						name = harimari_minority_coexisting_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = harimari_minority_integrated_large
					}
					remove_province_modifier = harimari_minority_integrated_large
					add_province_modifier = {
						name = harimari_minority_integrated_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				if = {
					limit = {
						has_province_modifier = centaur_minority_oppressed_large
					}
					remove_province_modifier = centaur_minority_oppressed_large
					add_province_modifier = {
						name = centaur_minority_oppressed_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = centaur_minority_coexisting_large
					}
					remove_province_modifier = centaur_minority_coexisting_large
					add_province_modifier = {
						name = centaur_minority_coexisting_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = centaur_minority_integrated_large
					}
					remove_province_modifier = centaur_minority_integrated_large
					add_province_modifier = {
						name = centaur_minority_integrated_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				if = {
					limit = {
						has_province_modifier = hobgoblin_minority_oppressed_large
					}
					remove_province_modifier = hobgoblin_minority_oppressed_large
					add_province_modifier = {
						name = hobgoblin_minority_oppressed_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = hobgoblin_minority_coexisting_large
					}
					remove_province_modifier = hobgoblin_minority_coexisting_large
					add_province_modifier = {
						name = hobgoblin_minority_coexisting_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
				else_if = {
					limit = {
						has_province_modifier = hobgoblin_minority_integrated_large
					}
					remove_province_modifier = hobgoblin_minority_integrated_large
					add_province_modifier = {
						name = hobgoblin_minority_integrated_small
						duration = -1
					}
					add_base_tax = -1
					add_base_manpower = -1
				}
			}
	}
}