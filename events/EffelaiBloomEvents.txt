#Funny Effelai Events

namespace = effelai_bloom

#Dormant Intro Event
country_event = {
	id = effelai_bloom.1
	title = effelai_bloom.1.t
	desc = effelai_bloom.1.d
	
	is_triggered_only = yes
	
	trigger = {
		any_owned_province = {
			OR = {
				has_province_modifier = effelai_roots_dormant
				has_province_modifier = effelai_hub_dormant
			}
		}
	}
	
	#Just an Intro "ok"
	option = {
		name = effelai_bloom.1.a
		
	}
}
#Effelai Blooming Event
country_event = {
	id = effelai_bloom.2
	title = effelai_bloom.2.t
	desc = effelai_bloom.2.d
	
	is_triggered_only = yes
	
	trigger = {
		
	}
	
	hidden = yes
	
	immediate = {
		effelai_superregion = {
			if = {
				limit = {
					has_province_modifier = effelai_roots_dormant
				}
				remove_province_modifier = effelai_roots_dormant
				add_permanent_province_modifier = {
					name = effelai_roots_blooming
					duration = -1
				}
			}
			else_if = {
				limit = {
					has_province_modifier = effelai_hub_dormant
				}
				remove_province_modifier = effelai_hub_dormant
				add_permanent_province_modifier = {
					name = effelai_hub_blooming
					duration = -1
				}
			}
		}
		set_global_flag = effelai_blooming_happening
		#For tags with their capital in the Effelai - And not colonies
		every_country = {
			if = {
				limit = {
					AND = {
						is_subject = no 
						capital_scope = {
							superregion = effelai_superregion
						}
						any_owned_province = {
							OR = {
								has_province_modifier = effelai_hub_blooming
								has_province_modifier = effelai_roots_blooming
								has_province_modifier = effelai_hub_burned
								has_province_modifier = effelai_roots_burned
							}
						}
					}
				}
				add_country_modifier = {
					name = effelai_bloom_in_progress
					duration = -1
				}
				country_event = {
					id = effelai_bloom.3
					days = 180
				}
			}
			#Colonial Nation Check
			else_if = {
				limit = {
					is_subject = yes
					overlord = {
						NOT = {
							ai = no
						}
					}

					capital_scope = {
						superregion = effelai_superregion
					}
					
					any_owned_province = {
						OR = {
							has_province_modifier = effelai_hub_blooming
							has_province_modifier = effelai_roots_blooming
							has_province_modifier = effelai_hub_burned
							has_province_modifier = effelai_roots_burned
						}
					}
				}
				add_country_modifier = {
					name = effelai_bloom_in_progress
					duration = -1
				}
				country_event = {
					id = effelai_bloom.6
					days = 180
				}
			}
			#Non-Colonial Nation Check
			else_if = {
				limit = {
					AND = {
						is_subject = no 
						NOT = {
							capital_scope = {
								superregion = effelai_superregion
							}
						}
						NOT = {
							OR = {
								has_subject_of_type = colony
								has_subject_of_type = crown_colony
								has_subject_of_type = private_enterprise
								has_subject_of_type = self_governing_colony
							}
						}
						any_owned_province = {
							OR = {
								has_province_modifier = effelai_hub_blooming
								has_province_modifier = effelai_roots_blooming
								has_province_modifier = effelai_hub_burned
								has_province_modifier = effelai_roots_burned
							}
						}
					}
				}
				add_country_modifier = {
					name = effelai_bloom_in_progress
					duration = -1
				}
				country_event = {
					id = effelai_bloom.6
					days = 180
				}
			}
			#Colonial Overlord Event - Is Player
			else_if = {
				limit = {
					ai = no
					is_subject = no 
					NOT = {
						capital_scope = {
							superregion = effelai_superregion
						}
					}
					
					OR = {
						has_subject_of_type = colony
						has_subject_of_type = crown_colony
						has_subject_of_type = private_enterprise
						has_subject_of_type = self_governing_colony
					}

					any_subject_country = {
						any_owned_province = {
							OR = {
								has_province_modifier = effelai_hub_blooming
								has_province_modifier = effelai_roots_blooming
								has_province_modifier = effelai_hub_burned
								has_province_modifier = effelai_roots_burned
							}
						}
					}
				}
				country_event = {
					id = effelai_bloom.5
					days = 365
				}
				if = {
					limit = {
						any_owned_province = {
							OR = {
								has_province_modifier = effelai_hub_blooming
								has_province_modifier = effelai_roots_blooming
								has_province_modifier = effelai_hub_burned
								has_province_modifier = effelai_roots_burned
							}
						}
					}
					country_event = {
						id = effelai_bloom.6
						days = 180
					}
				}
			}
		}
		1804 = {
			add_province_triggered_modifier = effelai_bloom_pulse_province_modifier
		}
	}
	
	
	#Very bad moment
	option = {
		name = effelai_bloom.2.a
		
	}
}

#Effelai Blooming Regular Choice Event
country_event = {
	id = effelai_bloom.3
	title = effelai_bloom.3.t
	desc = effelai_bloom.3.d
	
	is_triggered_only = yes
	
	trigger = {
	
	}
	
	#Attuned Path
	option = {
		name = effelai_bloom.3.a
		
		add_country_modifier = {
			name = effelai_attuning_path
			duration = -1
		}
	}
	
	#Burned Path
	option = {
		name = effelai_bloom.3.b
		
		add_country_modifier = {
			name = effelai_burned_path
			duration = -1
		}
	}
}
#Effelai Blooming Native Self Trigger
country_event = {
	id = effelai_bloom.4
	title = effelai_bloom.4.t
	desc = effelai_bloom.4.d
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			religion = senanset
			religion = song_servants
			religion = chahinanito
			religion = tswohvwohii
		}
	}
	
	#Attuned Path
	option = {
		name = effelai_bloom.4.a
		ai_chance = {
			factor = 20
		}
		
		add_country_modifier = {
			name = effelai_attuning_path
			duration = -1
		}
	}
	
	#Burned Path
	option = {
		name = effelai_bloom.4.b
		ai_chance = {
			factor = 80
		}
		
		add_country_modifier = {
			name = effelai_burned_path
			duration = -1
		}
	}
}
#Effelai Bloom Info Event(Overlord Picks Path for colony)
country_event = {
	id = effelai_bloom.5
	title = effelai_bloom.5.t
	desc = effelai_bloom.5.d
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = effelai_blooming_happening
		}
	}
	
	#Attuned Path
	option = {
		name = effelai_bloom.5.a
		ai_chance = {
			factor = 20
		}
		
		every_subject_country = {
			limit = {
				has_effelai_network_province = yes
			}
			add_country_modifier = {
				name = effelai_attuning_path
				duration = -1
			}
		}
	}
	
	#Burned Path
	option = {
		name = effelai_bloom.5.b
		ai_chance = {
			factor = 80
		}
		
		every_subject_country = {
			limit = {
				has_effelai_network_province = yes
			}
			add_country_modifier = {
				name = effelai_burned_path
				duration = -1
			}
		}
	}
}
#Effelai Bloom Info Event(Bypass)
country_event = {
	id = effelai_bloom.6
	title = effelai_bloom.6.t
	desc = effelai_bloom.6.d
	
	is_triggered_only = yes
	
	trigger = {
		
	}
	
	#Ignore the system option
	option = {
		name = effelai_bloom.6.a
		
		add_stability = -1
		set_country_flag = effelai_ignore_blooming_bypass
	}
}