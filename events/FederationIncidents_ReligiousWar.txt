
namespace = fed_religious

#Disaster - Religious War
country_event = {
	id = fed_religious.1
	title = fed_religious.1.t
	desc = fed_religious.1.d
	picture = FORT_eventPicture
	
	mean_time_to_happen = {
		years = 7
	}
	
	hidden = yes
	fire_only_once = yes
	
	trigger = {
		has_country_modifier = lake_federation_member
		NOT = { has_global_flag = federation_crisis }
		NOT = { has_global_flag = federation_crisis_religious }
		NOT = { has_global_flag = lake_federation_disbanded }
		had_global_flag = {
			flag = last_federation_crisis
			days = 7300
		}
	}
	
	immediate = {
		hidden_effect = { set_global_flag = federation_crisis_religious }
		hidden_effect = { set_global_flag = federation_crisis }
		hidden_effect = { REB = { set_variable = { FedWar = 0 } } }
	}
	
	option = {
		name = fed_religious.1.a
		ai_chance = { factor = 50 }
		country_event = { id = fed_religious.2 }
		country_event = { id = fed_religious.4 days = 720 }
		every_known_country = {
			limit = { has_country_modifier = lake_federation_member is_vassal = no }
			country_event = { id = fed_religious.2 }
			country_event = { id = fed_religious.4 days = 720 }
		}
	}
}

#The Dispute - A Kodave Oracle saw that Enuuk is trying to undermine Kodave
country_event = {
	id = fed_religious.2
	title = fed_religious.2.t
	desc = fed_religious.2.d
	picture = FORT_eventPicture
	
	
	is_triggered_only = yes
	
	trigger = {
		has_country_modifier = lake_federation_member
	}
	
	#Kodave
	option = {
		name = fed_religious.2.a
		ai_chance = { factor = 50 }
		trigger = { religion = kodave_followers }
		hidden_effect = { set_country_flag = kodave_faction }
		add_prestige = 5
		country_event = { id = fed_religious.3 days = 365 }
	}
	#Yukel
	option = {
		name = fed_religious.2.b
		ai_chance = { factor = 50 }
		trigger = { religion = yukel_followers }
		hidden_effect = { set_country_flag = yukel_faction }
		add_prestige = 5
		country_event = { id = fed_religious.3 days = 365 }
	}
	#Enuuk
	option = {
		name = fed_religious.2.c
		ai_chance = { factor = 50 }
		trigger = { religion = enuuk_followers }
		hidden_effect = { set_country_flag = enuuk_faction }
		add_prestige = 5
		country_event = { id = fed_religious.3 days = 365 }
	}
}

#Settling the dispute, cities and religious entities organize a reunion
country_event = {
	id = fed_religious.3
	title = fed_religious.3.t
	desc = fed_religious.3.d
	picture = FORT_eventPicture
	
	
	is_triggered_only = yes
	
	trigger = {
		has_country_modifier = lake_federation_member
	}
	
	#The highest standing member of it's faction will be selected as representative
	option = {
		name = fed_religious.3.a
		ai_chance = { factor = 50 }
	}
}

#Choosing the representative
country_event = {
	id = fed_religious.4
	title = fed_religious.4.t
	desc = fed_religious.4.d
	picture = FORT_eventPicture
	
	
	is_triggered_only = yes
	fire_only_once = yes
	hidden = yes
	
	trigger = {
		always = yes
	}
	
	option = {
		name = fed_religious.4.a
		ai_chance = { factor = 50 }
		federation_representative_setup = yes #That's a beefy effects
		random_country = {
			limit = { has_country_flag = kodave_leader }
			country_event = { id = fed_religious.5 }
		}
		random_country = {
			limit = { has_country_flag = enuuk_leader }
			country_event = { id = fed_religious.5 }
		}
		random_country = {
			limit = { has_country_flag = yukel_leader }
			country_event = { id = fed_religious.5 }
		}
		REB = { set_variable = { nbFedLeader = 0 } }
	}
}

#We have been selected as representative of our faction
country_event = {
	id = fed_religious.5
	title = fed_religious.5.t
	desc = fed_religious.5.d
	picture = FORT_eventPicture
	
	
	is_triggered_only = yes
	
	trigger = {
		has_country_modifier = lake_federation_member
	}
	
	option = {
		name = fed_religious.5.a
		ai_chance = { factor = 50 }
		add_prestige = 5
		lake_federation_gain_1_points = yes
		hidden_effect = { REB = { change_variable = { nbFedLeader = 1 } } }
	}
}

#All representative are selected
country_event = {
	id = fed_religious.6
	title = fed_religious.6.t
	desc = fed_religious.6.d
	picture = FORT_eventPicture
	
	
	fire_only_once = yes
	hidden = yes
	mean_time_to_happen = {
		years = 2
	}
	
	trigger = {
		has_country_modifier = lake_federation_member
		REB = { check_variable = { nbFedLeader = 3 } }
	}
	
	immediate = {
		random_known_country = {
			limit = {
				has_country_modifier = lake_federation_member
				NOT = {
					has_country_flag = kodave_leader
					has_country_flag = yukel_leader
					has_country_flag = enuuk_leader
				}
			}
			save_event_target_as = targetCountry
		}
		random_known_country = {
			limit = {
				has_country_modifier = lake_federation_member
				NOT = {
					has_country_flag = kodave_leader
					has_country_flag = yukel_leader
					has_country_flag = enuuk_leader
				}
				ai = no
			}
			save_event_target_as = targetCountry
		}
	}
	
	option = {
		name = fed_religious.6.a
		ai_chance = { factor = 50 }
		every_known_country = {
			limit = { has_country_modifier = lake_federation_member }
			country_event = { id = fed_religious.7 }
		}
		event_target:targetCountry = { country_event = { id = fed_religious.8 days = 200 random = 165 } }
	}
}

#All representative are selected
country_event = {
	id = fed_religious.7
	title = fed_religious.7.t
	desc = fed_religious.7.d
	picture = FORT_eventPicture
	
	
	is_triggered_only = yes
	
	trigger = {
		has_country_modifier = lake_federation_member
	}
	
	immediate = {
		#For Loca
		random_known_country = {
			limit = { has_country_flag = kodave_leader }
			save_event_target_as = kodaveLeader
		}
		random_known_country = {
			limit = { has_country_flag = yukel_leader }
			save_event_target_as = yukelLeader
		}
		random_known_country = {
			limit = { has_country_flag = enuuk_leader }
			save_event_target_as = enuukLeader
		}
	}
	#They will now send a delegation toward 5276 to quickly resolve the matter
	option = {
		name = fed_religious.7.a
		ai_chance = { factor = 50 }
	}
}

#Assassination attempt of the Enuuk delegation
country_event = {
	id = fed_religious.8
	title = fed_religious.8.t
	desc = fed_religious.8.d
	picture = FORT_eventPicture
	
	
	is_triggered_only = yes
	
	trigger = {
		has_country_modifier = lake_federation_member
	}
	
	#Kill the delegation
	option = {
		name = fed_religious.8.a
		ai_chance = { 
			factor = 20
			modifier = {
				factor = 100
				ruler_has_personality = malevolent_personality
			}
		}
		random_known_country = {
			limit = { has_country_flag = enuuk_leader }
			country_event = { id = fed_religious.9 days = 125 random = 100 }
		}
	}
	
	#Don't
	option = {
		name = fed_religious.8.a
		ai_chance = { factor = 80 }
	}
}
# The Great Betrayal - Our Delegation and Head Priest has been assassinated!
country_event = {
	id = fed_religious.9
	title = fed_religious.9.t
	desc = fed_religious.9.d
	picture = FORT_eventPicture
	
	
	is_triggered_only = yes
	major = yes
	
	trigger = {
		has_country_flag = enuuk_leader
	}
	
	#The Kodave followers wanted only one thing : War!
	option = {
		name = fed_religious.9.a
		ai_chance = {  factor = 100 } }
		every_known_country = {
			limit = { has_country_flag = enuuk_faction }
			country_event = { id = fed_religious.10 days = 10 random = 20 } #They killed our faction delegation
		}
		every_known_country = {
			limit = { has_country_flag = kodave_faction }
			country_event = { id = fed_religious.11 days = 30 random = 10 } #Preposterous Accusations
		}
		every_known_country = {
			limit = { has_country_flag = yukel_faction }
			country_event = { id = fed_religious.12 days = 40 random = 30 } #Any hope of reconciliation vanished
		}
		country_event = { id = fed_religious.14 days = 150 }
		hidden_effect = {
			every_known_country = {
				limit = { OR = { has_country_flag = enuuk_faction has_country_flag = kodave_faction } }
				country_event = { id = fed_religious.13 days = 90 random = 30 }
			}
			country_event = { id = fed_religious.13 days = 90 random = 30 }
		}
	}
}

#They killed our faction delegation
country_event = {
	id = fed_religious.10
	title = fed_religious.10.t
	desc = fed_religious.10.d
	picture = FORT_eventPicture
	
	
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = enuuk_faction
	}
	
	#The Kodave followers wanted only one thing : War!
	option = {
		name = fed_religious.10.a
		ai_chance = {  factor = 100 }
		
	}
}


#Preposterous Accusations
country_event = {
	id = fed_religious.11
	title = fed_religious.11.t
	desc = fed_religious.11.d
	picture = FORT_eventPicture
	
	
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = kodave_faction
	}
	
	#They are framing us!
	option = {
		name = fed_religious.11.a
		ai_chance = {  factor = 100 }
		
	}
}

#Any hope of reconciliation vanished
country_event = {
	id = fed_religious.12
	title = fed_religious.12.t
	desc = fed_religious.12.d
	picture = FORT_eventPicture
	
	
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = yukel_faction
	}
	
	#They are framing us!
	option = {
		name = fed_religious.12.a
		ai_chance = {  factor = 100 }
		
	}
}

#The Trumpet of War, gearing up
country_event = {
	id = fed_religious.13
	title = fed_religious.13.t
	desc = fed_religious.13.d
	picture = FORT_eventPicture
	
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	#We will strike them fast and hard
	option = {
		name = fed_religious.13.a
		ai_chance = { 
			factor = 100
			modifier = {
				factor = 5
				has_country_flag = kodave_faction
			}
		}
		add_country_modifier = {
			name = lake_strike_hard
			duration = -1
		}
	}
	
	#We will slowly drain them out
	option = {
		name = fed_religious.13.a
		ai_chance = { 
			factor = 100
			modifier = {
				factor = 5
				has_country_flag = enuuk_faction
			}
		}
		add_country_modifier = {
			name = lake_attrition_war
			duration = -1
		}
	}
}

#Enuuk followers, unite
country_event = {
	id = fed_religious.14
	title = fed_religious.14.t
	desc = fed_religious.14.d
	picture = FORT_eventPicture
	
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
		hidden_effect = {
			random_known_country = {
				limit = { has_country_flag = kodave_leader }
				save_event_target_as = kodaveLeader
			}
			ROOT = {
				limit = { has_country_flag = enuuk_leader }
				save_event_target_as = enuukLeader
			}
			random_known_country = {
				limit = { has_country_flag = yukel_leader }
				save_event_target_as = yukelLeader
			}
		}
	}
	
	option = {
		name = fed_religious.14.a
		ai_chance = { factor = 100 }
		custom_tooltip = enuuk_religious_war_tooltip
		hidden_effect = {
			form_coalition_against = event_target:kodaveLeader
			every_known_country = {
				limit = { has_country_flag = enuuk_faction }
				form_coalition_against = event_target:kodaveLeader
			}
			every_known_country = {
				limit = { has_country_flag = kodave_faction }
				create_guarantee = event_target:kodaveLeader
			}
			declare_war_with_cb = {
				who = event_target:kodaveLeader
				casus_belli = cb_federation_religious_war
			}
			##
			event_target:kodaveLeader = {
				form_coalition_against = event_target:yukelLeader
				every_known_country = {
					limit = { has_country_flag = kodave_faction }
					form_coalition_against = event_target:yukelLeader
				}
				every_known_country = {
					limit = { has_country_flag = yukel_faction }
					create_guarantee = event_target:yukelLeader
				}
				declare_war_with_cb = {
					who = event_target:yukelLeader
					casus_belli = cb_federation_religious_war
				}
			}
			##
			event_target:yukelLeader = {
				form_coalition_against = event_target:enuukLeader
				every_known_country = {
					limit = { has_country_flag = yukel_faction }
					form_coalition_against = event_target:enuukLeader
				}
				every_known_country = {
					limit = { has_country_flag = enuuk_faction }
					create_guarantee = event_target:enuukLeader
				}
				declare_war_with_cb = {
					who = event_target:enuukLeader
					casus_belli = cb_federation_religious_war
				}
			}
		}
	}
}

#Victory on our enemy!
country_event = {
	id = fed_religious.15
	title = fed_religious.15.t
	desc = fed_religious.15.d
	picture = FORT_eventPicture
	
	
	is_triggered_only = yes
	fire_only_once = yes
	
	trigger = {
		has_country_flag = FedWar_1
	}
	
	option = {
		name = fed_religious.15.a
		ai_chance = {  factor = 100 }
		
	}
}


