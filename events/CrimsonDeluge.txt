namespace = deluge 

# Random events to happen during the Crimson Deluge

# Hard Rain on palace, lose or gain legitimacy
country_event = {
	id = deluge.1
	title = deluge.1.t
	desc = deluge.1.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		religion_group = cannorian
		has_global_flag = crimson_deluge_is_actively_happening
		capital_scope = {
			OR = {
				region = alenic_frontier_region
				region = forlorn_vale_region
				region = esmaria_region
				region = east_dameshead_region
				region = the_borders_region
				superregion = escann_superregion
			}
		}
		OR = {
			government = monarchy
			government = theocracy
			government = tribal
			government = republic
		}
	}
	
	mean_time_to_happen = {
		months = 70
		modifier = {
			factor = 0.8
			capital_scope = {
				region = west_castanor_region
				region = inner_castanor_region
				region = south_castanor_region
				region = the_borders_region
			}
		}
	}

	#Adeanic
	option = {
		name = "deluge.1.a"
		trigger = {
			religion = regent_court
		}
		add_legitimacy = -5
		add_devotion = -5
	}
	#Corinite
	option = {
		name = "deluge.1.b"
		trigger = {
			religion = corinite
		}
		add_legitimacy = 5
		add_devotion = 5
		add_republican_tradition = 2
	}
	#Other
	#option = { they wouldn't care. Just hard rain no big significance
	#	name = "deluge.1.c"
	#	trigger = {
	#		NOT = { religion_group = cannorian }
	#	}
	#}
}

# Particularly strong rain causes devastation
province_event = {
	id = deluge.2
	title = deluge.2.t
	desc = deluge.2.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		has_global_flag = crimson_deluge_is_actively_happening
		OR = {
			region = alenic_frontier_region
			region = forlorn_vale_region
			region = esmaria_region
			region = east_dameshead_region
			region = the_borders_region
			superregion = escann_superregion
		}
	}
	
	mean_time_to_happen = {
		months = 40
		modifier = {
			factor = 0.8
			region = west_castanor_region
			region = inner_castanor_region
			region = south_castanor_region
			region = the_borders_region
		}
	}

	immediate = {
		add_devastation = 10
		hidden_effect = {
			save_event_target_as = rain_target
		}
	}
	
	goto = rain_target

	#Adeanic
	option = {
		name = "deluge.2.a"
		trigger = {
			owner = { religion = regent_court }
		}
	}
	#Corinite
	option = {
		name = "deluge.2.b"
		trigger = {
			owner = { religion = corinite }
		}
	}
	#Other
	option = {
		name = "deluge.2.c"
		trigger = {
			owner = { NOT = { religion_group = cannorian } }
		}
	}
}

# Flagellants cause unrest
province_event = {
	id = deluge.3
	title = deluge.3.t
	desc = deluge.3.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		has_global_flag = crimson_deluge_is_actively_happening
		OR = {
			region = alenic_frontier_region
			region = forlorn_vale_region
			region = esmaria_region
			region = east_dameshead_region
			region = the_borders_region
			superregion = escann_superregion
		}
	}
	
	mean_time_to_happen = {
		months = 150
		modifier = {
			factor = 0.8
			region = west_castanor_region
			region = inner_castanor_region
			region = south_castanor_region
			region = the_borders_region
		}
		modifier = {
			factor = 2
			NOT = { religion_group = cannorian }
		}
	}

	immediate = {
		add_unrest = 3
		hidden_effect = {
			save_event_target_as = flagellants
		}
	}
	
	goto = flagellants

	#Adeanic
	option = {
		name = "deluge.3.a"
		trigger = {
			owner = { religion = regent_court }
		}
	}
	#Corinite
	option = {
		name = "deluge.3.b"
		trigger = {
			owner = { religion = corinite }
		}
	}
	#Other
	option = {
		name = "deluge.3.c"
		trigger = {
			owner = { NOT = { religion_group = cannorian } }
		}
	}
}

# Province converts to corinite
province_event = {
	id = deluge.4
	title = deluge.4.t
	desc = deluge.4.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		has_global_flag = crimson_deluge_is_actively_happening
		OR = {
			region = alenic_frontier_region
			region = forlorn_vale_region
			region = esmaria_region
			region = east_dameshead_region
			region = the_borders_region
			superregion = escann_superregion
		}
		NOT = { religion = corinite }
	}
	
	mean_time_to_happen = {
		months = 360
		modifier = {
			factor = 0.8
			region = west_castanor_region
			region = inner_castanor_region
			region = south_castanor_region
			region = the_borders_region
		}
		modifier = {
			factor = 2
			region = alenic_frontier_region
		}
		modifier = {
			factor = 3
			NOT = { religion_group = cannorian }
		}
		modifier = {
			factor = 4
			OR = {
				culture_group = elven
				culture_group = gnomish
			}
		}
		modifier = {
			factor = 2
			OR = {
				culture_group = lencori
				culture = crownsman
				culture = esmari
			}
		}
		modifier = {
			factor = 0.77
			OR = {
				culture = vernman	#Heroic cultures
				culture = derannic
				culture = arbarani
				culture_group = alenic
			}
		}
	}

	immediate = {
		change_religion = corinite
		hidden_effect = {
			save_event_target_as = converted_to_corinite
		}
	}
	
	goto = converted_to_corinite

	#Adeanic
	option = {
		name = "deluge.4.a"
		trigger = {
			owner = { religion = regent_court }
		}
	}
	#Corinite
	option = {
		name = "deluge.4.b"
		trigger = {
			owner = { religion = corinite }
		}
	}
	#Other
	option = {
		name = "deluge.4.c"
		trigger = {
			owner = { NOT = { religion_group = cannorian } }
		}
	}
}

# heir converts to corinite
country_event = {
	id = deluge.5
	title = deluge.5.t
	desc = deluge.5.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		has_global_flag = crimson_deluge_is_actively_happening
		capital_scope = {
			OR = {
				region = alenic_frontier_region
				region = forlorn_vale_region
				region = esmaria_region
				region = east_dameshead_region
				region = the_borders_region
				superregion = escann_superregion
			}
		}
		has_heir = yes
		NOT = { heir_religion = corinite }
		NOT = { religion = corinite }
	}
	
	mean_time_to_happen = {
		months = 150
		modifier = {
			factor = 0.8
			capital_scope = {
				region = west_castanor_region
				region = inner_castanor_region
				region = south_castanor_region
				region = the_borders_region
			}
		}
		modifier = {
			factor = 3
			NOT = { religion_group = cannorian }
		}
		modifier = {
			factor = 4
			OR = {
				heir_culture = moon_elf
				heir_culture = wood_elf
				heir_culture = sun_elf
				heir_culture = imperial_gnome
			}
		}
		modifier = {
			factor = 2
			OR = {
				heir_culture = high_lorentish
				heir_culture = low_lorentish
				heir_culture = sorncosti
				heir_culture = roilsardi
				heir_culture = crownsman
				heir_culture = esmari
			}
		}
		modifier = {
			factor = 0.5
			has_personal_deity = corin
		}
		modifier = {
			factor = 10
			has_personal_deity = adean
		}
		modifier = {
			factor = 5
			has_personal_deity = ara
		}
		modifier = {
			factor = 0.77
			OR = {
				heir_culture = vernman	#Heroic cultures
				heir_culture = arbarani
			}
		}
	}
	
	immediate = {
		set_heir_religion = corinite
	}

	#Adeanic
	option = {
		name = "deluge.5.a"
		trigger = {
			religion = regent_court
		}
		add_prestige = -10
		add_legitimacy = -10
	}
	#Adeanic Disinherit
	option = {
		name = "deluge.5.b"
		trigger = {
			religion = regent_court
		}
		add_prestige = -60
		add_legitimacy = -10
		remove_heir = yes
	}
	#Other
	option = {
		name = "deluge.5.c"
		trigger = {
			NOT = { religion_group = cannorian }
		}
		add_prestige = -10
		add_legitimacy = -10
	}
	#Other Disinherit
	option = {
		name = "deluge.5.e"
		trigger = {
			NOT = { religion_group = cannorian }
		}
		add_prestige = -60
		add_legitimacy = -10
		remove_heir = yes
	}
}

# consort converts to corinite
country_event = {
	id = deluge.6
	title = deluge.6.t
	desc = deluge.6.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		has_global_flag = crimson_deluge_is_actively_happening
		capital_scope = {
			OR = {
				region = alenic_frontier_region
				region = forlorn_vale_region
				region = esmaria_region
				region = east_dameshead_region
				region = the_borders_region
				superregion = escann_superregion
			}
		}
		has_consort = yes
		NOT = { consort_religion = corinite }
		NOT = { religion = corinite }
	}
	
	mean_time_to_happen = {
		months = 150
		modifier = {
			factor = 0.8
			capital_scope = {
				region = west_castanor_region
				region = inner_castanor_region
				region = south_castanor_region
				region = the_borders_region
			}
		}
		modifier = {
			factor = 3
			NOT = { religion_group = cannorian }
		}
		modifier = {
			factor = 4
			OR = {
				consort_culture = moon_elf
				consort_culture = wood_elf
				consort_culture = sun_elf
				consort_culture = imperial_gnome
			}
		}
		modifier = {
			factor = 2
			OR = {
				consort_culture = high_lorentish
				consort_culture = low_lorentish
				consort_culture = sorncosti
				consort_culture = roilsardi
				consort_culture = crownsman
				consort_culture = esmari
			}
		}
		modifier = {
			factor = 0.5
			has_personal_deity = corin
		}
		modifier = {
			factor = 10
			has_personal_deity = adean
		}
		modifier = {
			factor = 5
			has_personal_deity = ara
		}
		modifier = {
			factor = 0.77
			OR = {
				consort_culture = vernman	#Heroic cultures
				consort_culture = arbarani
			}
		}
	}
	
	immediate = {
		set_consort_religion = corinite
	}

	#Adeanic
	option = {
		name = "deluge.6.a"
		trigger = {
			religion = regent_court
		}
		add_prestige = -10
		add_legitimacy = -10
	}
	#Adeanic Divorce
	option = {
		name = "deluge.6.b"
		trigger = {
			religion = regent_court
		}
		add_prestige = -10
		add_legitimacy = -10
		remove_consort = yes
	}
	#Corinite
	#option = {
	#	name = "deluge.6.b"
	#	trigger = {
	#		religion = corinite
	#	}
	#}
	#Other
	option = {
		name = "deluge.6.c"
		trigger = {
			NOT = { religion_group = cannorian }
		}
		add_prestige = -10
		add_legitimacy = -10
	}
	#Other Divorce
	option = {
		name = "deluge.6.e"
		trigger = {
			NOT = { religion_group = cannorian }
		}
		add_prestige = -10
		add_legitimacy = -10
		remove_consort = yes
	}
}

# ruler converts to corinite
country_event = {
	id = deluge.7
	title = deluge.7.t
	desc = deluge.7.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		has_global_flag = crimson_deluge_is_actively_happening
		capital_scope = {
			OR = {
				region = alenic_frontier_region
				region = forlorn_vale_region
				region = esmaria_region
				region = east_dameshead_region
				region = the_borders_region
				superregion = escann_superregion
			}
		}
		has_ruler = yes
		NOT = { ruler_religion = corinite }
	}
	
	mean_time_to_happen = {
		months = 150
		modifier = {
			factor = 0.8
			capital_scope = {
				region = west_castanor_region
				region = inner_castanor_region
				region = south_castanor_region
				region = the_borders_region
			}
		}
		modifier = {
			factor = 4
			NOT = { religion_group = cannorian }
		}
		modifier = {
			factor = 4
			OR = {
				ruler_culture = moon_elf
				ruler_culture = wood_elf
				ruler_culture = sun_elf
				ruler_culture = imperial_gnome
			}
		}
		modifier = {
			factor = 2
			OR = {
				ruler_culture = high_lorentish
				ruler_culture = low_lorentish
				ruler_culture = sorncosti
				ruler_culture = roilsardi
				ruler_culture = crownsman
				ruler_culture = esmari
			}
		}
		modifier = {
			factor = 0.5
			has_personal_deity = corin
		}
		modifier = {
			factor = 10
			has_personal_deity = adean
		}
		modifier = {
			factor = 5
			has_personal_deity = ara
		}
		modifier = {
			factor = 3
			ruler_has_personality = zealot_personality
		}
		modifier = {
			factor = 0.77
			OR = {
				ruler_culture = vernman	#Heroic cultures
				ruler_culture = arbarani
			}
		}
	}
	
	immediate = {
		set_ruler_religion = corinite
	}

	#Adeanic
	option = {
		ai_chance = {
			factor = 70
			modifier = {
				factor = 10
				has_personal_deity = adean
			}
			modifier = {
				factor = 5
				has_personal_deity = ara	#Adean's wife
			}
			modifier = {
				factor = 0.5
				ruler_has_personality = zealot_personality
			}
			modifier = {
				factor = 1.5
				OR = {
					capital_scope = { region = lencenor_region }
					capital_scope = { region = west_dameshead_region }
					capital_scope = { region = small_country_region }
					capital_scope = { region = dragon_coast_region }
					capital_scope = { region = damescrown_region }
					capital_scope = { region = esmaria_region }
				}
			}
		}
		name = "deluge.7.a"
		trigger = {
			religion = regent_court
		}
		add_prestige = -5
		add_legitimacy = -10
		add_devotion = -10
		reduce_stability_or_adm_power = yes
	}
	#Adeanic and convert
	option = {
		name = "deluge.7.b"
		trigger = {
			religion = regent_court
		}
		ai_chance = {
			factor = 30
			modifier = {
				factor = 5
				OR = {
					tag = B33	#Blademarches
					tag = B35	#Ancardia
					tag = A45	#Istralore
					tag = F16	#Ourdia
				}
			}
			modifier = {
				factor = 3
				OR = {
					capital_scope = { region = the_borders_region }			#heaviest rains here and also promoted HRE League War
					capital_scope = { region = east_dameshead_region }
				}
			}
			modifier = {
				factor = 3
				OR = {
					capital_scope = { region = west_castanor_region }
					capital_scope = { region = inner_castanor_region }
					capital_scope = { region = south_castanor_region }
					capital_scope = { region = the_borders_region }
				}
				OR = {
					NOT = { culture_group = orcish }
					NOT = { culture_group = goblin }
				}
			}
			modifier = {
				factor = 0.25
				OR = {
					culture_group = elven
					culture_group = gnomish
				}
			}
			modifier = {
				factor = 0.5
				OR = {
					culture_group = lencori
					primary_culture = crownsman
					primary_culture = esmari
				}
			}
			modifier = {
				factor = 1.3
				OR = {
					primary_culture = vernman	#Heroic cultures
					primary_culture = derannic
					primary_culture = arbarani
					culture_group = alenic
				}
			}
			modifier = {
				factor = 2
				personality = ai_militarist
			}
			modifier = {
				factor = 1.5
				NOT = { religious_unity = 0.5 }
			}
			modifier = {
				factor = 1.5
				NOT = { religious_unity = 0.7 }
			}
			modifier = {
				factor = 1.5
				NOT = { religious_unity = 0.9 }
			}
		}
		add_prestige = -50
		add_country_modifier = {
			name = "conversion_zeal"
			duration = 3650
		}
		change_religion = corinite
	}
	#Other
	option = {
		ai_chance = { factor = 80 }
		name = "deluge.7.c"
		trigger = {
			NOT = { religion_group = cannorian }
		}
		add_prestige = -15
		add_legitimacy = -10
		add_devotion = -15
		reduce_stability_or_adm_power = yes
	}
	#Other and convert
	option = {
		ai_chance = { 
			factor = 20
			modifier = {
				factor = 1.5
				NOT = { religious_unity = 0.5 }
			}
			modifier = {
				factor = 1.5
				NOT = { religious_unity = 0.7 }
			}
			modifier = {
				factor = 1.5
				NOT = { religious_unity = 0.9 }
			}
		}
		name = "deluge.7.e"
		trigger = {
			NOT = { religion_group = cannorian }
		}
		add_prestige = -50
		reduce_stability_or_adm_power = yes
		add_country_modifier = {
			name = "conversion_zeal"
			duration = 3650
		}
		change_religion = corinite
	}
}

# temple ransacked, -clergy loyalty or -money
province_event = {
	id = deluge.8
	title = deluge.8.t
	desc = deluge.8.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		has_global_flag = crimson_deluge_is_actively_happening
		OR = {
			region = alenic_frontier_region
			region = forlorn_vale_region
			region = esmaria_region
			region = east_dameshead_region
			region = the_borders_region
			superregion = escann_superregion
		}
	}
	
	mean_time_to_happen = {
		months = 75
		modifier = {
			factor = 0.8
			region = west_castanor_region
			region = inner_castanor_region
			region = south_castanor_region
			region = the_borders_region
		}
	}
	is_mtth_scaled_to_size = 1

	#Leave it
	option = {
		name = "deluge.8.a"
		add_estate_loyalty = {
			estate = estate_church
			loyalty = -4
		}
	}
	#Pay for repair
	option = {
		name = "deluge.8.b"
		add_treasury = -50
	}
}

#image of Corin found in blood :corin:
country_event = {
	id = deluge.9
	title = deluge.9.t
	desc = deluge.9.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		religion_group = cannorian
		has_global_flag = crimson_deluge_is_actively_happening
		capital_scope = {
			OR = {
				region = alenic_frontier_region
				region = forlorn_vale_region
				region = esmaria_region
				region = east_dameshead_region
				region = the_borders_region
				superregion = escann_superregion
			}
		}
		NOT = { has_country_modifier = icon_of_corin_good }
		NOT = { has_country_modifier = icon_of_corin_bad }
	}
	
	mean_time_to_happen = {
		months = 100
		modifier = {
			factor = 0.8
			capital_scope = {
				region = west_castanor_region
				region = inner_castanor_region
				region = south_castanor_region
				region = the_borders_region
			}
		}
	}

	#Adeanic
	option = {
		name = "deluge.9.a"
		trigger = {
			religion = regent_court
		}
		add_country_modifier = {
			name = icon_of_corin_bad
			duration = 3650 #10 years
		}
	}
	#Corinite
	option = {
		name = "deluge.9.b"
		trigger = {
			religion = corinite
		}
		add_country_modifier = {
			name = icon_of_corin_good
			duration = 3650 #10 years
		}
	}
	#Other
	#option = {
	#	name = "deluge.9.c"
	#	trigger = {
	#		NOT = { religion_group = cannorian }
	#	}
	#}
}

# Corinite Firebrand
province_event = {
	id = deluge.10
	title = deluge.10.t
	desc = deluge.10.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		has_global_flag = crimson_deluge_is_actively_happening
		OR = {
			region = alenic_frontier_region
			region = forlorn_vale_region
			region = esmaria_region
			region = east_dameshead_region
			region = the_borders_region
			superregion = escann_superregion
		}
	}
	
	mean_time_to_happen = {
		months = 150
		modifier = {
			factor = 0.8
			region = west_castanor_region
			region = inner_castanor_region
			region = south_castanor_region
			region = the_borders_region
		}
		modifier = {
			factor = 2
			NOT = { religion_group = cannorian }
		}
		modifier = {
			factor = 0.8
			religion = corinite
		}
	}

	immediate = {
		IF = {
			limit = { owner = { religion = corinite } }
			add_unrest = -2
		}
		ELSE = {
			add_unrest = 2
		}
		hidden_effect = {
			save_event_target_as = corinite_firebrand
		}
	}
	
	goto = corinite_firebrand

	#Adeanic
	option = {
		name = "deluge.10.a"
		trigger = {
			owner = { religion = regent_court }
		}
	}
	#Corinite
	option = {
		name = "deluge.10.b"
		trigger = {
			owner = { religion = corinite }
		}
	}
	#Other
	option = {
		name = "deluge.10.c"
		trigger = {
			owner = { NOT = { religion_group = cannorian } }
		}
	}
}

#"A steady pour of Red

#While the Crimson Deluge has not hit [Province Name] with as much might as other parts of Cannor, the rains refuse to move on. Our crops are drowning and people refuse to leave their houses for anything but the most necessary of errands.

#Choice 1: Force the Peasants to work (Unrest, Maybe Military or Manpower cost)
#Choice 2: Help them through the tought times (Money)
#Choice 3: They should be happy they are so luck (Tax Income and Production Loss in province, Dev Cost Increase for 5 years)"

# Peasants can't farm
province_event = {
	id = deluge.11
	title = deluge.11.t
	desc = deluge.11.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		has_global_flag = crimson_deluge_is_actively_happening
		OR = {
			region = alenic_frontier_region
			region = forlorn_vale_region
			region = esmaria_region
			region = east_dameshead_region
			region = the_borders_region
			superregion = escann_superregion
		}
		NOT = {
			has_province_modifier = constant_rains
		}
	}
	
	mean_time_to_happen = {
		months = 100
		modifier = {
			factor = 0.8
			region = west_castanor_region
			region = inner_castanor_region
			region = south_castanor_region
			region = the_borders_region
		}
	}
	is_mtth_scaled_to_size = 1
	
	immediate = {
		hidden_effect = {
			save_event_target_as = steady_pour_of_red
		}
	}
	
	goto = steady_pour_of_red

	#force to work
	option = {
		name = "deluge.11.a"
		add_unrest = 2
		add_manpower = -1
	}
	#help them
	option = {
		name = "deluge.11.b"
		add_treasury = -30
	}
	#Other
	option = {
		name = "deluge.11.c"
		add_province_modifier = {
			name = constant_rains
			duration = 1825
		}
	}
}