
namespace = flavor_skewered_drake



#starting event
country_event = {
	id = flavor_skewered_drake.1
	title = flavor_skewered_drake.1.t
	desc = flavor_skewered_drake.1.d
	picture = CAVE_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		has_dlc = "Lions of the North"
		NOT = { 
			is_year = 1445
			has_country_modifier = mythical_cavalry_drakon
		}
		tag = H73
	}
	
	#hell yeah
	option = {
		name = flavor_skewered_drake.1.a
		ai_chance = { factor = 100 }
		enable_mythical_cavalry = { mount = drakon }
		add_country_modifier = { name = skewered_drake_more_cav duration = -1 }
	}
}

#lord of sun and stone
country_event = {
	id = flavor_skewered_drake.2
	title = flavor_skewered_drake.2.t
	desc = flavor_skewered_drake.2.d
	picture = CAVE_eventPicture

	is_triggered_only = yes
	
	trigger = {
		tag = H73
	}
	
	#nice
	option = {
		name = flavor_skewered_drake.2.a
		ai_chance = { factor = 100 }
		if = {
			limit = { NOT = { government = monarchy } }
			change_government = monarchy
		}
		override_country_name = DRAKONSHAN
		remove_country_modifier = skewered_drake_more_cav
		add_government_reform = drakonshani_dominion
		set_country_flag = skewered_drake_part2
		swap_non_generic_missions = yes
	}
}

#an orc and his drakon
country_event = {
	id = flavor_skewered_drake.3
	title = flavor_skewered_drake.3.t
	desc = flavor_skewered_drake.3.d
	picture = CAVE_eventPicture

	is_triggered_only = yes
	
	trigger = {
		tag = H73
	}
	
	#nice
	option = {
		name = flavor_skewered_drake.3.a
		ai_chance = { factor = 100 }
		add_estate_loyalty = { estate = estate_monstrous_tribes loyalty = 10 }
		add_ruler_modifier = { name = skewered_drake_vrak duration = -1 }
	}
}

#the bigger they are
country_event = {
	id = flavor_skewered_drake.4
	title = flavor_skewered_drake.4.t
	desc = flavor_skewered_drake.4.d
	picture = CAVE_eventPicture

	is_triggered_only = yes
	
	trigger = {
		tag = H73
	}
	
	#nice
	option = {
		name = flavor_skewered_drake.4.a
		ai_chance = { factor = 100 }
		4228 = { spawn_expedition = yes }
	}
}


#pact of gold
country_event = {
	id = flavor_skewered_drake.5
	title = flavor_skewered_drake.5.t
	desc = flavor_skewered_drake.5.d
	picture = CAVE_eventPicture

	is_triggered_only = yes
	
	trigger = {
		tag = H73
	}
	
	#nice
	option = {
		name = flavor_skewered_drake.5.a
		ai_chance = { factor = 100 }
		if = {
			limit = { stunad_kradoz_area = { type = all NOT = { owned_by = M01 } } }
			stunad_kradoz_area = {
				hidden_effect = { remove_core = ROOT add_core = M01 }
				cede_province = M01
			}
		}
		greatcavern_area = {
			change_trade_goods = gold 
			hidden_effect = { add_province_triggered_modifier = skewered_drake_greatcavern_gold }
		}

		#move minorities
		custom_tooltip = flavor_skewered_drake.5.tooltip1
		#goblins
		hidden_effect = {
			set_variable = { minority_mover = 8 }
			while = {
				limit = { check_variable = { minority_mover = 1 } }
				subtract_variable = { minority_mover = 1 }
				if = {
					limit = { 
						greatcavern_area = {
							type = all
							NOT = { has_large_goblin_minority_trigger = yes }
						}
					}
				}
				random_owned_province = { 
					limit = { has_goblin_minority_trigger = yes } 
					remove_goblin_minority_size_effect = yes 
				}
				random_list = {
					1000 = {
						modifier = { factor = 0.1 4106 = { has_large_goblin_minority_trigger = yes } }
						4106 = {
							if = {
								limit = { NOT = { has_large_goblin_minority_trigger = yes } }
								add_goblin_minority_size_effect = yes
							}
							else = { add_base_production = 1 }
						}
					}
					1000 = {
						modifier = { factor = 0.1 4092 = { has_large_goblin_minority_trigger = yes } }
						4092 = {
							if = {
								limit = { NOT = { has_large_goblin_minority_trigger = yes } }
								add_goblin_minority_size_effect = yes
							}
							else = { add_base_production = 1 }
						}
					}
					1000 = {
						modifier = { factor = 0.1 4094 = { has_large_goblin_minority_trigger = yes } }
						4094 = {
							if = {
								limit = { NOT = { has_large_goblin_minority_trigger = yes } }
								add_goblin_minority_size_effect = yes
							}
							else = { add_base_production = 1 }
						}
					}
					1000 = {
						modifier = { factor = 0.1 4095 = { has_large_goblin_minority_trigger = yes } }
						4095 = {
							if = {
								limit = { NOT = { has_large_goblin_minority_trigger = yes } }
								add_goblin_minority_size_effect = yes
							}
							else = { add_base_production = 1 }
						}
					}
				}
			}
		}
		#dwarves
		hidden_effect = {
			set_variable = { minority_mover = 8 }
			while = {
				limit = { check_variable = { minority_mover = 1 } }
				subtract_variable = { minority_mover = 1 }
				if = {
					limit = { 
						greatcavern_area = {
							type = all
							NOT = { has_large_dwarven_minority_trigger = yes }
						}
					}
				}
				random_owned_province = { 
					limit = { has_dwarven_minority_trigger = yes } 
					remove_dwarven_minority_size_effect = yes 
				}
				random_list = {
					1000 = {
						modifier = { factor = 0.1 4106 = { has_large_dwarven_minority_trigger = yes } }
						4106 = {
							if = {
								limit = { NOT = { has_large_dwarven_minority_trigger = yes } }
								add_dwarven_minority_size_effect = yes
							}
							else = { add_base_production = 1 }
						}
					}
					1000 = {
						modifier = { factor = 0.1 4092 = { has_large_dwarven_minority_trigger = yes } }
						4092 = {
							if = {
								limit = { NOT = { has_large_dwarven_minority_trigger = yes } }
								add_dwarven_minority_size_effect = yes
							}
							else = { add_base_production = 1 }
						}
					}
					1000 = {
						modifier = { factor = 0.1 4094 = { has_large_dwarven_minority_trigger = yes } }
						4094 = {
							if = {
								limit = { NOT = { has_large_dwarven_minority_trigger = yes } }
								add_dwarven_minority_size_effect = yes
							}
							else = { add_base_production = 1 }
						}
					}
					1000 = {
						modifier = { factor = 0.1 4095 = { has_large_dwarven_minority_trigger = yes } }
						4095 = {
							if = {
								limit = { NOT = { has_large_dwarven_minority_trigger = yes } }
								add_dwarven_minority_size_effect = yes
							}
							else = { add_base_production = 1 }
						}
					}
				}
			}
			
		}

		add_historical_friend = M01
		M01 = { add_historical_friend = ROOT }
		custom_tooltip = flavor_skewered_drake.5.tooltip2

		M01 = { add_country_modifier = { name = skewered_drake_gold_given duration = -1 } }
		add_country_modifier = { name = skewered_drake_gold_taken duration = -1 }
	}
}

#dinatoldir reforged
country_event = {
	id = flavor_skewered_drake.6
	title = flavor_skewered_drake.6.t
	desc = flavor_skewered_drake.6.d
	picture = CAVE_eventPicture

	is_triggered_only = yes
	
	trigger = {
		tag = H73
	}
	
	#nice
	option = {
		name = flavor_skewered_drake.6.a
		ai_chance = { factor = 100 }
		add_country_modifier = { name = wielding_dinatoldir duration = -1 }
		hidden_effect = { country_event = { id = flavor_skewered_drake.7 days = 60 } }
	}
}
#dinatoldir skewer
country_event = {
	id = flavor_skewered_drake.7
	title = flavor_skewered_drake.7.t
	desc = flavor_skewered_drake.7.d
	picture = CAVE_eventPicture

	is_triggered_only = yes
	
	trigger = {
		tag = H73
	}
	
	#nice
	option = {
		name = flavor_skewered_drake.7.a
		ai_chance = { factor = 100 }
		remove_country_modifier = wielding_dinatoldir
		add_country_modifier = { name = skewered_drake_dinatoldir duration = -1 }
		every_subject_country = {
			limit = { 
				OR = {
					primary_culture = sun_elf
					religion_group = bulwari
				}
			}
			add_liberty_desire = 15
		}
	}
}













######################################
#######How to Train your Drakon#######
######################################

#start, food
country_event = {
	id = flavor_skewered_drake.100
	title = flavor_skewered_drake.100.t
	desc = flavor_skewered_drake.100.d
	picture = CAVE_eventPicture

	is_triggered_only = yes
	
	trigger = {
		tag = H73
		NOT = { has_ruler_flag = has_drakon }
	}

	immediate = {
		hidden_effect = { set_ruler_flag = training_drakon }
	}
	
	#basic
	option = {
		name = flavor_skewered_drake.100.a
		ai_chance = { factor = 100 }
		add_ruler_modifier = { name = skewered_drake_drakon_small duration = -1 }
	}

	#deluxe
	option = {
		name = flavor_skewered_drake.100.b
		ai_chance = { factor = 100 }
		add_ruler_modifier = { name = skewered_drake_drakon_medium duration = -1 }
	}

	#luxurious
	option = {
		name = flavor_skewered_drake.100.c
		ai_chance = { factor = 100 }
		trigger = { mission_completed = skewered_drake_reap_sow }
		add_ruler_modifier = { name = skewered_drake_drakon_large duration = -1 }
	}

	after = { country_event = { id = flavor_skewered_drake.101 days = 90 random = 60 } }
}

#exercise
country_event = {
	id = flavor_skewered_drake.101
	title = flavor_skewered_drake.101.t
	desc = flavor_skewered_drake.101.d
	picture = CAVE_eventPicture

	is_triggered_only = yes
	
	trigger = {
		tag = H73
		has_ruler_flag = training_drakon
	}
	
	#running
	option = {
		name = flavor_skewered_drake.101.a
		ai_chance = { factor = 100 }
		if = {
			limit = { mission_completed = skewered_drake_blood_sports }
			add_ruler_modifier = { name = skewered_drake_drakon_running_upgraded duration = -1 }
		}
		else = { add_ruler_modifier = { name = skewered_drake_drakon_running duration = -1 } }
	}

	#climbing
	option = {
		name = flavor_skewered_drake.101.b
		ai_chance = { factor = 100 }
		if = {
			limit = { mission_completed = skewered_drake_blood_sports }
			add_ruler_modifier = { name = skewered_drake_drakon_climbing_upgraded duration = -1 }
		}
		else = { add_ruler_modifier = { name = skewered_drake_drakon_climbing duration = -1 } }
	}

	#rock breaking
	option = {
		name = flavor_skewered_drake.101.c
		ai_chance = { factor = 100 }
		if = {
			limit = { mission_completed = skewered_drake_blood_sports }
			add_ruler_modifier = { name = skewered_drake_drakon_rockbreaking_upgraded duration = -1 }
		}
		else = { add_ruler_modifier = { name = skewered_drake_drakon_rockbreaking duration = -1 } }
	}

	after = { country_event = { id = flavor_skewered_drake.102 days = 90 random = 60 } }
}

#exercise
country_event = {
	id = flavor_skewered_drake.102
	title = flavor_skewered_drake.102.t
	desc = flavor_skewered_drake.102.d
	picture = CAVE_eventPicture

	is_triggered_only = yes
	
	trigger = {
		tag = H73
		has_ruler_flag = training_drakon
	}
	
	#commander
	option = {
		name = flavor_skewered_drake.101.a
		ai_chance = { factor = 100 }
		trigger = { adm = 3 }
		highlight = yes
		add_ruler_modifier = { name = skewered_drake_drakon_commander duration = -1 }
	}

	#ranged
	option = {
		name = flavor_skewered_drake.101.b
		ai_chance = { factor = 100 }
		trigger = { dip = 3 }
		highlight = yes
		add_ruler_modifier = { name = skewered_drake_drakon_ranged duration = -1 }
	}

	#lance
	option = {
		name = flavor_skewered_drake.101.c
		ai_chance = { factor = 100 }
		trigger = { mil = 3 }
		highlight = yes
		add_ruler_modifier = { name = skewered_drake_drakon_lance duration = -1 }
	}

	#sword and board
	option = {
		name = flavor_skewered_drake.101.e
		ai_chance = { factor = 100 }
		add_ruler_modifier = { name = skewered_drake_drakon_sword duration = -1 }
	}

	after = { country_event = { id = flavor_skewered_drake.103 days = 90 random = 60 } }
}

#end
country_event = {
	id = flavor_skewered_drake.103
	title = flavor_skewered_drake.103.t
	desc = flavor_skewered_drake.103.d
	picture = CAVE_eventPicture

	is_triggered_only = yes
	
	trigger = {
		tag = H73
		has_ruler_flag = training_drakon
	}
	
	#pet it
	option = {
		name = flavor_skewered_drake.101.a
		ai_chance = { factor = 100 }
		add_adm_power = -1
	}

	#hug it
	option = {
		name = flavor_skewered_drake.101.b
		ai_chance = { factor = 100 }
		add_dip_power = -1
	}

	#play with it
	option = {
		name = flavor_skewered_drake.101.c
		ai_chance = { factor = 100 }
		add_mil_power = -1
	}

	after = {
		clr_ruler_flag = training_drakon
		set_ruler_flag = has_drakon
	}
}