namespace = magic_realm_necromancy


#Necromancy - Menu
country_event = {
	id = magic_realm_necromancy.0
	title = magic_realm_necromancy.0.t
	desc = magic_realm_necromancy.0.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = magic_realm_nospells.0.a
		trigger = {
			NOT = { has_ruler_flag = necromancy_1 }
			NOT = { has_ruler_flag = necromancy_2 }
			NOT = { has_ruler_flag = necromancy_3 }
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_realm.0 days = 0 }
	}
	
	#Absorb life energy aka kill a random advisor, consort, heir and increase your stats
	option = {	# necromancy.1 - [1] Absorb Life Energy
		name = magic_realm_necromancy.1.t
		trigger = {
			has_ruler_flag = necromancy_1
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_realm_necromancy.2 days = 0 }
		
		custom_tooltip = tooltip_option_necromancy_1
	}
	
	# option = {	# necromancy.2 - [2] Summon Undead Army
		# name = magic_realm_necromancy.2.t
		# trigger = {
			# has_ruler_flag = necromancy_2
		# }
		# ai_chance = {
			# factor = 50
		# }
		
		# country_event = { id = magic_realm_necromancy.2 days = 0 }
		
		# custom_tooltip = tooltip_option_necromancy_2
	# }
	
	option = {
		name = magic_siege.goback
		ai_chance = {
			factor = 50
		}
		country_event = { id = magic_realm.0 days = 0 }
	}
}

# 1 - Absorb Life Energy
country_event = {
	id = magic_realm_necromancy.1
	title = magic_realm_necromancy.1.t
	desc = magic_realm_necromancy.1.d
	picture = NEW_HEIR_eventPicture
	
	is_triggered_only = yes

	option = {	#Absorb Heir
		name = magic_realm_necromancy.1.a
		trigger = {
			has_ruler_flag = necromancy_1
			has_heir = yes
		}
		ai_chance = {
			factor = 50
		}
		
		#Cost
		add_adm_power = -5
		add_mil_power = -5
		
		add_legitimacy = -10
		
		#Effect
		increase_witch_king_points_small = yes
		
		random_list = {
			25 = {
				kill_heir = yes
			}
			75 = {
			
			}
		}
		
		random_list = {
			33 = {
				add_adm_power = 30
			}
			33 = {
				add_adm_power = 30
			}
			34 = {
				add_adm_power = 30
			}
		}
	}
	
	option = {	#Absorb Consort
		name = magic_realm_necromancy.1.b
		trigger = {
			has_ruler_flag = necromancy_1
			has_consort = yes
		}
		ai_chance = {
			factor = 50
		}
		
		#Cost
		add_adm_power = -5
		add_mil_power = -5
		
		add_legitimacy = -10
		
		#Effect
		increase_witch_king_points_small = yes
		
		random_list = {
			25 = {
				remove_consort = yes
			}
			75 = {
			
			}
		}
		
		random_list = {
			33 = {
				add_adm_power = 20
			}
			33 = {
				add_adm_power = 20
			}
			34 = {
				add_adm_power = 20
			}
		}
	}
	
	option = {	#Absorb Advisor
		name = magic_realm_necromancy.1.c
		trigger = {
			has_ruler_flag = necromancy_1
			has_advisor = yes
		}
		ai_chance = {
			factor = 50
		}
		
		#Cost
		add_adm_power = -5
		add_mil_power = -5
		
		add_prestige = -10
		
		#Effect
		increase_witch_king_points_small = yes
		
		random_list = {
			25 = {
				kill_advisor = random
			}
			75 = {
			
			}
		}
		
		random_list = {
			33 = {
				add_adm_power = 20
			}
			33 = {
				add_adm_power = 20
			}
			34 = {
				add_adm_power = 20
			}
		}
	}
	
	option = {	#Absorb General/Admiral
		name = magic_realm_necromancy.1.dd
		trigger = {
			has_ruler_flag = necromancy_1
			OR = {
				num_of_generals = 1
				num_of_admirals = 1
			}
		}
		ai_chance = {
			factor = 50
		}
		
		#Cost
		add_adm_power = -5
		add_mil_power = -5
		
		add_prestige = -10
		
		#Effect
		increase_witch_king_points_small = yes
		
		random_list = {
			25 = {
				kill_leader = random
			}
			75 = {
			
			}
		}
		
		random_list = {
			33 = {
				add_adm_power = 30
			}
			33 = {
				add_adm_power = 30
			}
			34 = {
				add_adm_power = 30
			}
		}
	}
	
	option = {	#Absorb A SHIT LOAD OF PEOPLE
		name = magic_realm_necromancy.1.e
		trigger = {
			has_ruler_flag = necromancy_1
		}
		ai_chance = {
			factor = 50
		}
		
		#Cost
		add_adm_power = -5
		add_dip_power = -5
		
		#Effect
		increase_witch_king_points_medium = yes
		
		random_owned_province = {
			if = {
				limit = { base_tax = 2 }
				add_base_tax = -1
			}
			else_if = {
				limit = { base_manpower = 2 }
				add_base_manpower = -1
			}
			else_if = {
				limit = { base_manpower = 2 }
				add_base_production = -1
			}
		}
		
		random_list = {
			33 = {
				add_adm_power = 100
			}
			33 = {
				add_adm_power = 100
			}
			34 = {
				add_adm_power = 100
			}
		}
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 50
		}
		country_event = { id = magic_realm_necromancy.0 days = 0 }
	}
}

# 2 - Summon Undead Army
country_event = {
	id = magic_realm_necromancy.2
	title = magic_realm_necromancy.2.t
	desc = magic_realm_necromancy.2.d
	picture = FAMINE_eventPicture
	
	is_triggered_only = yes

	option = {	
		name = magic_realm_necromancy.2.a
		trigger = {
			has_ruler_flag = necromancy_2
		}
		ai_chance = {
			factor = 50
		}
		
		#Cost
		add_adm_power = -15
		add_dip_power = -15
		
		#Effect
		magic_casted_spell = yes
		
		#MAKE THIS NOT CAPITAL ONLY OR MAKE IT SPAWN AT ARMY AS AN OPTION
		capital_scope = {
			infantry = ROOT
		}
		capital_scope = {
			infantry = ROOT
		}
		capital_scope = {
			infantry = ROOT
		}
		capital_scope = {
			infantry = ROOT
		}
		capital_scope = {
			infantry = ROOT
		}
		
		if = {
			limit = {
				has_country_modifier = undead_army
			}
		}
		else = {
			add_country_modifier = {
				name = undead_army
				duration = -1
			}
		}
		
		if = {
			limit = {
				NOT = { technology_group = tech_undead }
			}
			change_technology_group = tech_undead
			change_unit_type = tech_undead
		}
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 50
		}
		country_event = { id = magic_realm_necromancy.0 days = 0 }
	}
}

