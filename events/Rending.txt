namespace = rending

##############################################################
# Legend for IDs:
# 000-099 = Rending main path
# 100-199 = Ward&Suppress path
# 200-299 = Corrupt&Scour path
# 300-399 = Appease&Dominate path
# 400-499 = tdb
# 500-599 = tdb
# 600-699 = tdb
##############################################################

country_event = {	#Early warning event. T-1 years. "Spirits Are Stirring"
	id = rending.001
	title = rending.001.t
	desc = rending.001.d # SOMETHING IS AWRY, SPIRITS ARE STURRING
	picture = MIRACLE_MONK_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes
		
	trigger = {
		is_year = 1650
		NOT = { has_global_flag = rending_has_ended_flag }
		NOT = { has_global_flag = rending_countdown_flag }
		temple_province_group = { has_damaged_derelict_or_corrupted_temple_complex = yes }
	}

	immediate = {
		hidden_effect = {
			set_global_flag = rending_countdown_flag
		}
	}
	
	option = {
		name = rending.001.a
	}
}

country_event = {	#Early warning event 2 . T-6 months. "Spirits Are Stirring"
	id = rending.002
	title = rending.002.t
	desc = rending.002.d
	picture = MIRACLE_MONK_eventPicture
	
	is_triggered_only = yes
		
	trigger = {
		is_year = 1650
		NOT = { has_global_flag = rending_has_ended_flag }
		had_global_flag = { flag = rending_countdown_flag days = 180 }
		any_owned_province = { province_group = temple_province_group }
	}
	
	option = {
		name = rending.002.a
	}
}

country_event = {	# The beginning of Rending of Realms. "The Rending of Realms"
	id = rending.003
	title = rending.003.t
	desc = rending.003.d
	picture = MIRACLE_MONK_eventPicture

	is_triggered_only = yes
		
	trigger = {
		is_year = 1650
		NOT = { has_global_flag = rending_has_ended_flag }
		NOT = { has_global_flag = rending_has_started_flag }
		had_global_flag = { flag = rending_countdown_flag days = 365 }
		capital_scope = { # capital in Haless
			OR = {
				superregion = yanshen_superregion
				superregion = rahen_superregion
				superregion = south_haless_superregion
			}
		}
		num_of_owned_provinces_with = { # 10+ provinces in Haless
			value = 10
			continent = asia
		}
	}

	immediate = {
		hidden_effect = {
			set_global_flag = rending_has_started_flag
			clr_global_flag = rending_countdown_flag
		}
		
		custom_tooltip = rending.003.itt1
		hidden_effect = {
			every_owned_province = {
				limit = { has_province_modifier = damaged_temple_complex }
				add_devastation = 25 # placeholder value
			}
		}

		custom_tooltip = rending.003.itt2 # may be show one tooltip for each damaged temple?
		hidden_effect = {
			every_owned_province = {
				limit = { has_province_modifier = temple_complex }
				random = {
					chance = 75 # may need to be changed, placeholder
					remove_province_modifier = temple_complex
					add_permanent_province_modifier = {
						name = damaged_temple_complex
						duration = -1
					}
					downgrade_temple_wards = yes
				}
			}

		}

	}
	
	option = {
		name = rending.003.a
		trigger = {
			NOT = {
				religion = mystic_accord
				religion = bangujonsi
				religion = lefthand_path
				religion = bangujonsi
				religion = righteous_path
			}
		}
		country_event = { id = rending.100 }
	}
	option = {
		name = rending.003.b
		trigger = {
			OR = {
				religion = mystic_accord
				religion = bangujonsi
			}
		}
		country_event = { id = rending.300 }
	}
	option = {
		name = rending.003.c
		trigger = {
			OR = {
				religion = lefthand_path
				religion = bangujonsi
			}
		}
	}
	option = {
		name = rending.003.e
		trigger = {
			religion = righteous_path
		}
	}
}

country_event = {	# Ward and Suppress path starting event.
	id = rending.100
	title = rending.100.t
	desc = rending.100.d
	picture = MIRACLE_MONK_eventPicture
	
	is_triggered_only = yes

	immediate = {
		set_country_flag = rending_ward_and_suppress
	}

	option = {
		name = rending.100.a
		custom_tooltip = rending.100.tt
		hidden_effect = {
			every_owned_province = {
				add_province_triggered_modifier = rending_spirit_protection
			}
		}
	}
}


#UI Team needed
country_event = {	# Hunter menu, from decision
	id = rending.199
	title = rending.199.t
	desc = rending.199.d
	picture = MIRACLE_MONK_eventPicture
	
	is_triggered_only = yes


	option = {
		name = rending.199.a
		trigger = {
			can_hire_hunter = { great_spirit = yanhe }
		}

		hire_hunter = { great_spirit = yanhe }
	}

	option = {
		name = rending.199.b
		trigger = {
			can_hire_hunter = { great_spirit = dhenbasana }
		}

		hire_hunter = { great_spirit = dhenbasana }
	}

	option = {
		name = rending.199.c
		trigger = {
			can_hire_hunter = { great_spirit = hengdu_bowu }
		}

		hire_hunter = { great_spirit = hengdu_bowu }
	}

	option = {
		name = rending.199.d
		trigger = {
			can_hire_hunter = { great_spirit = hukai }
		}

		hire_hunter = { great_spirit = hukai }
	}

	option = {
		name = rending.199.e
		trigger = {
			can_hire_hunter = { great_spirit = tughayasa }
		}

		hire_hunter = { great_spirit = tughayasa }
	}


	option = {
		name = rending.199.f
		trigger = {
			can_hire_hunter = { great_spirit = telebei }
		}

		hire_hunter = { great_spirit = telebei }
	}

	option = {
		name = rending.199.g
		trigger = {
			can_hire_hunter = { great_spirit = phokhao }
		}

		hire_hunter = { great_spirit = phokhao }
	}

	option = {
		name = rending.199.h
		trigger = {
			can_hire_hunter = { great_spirit = gehet_ketine }
		}

		hire_hunter = { great_spirit = gehet_ketine }
	}

	option = {
		name = rending.199.i
		trigger = {
			can_hire_hunter = { great_spirit = lupulan }
		}

		hire_hunter = { great_spirit = lupulan }
	}

	option = {
		name = rending.199.j
		trigger = {
			can_hire_hunter = { great_spirit = semat_tidukhai }
		}

		hire_hunter = { great_spirit = semat_tidukhai }
	}

	option = {
		name = rending.199.k
		trigger = {
			can_hire_hunter = { great_spirit = cinulau }
		}

		hire_hunter = { great_spirit = cinulau }
	}

	option = {
		name = rending.199.l
		trigger = {
			can_hire_hunter = { great_spirit = hokuma }
		}

		hire_hunter = { great_spirit = hokuma }
	}

	option = { # Do nothing.
		name = rending.199.m
	}
}

# UI Team needed there
country_event = {	# Spirit suppression menu, from decision
	id = rending.198
	title = rending.198.t
	desc = rending.198.d
	picture = MIRACLE_MONK_eventPicture
	
	is_triggered_only = yes

	option = {
		name = rending.198.a
		trigger = {
			can_suppress_spirit = { great_spirit = yanhe }
		}

		suppress_spirit = { great_spirit = yanhe yanhe = yes }
	}

	option = {
		name = rending.198.b
		trigger = {
			can_suppress_spirit = { great_spirit = dhenbasana }
		}

		suppress_spirit = { great_spirit = dhenbasana dhenbasana = yes }
	}

	option = {
		name = rending.198.c
		trigger = {
			can_suppress_spirit = { great_spirit = hengdu_bowu }
		}

		suppress_spirit = { great_spirit = hengdu_bowu hendgu_bowu = yes }
	}

	option = {
		name = rending.198.d
		trigger = {
			can_suppress_spirit = { great_spirit = hukai }
		}

		suppress_spirit = { great_spirit = hukai hukai = yes }
	}

	option = {
		name = rending.198.e
		trigger = {
			can_suppress_spirit = { great_spirit = tughayasa }
		}

		suppress_spirit = { great_spirit = tughayasa tughayasa = yes }
	}


	option = {
		name = rending.198.f
		trigger = {
			can_suppress_spirit = { great_spirit = telebei }
		}

		suppress_spirit = { great_spirit = telebei telebei = yes }
	}

	option = {
		name = rending.198.g
		trigger = {
			can_suppress_spirit = { great_spirit = phokhao }
		}

		suppress_spirit = { great_spirit = phokhao phokhao = yes }
	}

	option = {
		name = rending.198.h
		trigger = {
			can_suppress_spirit = { great_spirit = gehet_ketine }
		}

		suppress_spirit = { great_spirit = gehet_ketine gehet_ketine = yes }
	}

	option = {
		name = rending.198.i
		trigger = {
			can_suppress_spirit = { great_spirit = lupulan }
		}

		suppress_spirit = { great_spirit = lupulan lupulan = yes }
	}

	option = {
		name = rending.198.j
		trigger = {
			can_suppress_spirit = { great_spirit = semat_tidukhai }
		}

		suppress_spirit = { great_spirit = semat_tidukhai semat_tidukhai = yes}
	}

	option = {
		name = rending.198.k
		trigger = {
			can_suppress_spirit = { great_spirit = cinulau }
		}

		suppress_spirit = { great_spirit = cinulau cinulau = yes }
	}

	option = {
		name = rending.198.l
		trigger = {
			can_suppress_spirit = { great_spirit = hokuma }
		}

		suppress_spirit = { great_spirit = hokuma hokuma = yes }
	}

	option = { # Do nothing.
		name = rending.198.m
	}
}
# appease and dominate path starting event

# sets primary target depending on capital placement and start appesment with that faction. triggers the appeasement lore event
country_event = {	# appease and dominate path starting event, sets primary target depending on capital placement
	id = rending.300
	title = rending.300.t
	desc = rending.300.d
	picture = MIRACLE_MONK_eventPicture
	
	is_triggered_only = yes

	immediate = {
	}

	option = { #checks in which spirit region your capital is, assigns this spirit as primary and starts the appeasement process for that spirit
		name = rending.300.a
		set_country_flag = rending_appease_dominate
		hidden_effect = {
			if = {
				limit = { 
					capital_scope = {
						province_group = marutha_spirit_area
					}	
				}
				country_event = { id = rending.310 }
				set_country_flag = appeasement_in_progress
				set_country_flag = marutha_appeasement
				set_country_flag = marutha_primary
			}
			else_if = {
				limit = { 
					capital_scope = {
						province_group = dhenbasana_spirit_area
					}	
				}
				country_event = { id = rending.311 }
				set_country_flag = appeasement_in_progress
				set_country_flag = dhenbasana_appeasement
				set_country_flag = dhenbasana_primary
			}
			else_if = {
				limit = { 
					capital_scope = {
						province_group = kharunyana_spirit_area
					}	
				}
				country_event = { id = rending.312 }
				set_country_flag = appeasement_in_progress
				set_country_flag = kharunyana_appeasement
				set_country_flag = kharunyana_primary
			}
			else_if = {
				limit = { 
					capital_scope = {
						province_group = tughayasa_spirit_area
					}	
				}
				country_event = { id = rending.313 }
				set_country_flag = appeasement_in_progress
				set_country_flag = tughayasa_appeasement
				set_country_flag = tughayasa_primary
			}
			else_if = {
				limit = { 
					capital_scope = {
						province_group = hengdu_bowu_spirit_area
					}	
				}
				country_event = { id = rending.314 }
				set_country_flag = appeasement_in_progress
				set_country_flag = hengdu_bowu_appeasement
				set_country_flag = hengdu_bowu_primary
			}
			else_if = {
				limit = { 
					capital_scope = {
						OR = {
							province_group = hukai_spirit_area
							province_group = telebei_spirit_area
						}
					}	
				}
				country_event = { id = rending.315 }
				set_country_flag = appeasement_in_progress
				set_country_flag = hukai_telebei_appeasement
				set_country_flag = hukai_telebei_primary
			}
			else_if = {
				limit = { 
					capital_scope = {
						province_group = phokhao_spirit_area
					}	
				}
				country_event = { id = rending.316 }
				set_country_flag = appeasement_in_progress
				set_country_flag = phokhao_appeasement
				set_country_flag = phokhao_primary
			}
			else_if = {
				limit = { 
					capital_scope = {
						province_group = gehet_ketine_spirit_area
					}	
				}
				country_event = { id = rending.317 }
				set_country_flag = appeasement_in_progress
				set_country_flag = gehet_ketine_appeasement
				set_country_flag = gehet_ketine_primary
			}
			else_if = {
				limit = { 
					capital_scope = {
						province_group = lupulan_spirit_area
					}	
				}
				country_event = { id = rending.318 }
				set_country_flag = appeasement_in_progress
				set_country_flag = lupulan_appeasement
				set_country_flag = lupulan_primary
			}
			else_if = {
				limit = { 
					capital_scope = {
						province_group = cinulau_spirit_area
					}	
				}
				country_event = { id = rending.319 }
				set_country_flag = appeasement_in_progress
				set_country_flag = cinulau_appeasement
				set_country_flag = cinulau_primary
			}
			else_if = {
				limit = { 
					capital_scope = {
						province_group = yanhe_spirit_area
					}	
				}
				country_event = { id = rending.320 }
				set_country_flag = appeasement_in_progress
				set_country_flag = yanhe_appeasement
				set_country_flag = yanhe_primary
			}
			else_if = {
				limit = { 
					capital_scope = {
						province_group = hokuma_spirit_area
					}	
				}
				country_event = { id = rending.321 }
				set_country_flag = appeasement_in_progress
				set_country_flag = hokuma_appeasement
				set_country_flag = hokuma_primary
			}
			else = {
				#error handling
				country_event = { id = rending.302 }
			}
		}
	}
}

country_event = {	#choose appesment target
	id = rending.301
	title = rending.301.t
	desc = rending.301.d
	picture = MIRACLE_MONK_eventPicture
	
	is_triggered_only = yes

	immediate = {
	}

	option = {
		name = rending.301.a
		trigger = {
			marutha_spirit_area = {
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = marutha_appeased }
		}
		set_country_flag = marutha_appeasement
		country_event = { id = rending.310 }
	}
	option = {
		name = rending.301.b
		trigger = {
			dhenbasana_spirit_area = {
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = dhenbasana_appeased }
		}
		set_country_flag = dhenbasana_appeasement
		country_event = { id = rending.311 }
	}
	option = {
		name = rending.301.c
		trigger = {
			kharunyana_spirit_area = {
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = kharunyana_appeased }
		}
		set_country_flag = kharunyana_appeasement
		country_event = { id = rending.312 }
	}
	option = {
		name = rending.301.m
		trigger = {
			tughayasa_spirit_area = {
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = tughayasa_appeased }
		}
		set_country_flag = tughayasa_appeasement
		country_event = { id = rending.313 }
	}
	option = {
		name = rending.301.e
		trigger = {
			hengdu_bowu_spirit_area = {
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = hengdu_bowu_appeased }
		}
		set_country_flag = hengdu_bowu_appeasement
		country_event = { id = rending.314 }
	}
	option = {
		name = rending.301.f
		trigger = {
			OR = {
				hukai_spirit_area = {
					country_or_non_sovereign_subject_holds = ROOT
				}
				telebei_spirit_area = {
					country_or_non_sovereign_subject_holds = ROOT
				}									
			}
			NOT = { has_country_flag = hukai_telebei_appeased }
		}
		set_country_flag = hukai_telebei_appeasement
		country_event = { id = rending.315 }
	}
	option = {
		name = rending.301.g
		trigger = {
			phokhao_spirit_area = {
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = phokhao_appeased }
		}
		set_country_flag = phokhao_appeasement
		country_event = { id = rending.316 }
	}
	option = {
		name = rending.301.h
		trigger = {
			gehet_ketine_spirit_area = {
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = gehet_ketine_appeased }
		}
		set_country_flag = gehet_ketine_appeasement
		country_event = { id = rending.317 }
	}
	option = {
		name = rending.301.i
		trigger = {
			lupulan_spirit_area = {
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = lupulan_appeased }
		}
		set_country_flag = lupulan_appeasement
		country_event = { id = rending.318 }
	}
	option = {
		name = rending.301.j
		trigger = {
			cinulau_spirit_area = {
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = cinulau_appeased }
		}
		set_country_flag = cinulau_appeasement
		country_event = { id = rending.319 }
	}
	option = {
		name = rending.301.k
		trigger = {
			yanhe_spirit_area = {
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = yanhe_appeased }
		}
		set_country_flag = yanhe_appeasement
		country_event = { id = rending.320 }
	}
	option = {
		name = rending.301.l
		trigger = {
			hokuma_spirit_area = {
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = hokuma_appeased }
		}
		set_country_flag = hokuma_appeasement
		country_event = { id = rending.321 }
	}
	option = {
		name = rending.301.n
		clr_country_flag = appeasement_in_progress
	}
}

country_event = {	# error handling event
	id = rending.302
	title = rending.302.t
	desc = rending.302.d
	picture = MIRACLE_MONK_eventPicture
	is_triggered_only = yes

	option = {
		name = rending.302.a
	}
}

country_event = {	# marutha_appeasement
	id = rending.310
	title = rending.310.t
	desc = rending.310.d
	picture = MIRACLE_MONK_eventPicture
	is_triggered_only = yes

	option = {
		name = rending.310.a
	}
}

country_event = {	# dhenbasana_appeasement
	id = rending.311
	title = rending.311.t
	desc = rending.311.d
	picture = MIRACLE_MONK_eventPicture
	is_triggered_only = yes

	option = {
		name = rending.311.a
	}
}

country_event = {	# kharunyana_appeasement
	id = rending.312
	title = rending.312.t
	desc = rending.312.d
	picture = MIRACLE_MONK_eventPicture
	is_triggered_only = yes

	option = {
		name = rending.312.a
	}
}

country_event = {	# tughayasa_appeasement
	id = rending.313
	title = rending.313.t
	desc = rending.313.d
	picture = MIRACLE_MONK_eventPicture
	is_triggered_only = yes

	option = {
		name = rending.313.a
	}
}

country_event = {	# hengdu_bowu_appeasement
	id = rending.314
	title = rending.314.t
	desc = rending.314.d
	picture = MIRACLE_MONK_eventPicture
	is_triggered_only = yes

	option = {
		name = rending.314.a
	}
}

country_event = {	# hukai_telebei_appeasement
	id = rending.315
	title = rending.315.t
	desc = rending.315.d
	picture = MIRACLE_MONK_eventPicture
	is_triggered_only = yes

	option = {
		name = rending.315.a
	}
}

country_event = {	# phokhao_appeasement
	id = rending.316
	title = rending.316.t
	desc = rending.316.d
	picture = MIRACLE_MONK_eventPicture
	is_triggered_only = yes

	option = {
		name = rending.316.a
	}
}

country_event = {	# gehet_ketine_appeasement
	id = rending.317
	title = rending.317.t
	desc = rending.317.d
	picture = MIRACLE_MONK_eventPicture
	is_triggered_only = yes

	option = {
		name = rending.317.a
	}
}

country_event = {	# lupulan_appeasement
	id = rending.318
	title = rending.318.t
	desc = rending.318.d
	picture = MIRACLE_MONK_eventPicture
	is_triggered_only = yes

	option = {
		name = rending.318.a
	}
}

country_event = {	# cinulau_appeasement
	id = rending.319
	title = rending.319.t
	desc = rending.319.d
	picture = MIRACLE_MONK_eventPicture
	is_triggered_only = yes

	option = {
		name = rending.319.a
	}
}

country_event = {	# yanhe_appeasement
	id = rending.320
	title = rending.320.t
	desc = rending.320.d
	picture = MIRACLE_MONK_eventPicture
	is_triggered_only = yes

	option = {
		name = rending.320.a
	}
}

country_event = {	# hokuma_appeasement
	id = rending.321
	title = rending.321.t
	desc = rending.321.d
	picture = MIRACLE_MONK_eventPicture
	is_triggered_only = yes

	option = {
		name = rending.321.a
	}
}


country_event = {	# personal test event, will remove
	id = rending.101
	title = rending.100.t
	desc = rending.100.d
	picture = MIRACLE_MONK_eventPicture
	is_triggered_only = yes

	option = {
		name = rending.100.a
		custom_tooltip = rending.100.tt
		yanhe_spirit_area = {
			add_core = ROOT
			cede_province = ROOT
		}

		hukai_spirit_area = {
			add_core = ROOT
			cede_province = ROOT
		}

		hokuma_spirit_area = {
			add_core = ROOT
			cede_province = ROOT
		}
	}
}