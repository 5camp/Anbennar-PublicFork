namespace = flavour_beggaston

#Anderol Freodam event chain
country_event = {
	id = flavour_beggaston.1
	title = flavour_beggaston.1.t
	desc = flavour_beggaston.1.d
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	option = {
		name = flavour_beggaston.1.a
		ai_chance = { factor = 100 }
		add_stability = -1
		add_prestige = -30
		capital_scope = {
			add_devastation = 30
			spawn_rebels = {
				type = noble_rebels
				size = 3
				leader = "Anderol"
				leader_dynasty = "Freodam"
			}
		}
		hidden_effect = {
			set_country_flag = beggaston_freodam_invasion
		}
	}
}

country_event = {
	id = flavour_beggaston.2
	title = flavour_beggaston.2.t
	desc = { #Freodam beaten desc
		trigger = {
			has_country_flag = beggaston_freodam_defeated_in_battle
		}
		desc = flavour_beggaston.2.d1
	}
	desc = { #Freodam ousted desc
		trigger = {
			NOT = { has_country_flag = beggaston_freodam_defeated_in_battle }
		}
		desc = flavour_beggaston.2.d2
	}
	picture = WOUNDED_SOLDIERS_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		has_country_flag = beggaston_freodam_invasion
	}

	option = {
		name = flavour_beggaston.2.a
		ai_chance = { factor = 100 }
		add_country_modifier = {
			name = beggaston_the_revolts_wake
			duration = -1
		}
		reduce_estate_burghers_loyalty_effect = yes
		reduce_estate_adventurers_loyalty_effect = yes
		hidden_effect = {
			clr_country_flag = beggaston_freodam_invasion
			clr_country_flag = beggaston_freodam_defeated_in_battle
			set_country_flag = beggaston_not_freodaire
		}
	}
}

country_event = {
	id = flavour_beggaston.3
	title = flavour_beggaston.3.037_theageofdiscovery
	desc = { #Chippengard conquered
		trigger = {
			any_owned_province = {
				OR = {
					is_core = H58
					is_core = H59
				}
			}
		}
		desc = flavour_beggaston.3.d1
	}
	desc = { #Chippengard not spawned
		trigger = {
			NOT = { any_owned_province = {
					OR = {
						is_core = H58
						is_core = H59
					}
				}
			}
		}
		desc = flavour_beggaston.3.d2
	}
	picture = SCOTTISH_MERCENARIES_eventPicture

	is_triggered_only = yes

	option = {
		name = flavour_beggaston.3.a
		ai_chance = { factor = 100 }
		add_republican_tradition_excess_to_mana_effect = { VAL = 10 }
	}
}

#Selocshana conversion
country_event = {
	id = flavour_beggaston.4
	title = flavour_beggaston.4.t
	desc = flavour_beggaston.4.d
	picture = RELIGIOUS_CONVERSION_eventPicture

	is_triggered_only = yes

	option = {
		name = flavour_beggaston.4.a
		ai_chance = { factor = 100 }
		if = {
			limit = { NOt = { exists = U23 } }
			1830 = {
				cede_province = U23
				add_core = U23
			}
			hidden_effect = {
				U23 = {
					change_primary_culture = sarda
					set_ruler_culture = sarda
					clear_fast_ruler_flags = yes
					set_ruler_flag = ruinborn_ruler
					change_government = monarchy
					add_government_reform = ynnic_feudalism
				}
			}
		}
		vassalize = U23
		U23 = {
			change_religion = ROOT
			set_ruler_religion = ROOT
			if = {
				limit = { has_country_modifier = ynn_diplo }
				remove_country_modifier = ynn_diplo
			}
			add_country_modifier = {
				name = beggaston_beggan_lord
				duration = -1
			}
			add_permanent_claim = 1833
			add_permanent_claim = 1133
		}
		1830 = {
			change_religion = ROOT
			add_province_modifier = {
				name = religious_zeal_at_conv
				duration = 3650
			}
		}
	}
}

country_event = {
	id = flavour_beggaston.5
	title = flavour_beggaston.5.t
	desc = flavour_beggaston.5.d
	picture = ACCUSATION_eventPicture

	is_triggered_only = yes

	option = {
		name = flavour_beggaston.5.a
		ai_chance = { factor = 100 }
		sarda_region = {
			discover_country = ROOT
		}
		dolindha_region = {
			discover_country = ROOT
		}
		every_known_country = {
			limit = {
				culture_group = ynnic_ruinborn_elf
				religion = ynn_river_worship
			}
			add_opinion = {
				who = ROOT
				modifier = beggaston_repudiation
			}
		}
		U23 = {
			sarda_region = {
				limit = {
					culture_group = ynnic_ruinborn_elf
				}
				add_permanent_claim = PREV
			}
		}
	}
}

#Teal Plot event chain
country_event = {
	id = flavour_beggaston.6
	title = flavour_beggaston.6.t
	desc = flavour_beggaston.6.d
	picture = REVOLUTION_eventPicture

	is_triggered_only = yes

	option = {
		name = flavour_beggaston.6.a
		ai_chance = { factor = 100 }
		1139 = {
			add_or_upgrade_fort_building = yes
			spawn_rebels = {
				type = noble_rebels
				size = 2
				win = yes
				unrest = 5
			}
			add_province_modifier = {
				name = beggaston_teal_rebels_entrenched
				duration = -1
			}
		}
		custom_tooltip = beggaston_teal_plot_tt
		hidden_effect = {
			set_country_flag = beggaston_teal_plot
			random_owned_province = {
				limit = {
					culture = sarda
				}
				spawn_rebels = {
					type = noble_rebels
					size = 1
					unrest = 5
				}
			}
			random_owned_province = {
				limit = {
					culture = sarda
				}
				spawn_rebels = {
					type = noble_rebels
					size = 1
					unrest = 5
				}
			}
			random_owned_province = {
				limit = {
					culture = sarda
				}
				spawn_rebels = {
					type = noble_rebels
					size = 1
					unrest = 5
				}
			}
			random_owned_province = {
				limit = {
					culture = sarda
				}
				spawn_rebels = {
					type = noble_rebels
					size = 1
					unrest = 5
				}
			}
			random_owned_province = {
				limit = {
					culture = sarda
				}
				spawn_rebels = {
					type = noble_rebels
					size = 1
					unrest = 5
				}
			}
			random_owned_province = {
				limit = {
					culture = sarda
				}
				spawn_rebels = {
					type = noble_rebels
					size = 1
					unrest = 5
				}
			}
			random_owned_province = {
				limit = {
					culture = sarda
				}
				spawn_rebels = {
					type = noble_rebels
					size = 1
					unrest = 5
				}
			}
			random_owned_province = {
				limit = {
					culture = sarda
				}
				spawn_rebels = {
					type = noble_rebels
					size = 1
					unrest = 5
				}
			}
		}
	}
}

country_event = {
	id = flavour_beggaston.7
	title = flavour_beggaston.7.t
	desc = flavour_beggaston.7.d
	picture = SIEGE_PRAGUE_CASTLE_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		tag = H45
		has_country_flag = beggaston_teal_plot
	}

	option = {
		name = flavour_beggaston.7.a
		ai_chance = { factor = 100 }
		1139 = {
			destroy_great_project = {
				type = ynnic_teal_keep
			}
			remove_fortifications = yes
			remove_province_modifier = beggaston_teal_rebels_entrenched
			add_devastation = 50
			add_base_tax = -3
			add_base_production = -3
			add_base_manpower = -3
		}
		add_stability = -1
		add_republican_tradition_excess_to_mana_effect = { VAL = 25 }
		add_prestige_excess_to_splendour_effect = { VAL = 25 }
		sarda_region = {
			limit = {
				culture = sarda
			}
			add_province_modifier = { #removed on conquest
				name = beggaston_teal_keep_destroyed
				duration = 3650
			}
		}
		hidden_effect = {
			country_event = {
				id = flavour_beggaston.8
				days = 3650
				random = 365
			}
		}
	}
}

country_event = {
	id = flavour_beggaston.8
	title = flavour_beggaston.8.t
	desc = flavour_beggaston.8.d
	picture = WESTERNISATION_eventPicture

	is_triggered_only = yes

	option = {
		name = flavour_beggaston.8.a
		ai_chance = { factor = 100 }
		add_inflation = -0.1
		add_corruption = 0.1
	}

	option = {
		name = flavour_beggaston.8.b
		ai_chance = { factor = 100 }
		add_dip_power = 2
		add_adm_power = -1
		add_mil_power = -1
	}

	option = {
		name = flavour_beggaston.8.c
		ai_chance = { factor = 100 }
		add_manpower = 1
	}
}

country_event = {
	id = flavour_beggaston.9
	title = flavour_beggaston.8.t
	desc = flavour_beggaston.8.d
	picture = FARMING_eventPicture

	is_triggered_only = yes

	option = {
		name = flavour_beggaston.9.a
		ai_chance = { factor = 100 }
		#unlocks the last two debates
	}
}

#Hidden event to trigger win against Freodam
country_event = {
	id = flavour_beggaston.10
	
	hidden = yes

	mean_time_to_happen = {
		days = 1
	}

	trigger = {
		tag = H44
		has_country_flag = beggaston_freodam_invasion
		NOt = { num_of_rebel_armies = 1 }
	}

	option = {
		name = flavour_beggaston.10.a
		ai_chance = { factor = 100 }
		set_country_flag = beggaston_freodam_defeated_in_battle
		country_event = {
			id = flavour_beggaston.2
		}
	}
}