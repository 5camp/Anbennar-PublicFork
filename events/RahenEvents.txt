

namespace = rahen


country_event = { #Event to make Rajnadhaga and dwarven adventurers friends
	id = rahen.1
	title = rahen.1.t
	desc = rahen.1.d
	picture = WESTERNISATION_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	trigger = { always = yes } #triggers in on_action file

	immediate = { hidden_effect = { 4266 = { owner = { save_event_target_as = krakazol_friend } } } }

	option = { #can't wait to meet em
		name = rahen.1.a
		ai_chance = { factor = 100 }
		if = {
			limit = { is_claim = 4266 }
			remove_claim = 4266
		}
		add_truce_with = event_target:krakazol_friend
		add_historical_friend = event_target:krakazol_friend
		event_target:krakazol_friend = { add_historical_friend = ROOT }
		add_legitimacy = 15
		add_prestige = 10
	}
	option = { #can't wait to conquer em
		name = rahen.1.b
		ai_chance = { factor = 0 }
	}
}

country_event = {
	id = rahen.5
	title = rahen.5.t
	desc = rahen.5.d
	picture = REFUGEES_ESCAPING_eventPicture
	goto = rahen_exodus_target_3
	
	is_triggered_only = yes
	
	trigger = {
		current_age = age_of_reformation 
		NOT = {
			has_global_flag = rahen_exodus_complete
		}
		any_known_country = {
			has_country_modifier = dwarven_administration
			AND = {
				num_of_owned_provinces_with = {
					value = 7
					region = tree_of_stone_region
				}
				OR = {
					owns = 4265 	#Grozumdihr
					owns = 4247		#Ovdal Kanzad
					owns = 4266 	#Hul-az-Krakazol
					owns = 4284 	#Ovdal-az-An
				}
			}
		}
	}

	immediate = {
		hidden_effect = {
			random_known_country = {
				limit = {
					has_country_modifier = dwarven_administration
					AND = {
						num_of_owned_provinces_with = {
							value = 7
							region = tree_of_stone_region
						}
						OR = {
							owns = 4265 	#Grozumdihr
							owns = 4247		#Ovdal Kanzad
							owns = 4266 	#Hul-az-Krakazol
							owns = 4284 	#Ovdal-az-An
						}
					}
				}
				save_global_event_target_as = rahen_exodus_target_2
			}
			random_owned_province = { 
				limit = {
				#	region = rahen_region
					OR = {
						has_small_dwarven_minority_trigger = yes
						has_large_dwarven_minority_trigger = yes
					}
				}
				save_global_event_target_as = rahen_exodus_target_3
			}
		}
	}

	option = {
        name = rahen.5.a
		event_target:rahen_exodus_target_3 = {
			remove_dwarven_minority_size_effect = yes
		}
		hidden_effect = {
			event_target:rahen_exodus_target_2 = {
				country_event = {
					id = rahen.6
					days = 1
				}
			}	
		}
	}
}

country_event = {
	id = rahen.6
	title = rahen.6.t
	desc = rahen.6.d
	picture = EMPTY_eventPicture
	goto = rahen_exodus_target_1
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			if = {
				limit = { has_global_flag = rahen_exodus_3 }
				random_owned_province = { 
					limit = {
						region = tree_of_stone_region
						province_group = road_province 
					}
					save_global_event_target_as = rahen_exodus_target_1
				}
				set_global_flag = rahen_exodus_complete
				clr_global_flag = rahen_exodus_3
			}
			else_if = { 
				limit = { has_global_flag = rahen_exodus_2 }
				random_owned_province = { 
					limit = {
						region = tree_of_stone_region
						province_group = road_province 
					}
					save_global_event_target_as = rahen_exodus_target_1
				}
				set_global_flag = rahen_exodus_3
				clr_global_flag = rahen_exodus_2
			}
			else_if = { 
				limit = { has_global_flag = rahen_exodus_1 }
				random_owned_province = { 
					limit = {
						region = tree_of_stone_region
						province_group = road_province 
					}
					save_global_event_target_as = rahen_exodus_target_1
				}
				set_global_flag = rahen_exodus_2
				clr_global_flag = rahen_exodus_1
			}
			else = { 
				random_owned_province = { 
					limit = {
						region = tree_of_stone_region
						province_group = road_province 
					}
					save_global_event_target_as = rahen_exodus_target_1
				}
				set_global_flag = rahen_exodus_1
			}
		}
	}

	option = {
        name = rahen.6.a
		event_target:rahen_exodus_target_1 = {
			add_base_tax = 1
			add_base_production = 1
			add_base_manpower = 1
			random_list = {
				34 = { add_base_tax = 1 }
				33 = { add_base_production = 1 }
				33 = { add_base_manpower = 1 }
			}
		}
	}

	after = {
		clear_global_event_target = rahen_exodus_target_1
		clear_global_event_target = rahen_exodus_target_2
		clear_global_event_target = rahen_exodus_target_3
	}
}

# province_event = { #Event to make Rajnadhaga and dwarven adventurers friends
# 	id = rahen.1
# 	title = rahen.1.t
# 	desc = rahen.1.d
# 	picture = WESTERNISATION_eventPicture

# 	is_triggered_only = yes
# 	fire_only_once = yes
	
# 	trigger = {
# 		province_id = 4266
# 		owner = { culture_group = dwarven has_reform = dwarovar_adventurer_reform }
# 		4462 = {
# 			owner = {
# 				NOT = {
# 					tag = R62
# 					is_rival = ROOT
# 					is_subject = yes
# 				}
# 			}
# 		}
# 	}

# 	option = { #Reach out to Rajnadhaga to strike a deal
# 		name = rahen.1.a
# 		ai_chance = {
# 			factor = 1
# 		}
# 		4462 = {
# 			owner = {
# 				country_event = {
# 					id = rahen.2
# 					days = 1
# 				}
# 			}
# 		}
# 		owner = { add_treasury = -50 }
# 	}
# 	option = { #We don't need them
# 		name = rahen.1.b
# 		ai_chance = {
# 			factor = 0
# 		}
# 		owner = { add_prestige = 10 }
# 	}
# }
# country_event = { #Rajnadhaga's response
# 	id = rahen.2
# 	title = rahen.2.t
# 	desc = rahen.2.d
# 	picture = WESTERNISATION_eventPicture

# 	is_triggered_only = yes

# 	option = { #Reach out to Rajnadhaga to strike a deal
# 		name = rahen.2.a
# 		ai_chance = {
# 			factor = 1
# 		}
# 		add_treasury = 50
# 		create_alliance = FROM
# 		add_historical_friend = FROM
# 		FROM = { owner = { add_historical_friend = ROOT } }
# 	}
# 	option = { #Take their gifts but refuse the deal
# 		name = rahen.2.b
# 		ai_chance = {
# 			factor = 0
# 		}
# 		add_treasury = 50
# 		FROM = { add_casus_belli = { target = ROOT type = cb_insult months = 12 } }
# 	}
# }


