custom_button = {
    name = dig_deeper_capital
    potential = {
    	is_capital = yes
		OR = {
			has_terrain = dwarven_hold
			has_terrain = dwarven_hold_surface
		}
		owner = {
			tag = FROM
			NOT = {
				government = native
			}
		}
	}
	trigger = {
		has_subterranean_race = yes
		owner = {
			if = {
				limit = { NOT = { has_country_modifier = dwarven_administration } }
				if = {
					limit = {
						OR = {
							dwarovar_goblin_culture_primary = yes
							primary_culture = darkscale_kobold
						}
					}
					adm_tech = 5
				}
				else = {
					adm_tech = 7
				}
			}
			if = {
				limit = { has_disaster = remnant_stagnation_disaster }
				NOT = { has_disaster = remnant_stagnation_disaster }
			}
		}
		is_state_core = ROOT
		controlled_by = ROOT
		custom_trigger_tooltip = {
			tooltip = diggy_no_building #This includes armies and such
			NOT = { has_construction = any }
		}
		NOT = { has_construction = army } #For clarity
		NOT = { has_construction = navy } #For clarity
		if = {
			limit = { has_province_modifier = incomplete_hold }
			NOT = { has_province_modifier = incomplete_hold }
		}
		hidden_trigger = { NOT = { has_province_modifier = incomplete_hold_0 } }
		custom_trigger_tooltip = {
			tooltip = diggy_max_deepness_tooltip
			if = {
				limit = { OR = { province_id = 4119 province_id = 4311 AND = { province_id = 4119 OWNER = { has_country_flag = I98_may_come_down_flag } } } } #Big and Second capital
				NOT = { has_province_modifier = dig_11 }
			}
			else = {
				NOT = { has_province_modifier = dig_10 }
			}
		}
		if = { 
			limit = { OR = { has_province_modifier = ruined_hold has_province_modifier = infested_hold } } 
			NOT = { has_province_modifier = ruined_hold }
			NOT = { has_province_modifier = infested_hold }
		}
		else_if = {
			limit = { has_province_modifier = dig_1 }
			development = 40
		}
		else_if = {
			limit = { has_province_modifier = dig_2 }
			development = 50
		}
		else_if = {
			limit = { has_province_modifier = dig_3 }
			development = 60
		}
		else_if = {
			limit = { has_province_modifier = dig_4 }
			development = 70
		}
		else_if = {
			limit = { has_province_modifier = dig_5 }
			development = 80
		}
		else_if = {
			limit = { has_province_modifier = dig_6 }
			development = 90
		}
		else_if = {
			limit = { has_province_modifier = dig_7 }
			development = 100
		}
		else_if = {
			limit = { has_province_modifier = dig_8 }
			development = 110
		}
		else_if = {
			limit = { has_province_modifier = dig_9 }
			development = 120
		}
		else_if = {
			limit = { has_province_modifier = dig_10 OR = { province_id = 4119 province_id = 4311 } }
			development = 130
		}
		if = {
			limit = { owner = { has_country_flag = I98_can_befuddle_flag } }
			custom_trigger_tooltip = {
				tooltip = I98_not_befuddling_tt
				NOT = { has_province_flag = I98_befuddling_hold_flag }
			}
		}
	}
	effect = {
		if = {
			limit = { NOT = { has_province_flag = diggy_diggy_estimate_flag } }
			set_province_flag = diggy_diggy_estimate_flag
		}
		else = {
			clr_province_flag = diggy_diggy_estimate_flag
		}
	}
	tooltip = dig_hold_button_tt
}

custom_icon = {
    name = diggy_diggy_estimate
    potential = {
		has_province_flag = diggy_diggy_estimate_flag
	}
}

custom_icon = {
    name = government_mechanics_bg
    potential = {
    	OR = {
    		has_government_mechanic = anb_adventurer_unity
    		has_government_mechanic = allclan_pandemonium_mechanic
    		has_government_mechanic = centaur_nomadism
    		has_government_mechanic = desert_legion_mechanic
    		has_government_mechanic = anb_effelai_attuned_1
    		has_government_mechanic = harpylen_queendom_claim_mechanic
    		has_government_mechanic = anb_huszien_council
    		has_government_mechanic = anb_medasi_power_share
    		has_government_mechanic = magnate_mechanic
    		has_government_mechanic = phoenix_estate_mechanic
    		has_government_mechanic = vacyntassi_temple_authority
    	}
    }
}