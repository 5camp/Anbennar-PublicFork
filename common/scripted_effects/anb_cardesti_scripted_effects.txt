cardesti_start_spread_scripted_effect = {
	random_province = {
		limit = {
			superregion = western_cannor_superregion
			NOT = {
				has_province_modifier = cardesti_minority_modifier
				owner = {
					monstrous_culture = yes
				}
			}
			is_city = yes
		}
		add_province_modifier = {
			name = cardesti_minority_modifier
			duration = -1
		}
		save_global_event_target_as = cardesti_core_province
	}
	random_province = {
		limit = {
			superregion = western_cannor_superregion
			NOT = {
				has_province_modifier = cardesti_minority_modifier
				owner = {
					monstrous_culture = yes
				}
			}
			is_city = yes
		}
		add_province_modifier = {
			name = cardesti_minority_modifier
			duration = -1
		}
	}
	random_province = {
		limit = {
			superregion = western_cannor_superregion
			NOT = {
				has_province_modifier = cardesti_minority_modifier
				owner = {
					monstrous_culture = yes
				}
			}
			is_city = yes
		}
		add_province_modifier = {
			name = cardesti_minority_modifier
			duration = -1
		}
	}
	random_province = {
		limit = {
			superregion = western_cannor_superregion
			NOT = {
				has_province_modifier = cardesti_minority_modifier
				owner = {
					monstrous_culture = yes
				}
			}
			is_city = yes
		}
		add_province_modifier = {
			name = cardesti_minority_modifier
			duration = -1
		}
	}
	random_province = {
		limit = {
			superregion = western_cannor_superregion
			NOT = {
				has_province_modifier = cardesti_minority_modifier
				owner = {
					monstrous_culture = yes
				}
			}
			is_city = yes
		}
		add_province_modifier = {
			name = cardesti_minority_modifier
			duration = -1
		}
	}
	random_province = {
		limit = {
			superregion = western_cannor_superregion
			NOT = {
				has_province_modifier = cardesti_minority_modifier
				owner = {
					monstrous_culture = yes
				}
			}
			is_city = yes
		}
		add_province_modifier = {
			name = cardesti_minority_modifier
			duration = -1
		}
	}
	random_province = {
		limit = {
			superregion = western_cannor_superregion
			NOT = {
				has_province_modifier = cardesti_minority_modifier
				owner = {
					monstrous_culture = yes
				}
			}
			is_city = yes
		}
		add_province_modifier = {
			name = cardesti_minority_modifier
			duration = -1
		}
	}
	random_province = {
		limit = {
			superregion = western_cannor_superregion
			NOT = {
				has_province_modifier = cardesti_minority_modifier
				owner = {
					monstrous_culture = yes
				}
			}
			is_city = yes
		}
		add_province_modifier = {
			name = cardesti_minority_modifier
			duration = -1
		}
	}
	set_province_flag = half_decade_cardesti_flag
}

cardesti_minority_migration_scripted_effect = {
	event_target:cardesti_core_province = {
		remove_province_modifier = cardesti_minority_modifier
	}
	random_province = {
		limit = {
			continent = europe
			if = {
				limit = {
					NOT = { is_year = 1494 }
				}
				NOT = { superregion = escann_superregion }
			}
			NOT = {
				superregion = deepwoods_superregion
				superregion = deepwoods_portal_superregion
				#region = event_target:cardesti_core_province # doesn't work
				#event_target:cardesti_core_province = { region = THIS } # also doesn't work
				owner = {
					OR = {
						has_country_modifier = monstrous_nation
						has_country_modifier = racial_pop_human_purge
						has_country_modifier = racial_pop_human_expulsion
					}
				}
			}
			is_city = yes
		}
		add_province_modifier = {
			name = cardesti_minority_modifier
			duration = -1
		}
		clear_global_event_target = cardesti_core_province
		save_global_event_target_as = cardesti_core_province
	}
	europe = {
		limit = { NOT = { province_id = event_target:cardesti_core_province } }
		remove_province_modifier = cardesti_minority_modifier
	}
	check_cardesti_amount_scripted_effect = yes
}

cardesti_add_modifier_scripted_effect = {
	random_province = {
		limit = {
			continent = europe
			if = {
				limit = {
					NOT = { is_year = 1494 }
				}
				NOT = { superregion = escann_superregion }
			}
			#superregion = event_target:cardesti_core_province # doesnt work
			#event_target:cardesti_core_province = { superregion = THIS } # also doesn't work
			NOT = {
				has_province_modifier = cardesti_minority_modifier
				owner = {
					OR = {
						has_country_modifier = monstrous_nation
	                			has_country_modifier = racial_pop_human_purge
						has_country_modifier = racial_pop_human_expulsion
					}
				}
			}
			is_city = yes
		}
		add_province_modifier = {
			name = cardesti_minority_modifier
			duration = -1
		}
	}
}

check_cardesti_amount_scripted_effect = {
	trigger_switch = {
		on_trigger = is_year
		1794 = { for = { amount = 14 effect = "cardesti_add_modifier_scripted_effect = yes" } }
		1744 = { for = { amount = 13 effect = "cardesti_add_modifier_scripted_effect = yes" } }
		1694 = { for = { amount = 12 effect = "cardesti_add_modifier_scripted_effect = yes" } }
		1644 = { for = { amount = 11 effect = "cardesti_add_modifier_scripted_effect = yes" } }
		1594 = { for = { amount = 10 effect = "cardesti_add_modifier_scripted_effect = yes" } }
		1544 = { for = { amount = 9 effect = "cardesti_add_modifier_scripted_effect = yes" } }
		1494 = { for = { amount = 8 effect = "cardesti_add_modifier_scripted_effect = yes" } }
		1444 = { for = { amount = 7 effect = "cardesti_add_modifier_scripted_effect = yes" } }
	}
}