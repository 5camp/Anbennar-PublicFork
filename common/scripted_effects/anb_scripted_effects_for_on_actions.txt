
anb_initialize_schools_effect = { #Used in on_startup on_action
	if = {
		limit = { NOT = { has_global_flag = anb_schools_initiated } }
		set_global_flag = anb_schools_initiated
		#Unbroken Claw vs Radiant Sun
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = unbroken_claw_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = radiant_sun_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = radiant_sun_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = unbroken_claw_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Radiant Sun vs Starry Eye
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = radiant_sun_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = starry_eye_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = starry_eye_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = radiant_sun_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Orange Sash vs Radiant Sun
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = orange_sash_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = radiant_sun_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = radiant_sun_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = orange_sash_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Golden Palace vs Silk Turban
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = golden_palace_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = silk_turban_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = silk_turban_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = golden_palace_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Orange Sash vs Silk Turban
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = orange_sash_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = silk_turban_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = silk_turban_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = orange_sash_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Ascendant Soul vs Silk Turban
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = ascendant_soul_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = silk_turban_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = silk_turban_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = ascendant_soul_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Ascendant Soul vs Golden Palace
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = ascendant_soul_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = golden_palace_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = golden_palace_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = ascendant_soul_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Ascendant Soul vs Starry Eye
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = ascendant_soul_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = starry_eye_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = 1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = starry_eye_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = ascendant_soul_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = 1
				}
			}
		}
	}
}

xia_won_war_count = {
	if = {
		limit = {
			has_country_flag = xia_nation
		}
		change_variable = { xiaWarsWon = 1 }
	}
}
G35_won_war_count = {
	if = {
		limit = {
			tag = G35
		}
	}
	change_variable = { G35WarsWon = 1 }
}

feast_of_the_gods_won_war_count = {
	if = {
		limit = {
			religion = feast_of_the_gods
		}
		change_variable = { fotg_war_wins = 1 }
	}
}

feast_of_the_gods_increment_sacrifices = {
	if = {
		limit = { 
			is_subject = yes
			overlord = {
				religion = feast_of_the_gods 
				reverse_has_opinion_modifier = {
					who = ROOT
					modifier = sacrificed_ruler
					value = -100
				} # who = overlord does not work, so done this way
			}
		}
		overlord = { change_variable = { fotg_sacrifices = 1 } } # give the overlord the sacrifices
	}
}

anb_on_province_owner_change_government_reform_effect = {
	if = {
		limit = { 
			trade_goods = tropical_wood 
			owner = {
				has_reform = wood_elf_clan_inward_focus
			}
		}
		add_province_modifier = {
			name = deepwoods_government_reform_isolation_mod
			duration = -1
		}
	}
}

startup_1444_effects = {
	if = {
		limit = {
			NOT = {
				is_year = 1445	# is 1444
				is_month = 11	# is november (this trigger is 0-based, 11 is december)
			}
		}

		###########################
		# STARTUP EFFECTS GO HERE #
		###########################

		#ruler optimization
		update_ruler_racial_flag = yes

		if = {
			limit = {
				OR = {
					tag = Z15
					tag = Z08
				}
			}
			country_event = { id = ebonsteel_events.2 }
		}

		if = {
			limit = {
				OR = {
					was_tag = Y20
					tag = Y20
				}
			}
			save_global_event_target_as = feiten_or_was_feiten_target
		}

		if = {
			limit = { tag = REB }
			emperor = {
				save_global_event_target_as = Emperor
			}
		}

		if = {
			limit = { is_emperor_of_china = yes }
			save_global_event_target_as = EmperorOfChina
		}
	
		if = {
			limit = {
				religion = aakhetist
				has_country_flag = current_aakhet_host
			}
			save_global_event_target_as = aakhet_host
		}

		if = {
			limit = {
				tag = A06
			}
			A06 = { country_event = { id = gnomish.4 days = 1830 } }
		}

		if = {
			limit = {
				tag = S70
			}
			A06 = { country_event = { id = shadow.1 } }
		}

		if = {
			limit = {
				ai = no
				capital_scope = {
					superregion = ynn_superregion
				}
			}
			country_event = { id = ynn_events.991 days = 30 }
		}

		if = {
			limit = {
				tag = tag = G26
			}
			country_event = { id = flavour_amacimst.0 days = 15 }
		}

		country_event = {
			id = anbennar_setup.20
			days = 32
		}

		##aakhetist starting tags minus aramoole
		if = {
			limit = { 
				tag = F70 #Mattabo 
			}
			country_event = { id = aakhetist.04 }
		}

		if = {
			limit = {
				has_country_flag = has_caste_estates
			}
			#Introduction to the castes
			country_event = {
				id = estate_castes_events.0
				days = 15
			}
		}

		# Add wine to Wine Lords
		if = {
			limit = {
				OR = {
					has_reform = wine_lord_reform
					has_reform = roilsard_elective
					has_reform = wineport_merchants
				}
			}
			every_owned_province = {
				limit = {
					trade_goods = wine
				}
				add_province_modifier = {
					name = wine_lord_wine
					duration = -1
					hidden = yes
				}
			}
		}

		# Add sugar bonus to Keyolion (From Gov Reform)
		if = {
			limit = {
				has_reform = G58_agronomers_association_reform
			}
			every_owned_province = {
				limit = {
					trade_goods = sugar
				}
				add_province_modifier = {
					name = G58_sugar_province_goods
					duration = -1
					hidden = yes
				}
			}
		}

		# Frontier Republics
		if = {
			limit = {
				has_reform = frontier_republic_reform
			}
			every_owned_province = {
				limit = {
					trade_goods = livestock
				}
				add_province_modifier = {
					name = livestock_boost_frontier
					duration = -1
					hidden = yes
				}
			}
			every_owned_province = {
				limit = {
					has_terrain = steppe
				}
				add_province_modifier = {
					name = frontier_republic_steppe_expansion
					duration = -1
					hidden = yes
				}
			}
		}

		#Mulen goblin setup
		if = {
			limit = { tag = F50 }
			country_event = {
				id = flavour_mulen.3
				days = 3650
			}
		}

		#company of thorns high stability
		if = {
			limit = { tag = B11 }
			country_event = {
				id = flavor_luciande.54
				days = 30
			}
		}

		if = {
			limit = {
				capital_scope = {
					OR = {
						superregion = escann_superregion
						region = forlorn_vale_region
					}
					NOT = {
						region = dostanor_region
						region = ourdia_region
						region = daravans_folly_region
					}
				}
				NOT = {
					culture_group = orcish
					culture_group = goblin
				}
				NOT = { tag = A32 }	#Dont let Ibevar, Silent Repose, and Orda Aldresia get this
				NOT = { tag = A83 }
				NOT = { tag = A77 }
			}
			country_event = { id = greentide.0 days = 1 }
		}
	}
}