thirabnir_2 = {
	slot = 2
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = Y59
			AND = {
				tag = Z62
				was_tag = Y59
			}
		}
	}

	thirabnir_2_1 = {
		icon = mission_build_up_to_force_limit
		position = 1

		trigger = {  
			army_size_percentage = 0.9
			num_of_mercenaries = 1
			num_of_generals = 2
		} 

		effect = {  
			add_country_modifier = {
				name = thirabnir_marching_lords
				duration = 3650
			}
			kaiden_area = {
				add_permanent_claim = ROOT
			}
			4777 = { add_permanent_claim = ROOT }
			4781 = { add_permanent_claim = ROOT }
			4940 = { add_permanent_claim = ROOT }
		} 
	}

	thirabnir_2_3 = {
		icon = mission_noble_council
		position = 3
		required_missions = { thirabnir_2_1 } 
		provinces_to_highlight = { 
			OR = {
				AND = {
					exists = Y67
					owned_by = Y67
				}
				AND = {
					NOT = { exists = Y67 }
					owned_by = Y66
				}
			}
		} 

		trigger = {  
			OR = {
				custom_trigger_tooltip = {
					tooltip = thirabnir_mo_hoang_improved_relations_tt
					Y67 = { #Mo Hoang
						has_opinion_modifier = {
							who = Y59
							modifier = improved_relation
							value = 99
						}
					}
				}
				AND = {
					custom_trigger_tooltip = {
						tooltip = thirabnir_hon_sai_improved_relations_tt
						Y66 = { #Hon Sai
							has_opinion_modifier = {
								who = Y59
								modifier = improved_relation
								value = 99
							}
						}
					}
					custom_trigger_tooltip = {
						tooltip = thirabnir_hon_sai_mantle_winner_tt
						NOT = { exists = Y67 } #Mo Hoang
					}
				}
			}	
		} 

		effect = {  
			if = {
				limit = { exists = Y66 }
				add_truce_with = Y66 #Hon Sai
			}
			if = {
				limit = { exists = Y67 }
				add_truce_with = Y67 #Mo Hoang
			}
			add_country_modifier = {
				name = thirabnir_stable_khom_relations
				duration = 7300
			}
		} 
	}
}
thirabnir_3 = {
	slot = 3
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = Y59
			AND = {
				tag = Z62
				was_tag = Y59
			}
		}
	}

	thirabnir_3_1 = {
		icon = mission_court_education
		position = 1

		trigger = {  
			has_advisor = yes
			OR = {
				has_estate_privilege = estate_church_religious_state
				has_estate_privilege = estate_nobles_nobility_primacy
				has_estate_privilege = estate_burghers_land_of_commerce
			}
			any_ally = {
				NOT = { culture_is_human = yes } #This shows in-game as like the NOT clause wasn't there at all, weirdge
			}
		} 

		effect = {  
			custom_tooltip = thirabnir_mana_tt
			custom_tooltip = thirabnir_races_tt
			if = {
				limit = {
					has_adm_advisor = yes
				}
				add_adm_power = 25
			}
			if = {
				limit = {
					has_dip_advisor = yes
				}
				add_dip_power = 25
			}
			if = {
				limit = {
					has_mil_advisor = yes
				}
				add_mil_power = 25
			}
			if = {
				limit = {
					has_estate_privilege = estate_church_religious_state
				}
				add_adm_power = 25
			}
			if = {
				limit = {
			  		has_estate_privilege = estate_burghers_land_of_commerce
				}
				add_dip_power = 25
			}
			if = {
				limit = {
					has_estate_privilege = estate_nobles_nobility_primacy
				}
				add_mil_power = 25
			}
			#One of the main reasons why I wanted ruler culture instead of primary culture. Could've had Kudet Kai, Bim Lau, Iyarhashar in the pool, now it's "only" Hubao, Zongji and Jiantsang
			if = {
				limit = {
					any_ally = { culture_is_harimari = yes }
				}
				4779 = {
					add_harimari_minority_size_effect = yes
				}
				small_increase_of_harimari_tolerance_effect = yes
			}
			#P'ezarang/Semifire but you can't ally those instantly
			if = { 
				limit = {
					any_ally = { culture_is_harpy = yes }
				}
				4779 = {
					add_harpy_minority_size_effect = yes
				}
				small_increase_of_harpy_tolerance_effect = yes
			}
			#Balrijin, The most common outcome
			if = { 
				limit = {
					any_ally = { culture_is_kobold = yes }
				}
				4779 = {
					add_kobold_minority_size_effect = yes
				}
				small_increase_of_kobold_tolerance_effect = yes
			}
			#Verkal Ozovar
			if = {
				limit = {
					any_ally = { culture_is_dwarven = yes }
				}
				4779 = {
					add_dwarven_minority_size_effect = yes
				}
				small_increase_of_dwarven_tolerance_effect = yes
			}
			#And see, if I could do ruler culture, that would be justified in (the extremely rare) case of a hobgoblin Metnikhren of Lot Dekkhang
			#if = {
			#	limit = {
			#		any_ally = { culture_is_hobgoblin = yes }
			#	}
			#	4779 = {
			#		add_hobgoblin_minority_size_effect = yes
			#	}
			#	small_increase_of_hobgoblin_tolerance_effect = yes
			#}
			#Azjakuma, but like... why... HOW?!
			#if = {
			#	limit = {
			#		any_ally = { culture_is_ogre = yes }
			#	}
			#	4779 = {
			#		add_ogre_minority_size_effect = yes
			#	}
			#	small_increase_of_ogre_tolerance_effect = yes
			#}
			#I shouldn't need this. Probably. Like 999/1000 times.
			#if = {
			#	limit = {
			#		any_ally = { culture_is_gnoll = yes }
			#	}
			#	4779 = {
			#		add_gnoll_minority_size_effect = yes
			#	}
			#	small_increase_of_gnoll_tolerance_effect = yes
			#}
		} 
	}

	thirabnir_3_2 = {
		icon = mission_swear_fealty_knight
		position = 2
		required_missions = {
			thirabnir_2_1
			thirabnir_3_1
			thirabnir_4_1
		}
		provinces_to_highlight = {
			OR = {
				AND = {
					Y62 = { vassal_of = Y59 }
					owned_by = Y62
				}
				AND = {
					Y60 = { vassal_of = Y59 }
					owned_by = Y60
				}
			}
		} 

		trigger = {  
			Y62 = { vassal_of = ROOT }
			Y60 = { vassal_of = ROOT }
		} 

		effect = {  
			add_country_modifier = {
				name = thirabnir_promises_of_coexistence
				duration = 3650
			}
			#Needs tooltip, TODO. Also doesn't work for some reason.
			if = {
				limit = {
					custom_trigger_tooltip = {
						tooltip = thirabnir_narai_chaiya_alive_tt
						has_ruler = "Narai Chaiya"
					}
					NOT = { exists = Y86 }
				}
				every_owned_province = {
					add_prosperity = 100
					add_devastation = -100
				}
				every_subject_country = {
					every_owned_province = {
						add_prosperity = 100
						add_devastation = -100
					}
				}
				add_power_projection = {
					type = mission_rewards_power_projection
					amount = 10
				}
			}
		} 
	}

	thirabnir_3_4 = {
		icon = all_bases_covered
		position = 4
		required_missions = {
			thirabnir_2_3
			thirabnir_3_2
			thirabnir_4_3
		}
		provinces_to_highlight = { 
			OR = {
				area = kaiden_area 
				area = phakphon_area 
				area = thirabnir_area
				province_id = 4777
				province_id = 4781
				province_id = 4940
			}
			NOT = { country_or_non_sovereign_subject_holds = Y59 }
		} 

		trigger = { 
			kaiden_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			phakphon_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			thirabnir_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			4777 = { country_or_non_sovereign_subject_holds = ROOT }
			4781 = { country_or_non_sovereign_subject_holds = ROOT }
			4940 = { country_or_non_sovereign_subject_holds = ROOT }
			all_subject_country = {
				NOT = { liberty_desire = 50 }
			}
			stability = 1
		}  

		effect = {
			hidden_effect = {
				Y59 = {
					add_ruler_modifier = {
						name = "thangoya_thirabnir_ruler"
						duration = -1
					}
				}
			}
			add_power_projection = {
				type = mission_rewards_power_projection
				amount = 15
			}
			if = { limit = { exists = Y62 } inherit = Y62 } #Khao Elnak
			if = { limit = { exists = Y60 } inherit = Y60 } #Lo Ngoen
			if = { limit = { exists = Y86 } inherit = Y86 } #Azkare
			country_event = { id = thangoya_event.1 } 
		}
	}
}
thirabnir_4 = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = Y59
			AND = {
				tag = Z62
				was_tag = Y59
			}
		}
	}

	thirabnir_4_1 = {
		icon = mission_mal_riches_of_trade
		position = 1

		trigger = {  
			stability = 1
			custom_trigger_tooltip = {
				tooltip = thirabnir_completed_agenda_tt
				OR = {
					num_of_estate_agendas_completed = {
						estate = estate_church 
						value = 1
					}
					num_of_estate_agendas_completed = {
						estate = estate_nobles 
						value = 1
					}
					num_of_estate_agendas_completed = {
						estate = estate_burghers
						value = 1
					}
					num_of_estate_agendas_completed = {
						estate = estate_adventurers
						value = 1
					}
					num_of_estate_agendas_completed = {
						estate = estate_mages
						value = 1
					}
				}
			}
			calc_true_if = {
				all_ally = {
					has_opinion = {
						who = Y59
						value = 100
					}
				}
				amount = 2
			}
		} 

		effect = {  
			thirabnir_area = { add_prosperity = 50 }
		} 
	}

	thirabnir_4_2 = {
		icon = mission_conquer_air
		position = 2
		required_missions = { thirabnir_4_1 } 

		trigger = {  
			has_church_aspect = remembrance_festivals
			has_estate_privilege = estate_mages_spirit_speakers
			treasury = 100
		} 

		effect = {  
			add_treasury = -100
			4780 = { add_base_tax = 2 }
			add_country_modifier = {
				name = thirabnir_honored_ancestor_spirits
				duration = 3650
			}
		} 
	}

	thirabnir_4_3 = {
		icon = mission_warrior_gold
		position = 3
		required_missions = { thirabnir_4_2 } 
		provinces_to_highlight = { 
			AND = {
				province_id = 4779
				NOT = { development = 12 }
			}
		} 

		trigger = {  
			4779 = { development = 12 }
			estate_loyalty = {
				estate = estate_adventurers
				loyalty = 50
			}
			estate_influence = {
				estate = estate_adventurers
				influence = 35
			}
		} 

		effect = {  
			if = {
				limit = {
					4779 = { NOT = { province_has_center_of_trade_of_level = 2 } }
				}
				4779 = { add_center_of_trade_level = 1 }
			}
			else = { add_treasury = 200 }
		} 
	}
}
