#Designed and coded by: Alex

freemarches_missions_1_early= {
	slot = 1
	generic = no
	ai = yes
	potential = {	tag = H51	}
	has_country_shield = yes
	
	freemarches_into_the_valley = {
		icon = mission_invade_island
		position = 1
		required_missions = { }
		
		
		trigger = {
			if = {
				limit = { 
					exists = G26
				}
				knows_country = G26
			}
			else = {
				has_discovered = 1172
			}
			
			num_of_conquistadors = 1
		}
		
		effect = {
			country_event = { 
		    id = flavor_freemarches.5
			}
		}
	}
	
	freemarches_resources_to_trade = {
		icon = mission_invade_island
		position = 2
		
		required_missions = {
			freemarches_into_the_valley
		}
		
		trigger = {
			num_of_owned_provinces_with = {
				trade_goods = fur
				value = 1
			}
			num_of_provinces_in_states =  4
			army_size_percentage = 0.9 
		}
		
		effect = {
			if = {
				limit = { 
					exists = G26
				}
				add_casus_belli = {
					target = G26
					type = cb_trade_war_triggered
					months = 18250
				}
			}
			else = {
				 1172 = { 
				 	owner = { 
						ROOT = { 
							add_casus_belli = { 
								target = PREV 
								type = cb_trade_war_triggered
								months = 18250
							} 
						} 
					} 
				}
			}
			
			if = {
				limit = {				
					G26 = {
						exists = yes 
						is_subject = yes
					}
				}
				
				add_province_modifier = {
					name = H51_prepared_for_war
					duration = 7300
				}
			}
			else_if = {
				limit = {				
					1172 = { 
						owner = { 
							exists = yes 
							is_subject = yes
						} 
					} 
				}
				
				add_province_modifier = {
					name = H51_prepared_for_war
					duration = 7300
				}
			}
		}
	}
}

freemarches_missions_2_early= {
	slot = 2
	generic = no
	ai = yes
	potential = {	tag = H51	}
	has_country_shield = yes
	
	freemarches_diplomatic_outreach = {
		icon = mission_invade_island
		position = 2
		
		trigger = {
			calc_true_if = {
				any_known_country = {
					technology_group = tech_ynnic
					has_opinion = {
						who = ROOT
						value = 75
					}
				}
				amount = 3
			}
			NOT = {
				all_ally = {
					technology_group = tech_ynnic
				}
			}
			dip_power = 100
		}
		
		effect = {
			add_dip_power = -100
			every_known_country = {
				limit = {
					technology_group = tech_ynnic
				}
				add_truce_with = PREV
			}
			medium_increase_of_ruinborn_tolerance_effect = yes
		}
	}
	
	freemarches_access_to_market = {
		icon = mission_invade_island
		position = 3
		
		required_missions = {
			freemarches_resources_to_trade
			freemarches_diplomatic_outreach
		}
		
		trigger = {
			if = {
				limit = {
					G26 = { exists = yes }
				}				
				G26 = {
					is_at_war = yes
					war_with = ROOT
				}
				war_score = 50
			}
			else = {
				1172 = {
					owner = {
						is_at_war = yes
						war_with = ROOT					
					}
				}
				war_score = 50
			}
		}
		
		effect = {
		}
	}
}

freemarches_missions_3_early= {
	slot = 3
	generic = no
	ai = yes
	potential = {	tag = H51	}
	has_country_shield = yes
	
	freemarches_the_cursed_heart = {
		icon = mission_invade_island
		position = 1
		required_missions = { }
		
		provinces_to_highlight = {
			province_id = 1183
			NOT = { owned_by = ROOT }
		}
		
		trigger = {
			owns_core_province = 1183
		}
		
		effect = {
			country_event = { 
		    id = flavor_freemarches.6
			}
		}
	}
	
	freemarches_the_meeting_of_rivers = {
		icon = mission_invade_island
		position = 2
		
		required_missions = {
			freemarches_the_cursed_heart
			freemarches_the_forest_edges
		}
		
		provinces_to_highlight = {
			province_id = 1183
			OR = {
				NOT = {	owned_by = ROOT } # don't highlight if this city is owned by the country in question
				NOT = {	has_trade_building_trigger = yes } # don't highlight if the city has X building
				NOT = {	development = 15 } # don't highlight if the city already has X development
			}
		}
		
		trigger = {
			1183 = {
				owned_by = ROOT
				has_trade_building_trigger = yes
				development = 15
			}
		}
		
		effect = {
		}
	}
	
	freemarches_a_safe_haven_beckons = {
		icon = mission_invade_island
		position = 3
		
		required_missions = {
			freemarches_the_meeting_of_rivers
		}
		
		trigger = {
			has_spy_network_in = {
				who = has_country_modifier = orcish_slaves_in_colonies 
				value = 50
			}
		}
		
		effect = {
		}
	}
	
	freemarches_the_freemarches = {
		icon = mission_invade_island
		position = 4
		
		required_missions = {
			freemarches_access_to_market
			freemarches_a_safe_haven_beckons
			freemarches_half_orcs_of_the_forest
		}
		
		trigger = {
			num_of_provinces_in_states = 10 
			stability = 2
		}
		
		effect = {
			hidden_effect = {
				set_country_flag = freemarches_part_two_unlocked
				swap_non_generic_missions = yes
			}
		}
	}
}

freemarches_missions_4_early= {
	slot = 4
	generic = no
	ai = yes
	potential = {
		tag = H51
	}
	has_country_shield = yes
	
	freemarches_the_forest_edges = {
		icon = mission_invade_island
		position = 1
		
		provinces_to_highlight = {
			area = tyorbaland_area
			NOT = { owned_by = ROOT }
		}
		
		trigger = {
			tyorbaland_area = { type = all	country_or_non_sovereign_subject_holds = ROOT }
		}
		
		effect = {
			tyorbaland_area = {
				limit = { owned_by = ROOT }
				add_province_modifier = {
					name = H51_defensible_land
					duration = 7300
				}
			}
		}
	}
	
	freemarches_half_orcs_of_the_forest = {
		icon = mission_invade_island
		position = 3
		required_missions = {		}
		
		trigger = {
			num_of_owned_provinces_with = {
				has_manpower_building_trigger = yes
				value = 3
			}
			num_of_owned_provinces_with = {
				has_manpower_building_trigger = yes
				OR = { trade_goods = copper trade_goods = iron }
				value = 1
			}
		}
		
		effect = {
		}
	}
}

freemarches_missions_5_early= {
	slot = 5
	generic = no
	ai = yes
	potential = {
		tag = H51
	}
	has_country_shield = yes
	
	
	freemarches_a_new_avatar= {
		icon = mission_invade_island
		position = 2
		
		trigger = {
		}
		
		effect = {
		}
	}
}

freemarches_missions_1_established_ynn= {
	slot = 1
	generic = no
	ai = yes
	potential = {	
		tag = H51
		#has_country_flag = freemarches_part_two_unlocked
	}
	has_country_shield = yes
	
	freemarches_defending_against_the_riverlords = {
		icon = mission_invade_island
		position = 5
		
		required_missions = {
			freemarches_the_freemarches
		}
		
		trigger = {
			num_of_owned_provinces_with = {
				has_fort_building_trigger = yes
				OR = {
					area = tyorbaland_area
					area = zemshogen_area
					area = arrzreth_area
				}
				value = 2
			}
		}
		
		effect = {
		}
	}
	
	freemarches_armed_neutrality = {
		icon = mission_invade_island
		position = 6
		
		required_missions = {
			freemarches_defending_against_the_riverlords
		}
		
		trigger = {
			NOT = {
				all_ally = {
					technology_group = tech_ynnic
				}
			}
			manpower_percentage = 0.9
			army_size = 45
		}
		
		effect = {
		}
	}
	
	freemarches_lordling_adventurers = {
		icon = mission_invade_island
		position = 7
		
		required_missions = {
			freemarches_armed_neutrality
		}
		
		trigger = {
			if = {
				limit = { has_dlc = "Dharma" }
				1183 = {
					province_has_center_of_trade_of_level = 3
					owned_by = ROOT 
				}
			}
			1165 = { #Upper Ynn
				trade_share = {
					country = ROOT
					share = 33
				}
			}
		}
		
		effect = {
		}
	}
}

freemarches_missions_1_established_cursed_ones= {
	slot = 1
	generic = no
	ai = yes
	potential = {	
		tag = H51
		#has_country_flag = freemarches_part_two_unlocked
	}
	has_country_shield = yes
	
	freemarches_understanding_our_enemy = {
		icon = mission_invade_island
		position = 8
		
		required_missions = {
			freemarches_hunting_the_hunters
			freemarches_breaking_through_to_the_sea
		}
		
		trigger = {
			OR = {
				1241 = {
					has_forcelimit_building_trigger = yes
					has_building = university
				}
			}
			OR = {
				1241 = {
					has_forcelimit_building_trigger = yes
				}
				adm_power = 100
				treasury = 500
				NOT = { has_construction = building }
			}
		}
		
		effect = {
		}
	}
}

freemarches_missions_2_established_cursed_ones= {
	slot = 2
	generic = no
	ai = yes
	potential = {	
		tag = H51
		#has_country_flag = freemarches_part_two_unlocked
	}
	has_country_shield = yes
	
	freemarches_rudmen_guards = {
		icon = mission_invade_island
		position = 6
		
		required_missions = {
			freemarches_into_the_dark_of_the_forest
		}
		
		trigger = {
			estate_loyalty = {
				estate = estate_adventurers
				loyalty = 60
			}
			estate_loyalty = {
				estate = estate_burghers
				loyalty = 60
			}
			treasury = 250
		}
		
		effect = {
		}
	}
	
	freemarches_hunting_the_hunters = {
		icon = mission_invade_island
		position = 7
		
		required_missions = {
			freemarches_rudmen_guards
		}
		
		trigger = {
			estate_loyalty = {
				estate = estate_adventurers
				loyalty = 60
			}
			estate_influence = {
				estate = estate_adventurers
				influence = 40
			}
			mil_power = 200
		}
		
		effect = {
		}
	}
	
	freemarches_gnomish_innovation = {
		icon = mission_invade_island
		position = 8
		
		required_missions = {
			freemarches_breaking_through_to_the_sea
		}
		
		trigger = {
			if = {
				limit = {
					any_known_country = {
						culture_group = gnomish
					}
				}
				any_known_country = {
					culture_group = gnomish
					has_opinion = {
						who = ROOT
						value = 100
					}
				}
			}
			else = {
				OR = {
					146 = { owner = { has_opinion = { who = ROOT value = 100 } } }
				}
				OR = {
					146 = { owner = { has_spy_network_in = { who = ROOT value = 100 } } }
				}
			}
			stability = 2
			dip_power = 100
		}
		
		effect = {
		}
	}
	
	freemarches_bond_breaker = {
		icon = mission_invade_island
		position = 8
		
		required_missions = {
			freemarches_understanding_our_enemy
			freemarches_gnomish_innovation
		}
		
		trigger = {
		}
		
		effect = {
		}
	}
	
	freemarches_into_the_forest_once_more = {
		icon = mission_invade_island
		position = 9
		
		required_missions = {
			freemarches_bond_breaker
		}
		
		trigger = {
		}
		
		effect = {
		}
	}
}

freemarches_missions_3_established_rudmen_expansion= {
	slot = 3
	generic = no
	ai = yes
	potential = {	
		tag = H51
		#has_country_flag = freemarches_part_two_unlocked
	}
	has_country_shield = yes
	
	freemarches_into_the_dark_of_the_forest = {
		icon = mission_invade_island
		position = 5
		
		required_missions = {
			freemarches_the_freemarches
		}
		
		provinces_to_highlight = {
			province_group = freemarches_rudmen_route_1
			OR = {
				NOT = {	owned_by = ROOT } # don't highlight if this city is owned by the country in question
				NOT = {	is_core = ROOT } # don't highlight if this city is owned by the country in question
			}
		}
		
		trigger = {
			freemarches_rudmen_route_1 = {
				type = all
				owned_by = ROOT
				is_city = yes
				is_core = yes
			}
		}
		
		effect = {
		}
	}
	
	freemarches_bankside_redoubts = {
		icon = mission_invade_island
		position = 6
		
		required_missions = {
			freemarches_into_the_dark_of_the_forest
		}
		
		provinces_to_highlight = {
			province_group = freemarches_rudmen_route_1
			OR = {
				NOT = {	owned_by = ROOT } 
				NOT = {	has_production_building_trigger = yes } 
				NOT = {	has_forcelimit_building_trigger = yes } 
				NOT = {	has_building = ramparts } 
			}
		}
		
		trigger = {
			num_of_owned_provinces_with = {
				value = 3
				province_group = freemarches_rudmen_route_1
				has_production_building_trigger = yes
				has_forcelimit_building_trigger = yes
				has_building = ramparts
			}
		}
		
		effect = {
		}
	}
	
	freemarches_breaking_through_to_the_sea = {
		icon = mission_invade_island
		position = 7
		
		required_missions = {
			freemarches_bankside_redoubts
		}
		
		provinces_to_highlight = {
			province_group = freemarches_rudmen_route_2
			OR = {
				NOT = {	owned_by = ROOT }
				NOT = {	is_core = ROOT }
			}
		}
		
		trigger = {
			freemarches_rudmen_route_2 = {
				type = all
				owned_by = ROOT
				is_city = yes
				is_core = yes
			}
			1241 = {
				base_production = 5
				has_trade_building_trigger = yes
				has_dock_building_trigger = yes
			}
		}
		
		effect = {
		}
	}
	
	freemarches_the_grand_haul = {
		icon = mission_invade_island
		position = 8
		
		required_missions = {
			freemarches_breaking_through_to_the_sea
		}
		
		trigger = {
			num_of_owned_provinces_with = {
				trade_goods = fur
				value = 10
			}
			freemarches_rudmen_route_2 = {
				type = all
				owned_by = ROOT
				is_city = yes
				is_core = yes
			}			
			1743 = {
				base_production = 3
				base_tax = 3
				has_trade_building_trigger = yes
				has_manufactory_trigger = yes
			}
		}
		
		effect = {
		}
	}
	
	freemarches_varbuks_dream = {
		icon = mission_invade_island
		position = 12
		
		required_missions = {
			freemarches_into_the_forest_once_more
			freemarches_the_grand_haul
			freemarches_our_north
			freemarches_the_gray_guard
		}
		
		trigger = {
			total_development = 6400
			stability = 3
			army_size 
		}
		
		effect = {
		}
	}
}

freemarches_missions_4_established= {
	slot = 4
	generic = no
	ai = yes
	potential = {	
		tag = H51
		#has_country_flag = freemarches_part_two_unlocked
	}
	has_country_shield = yes
	
	freemarches_ichor_of_the_forest = {
		icon = mission_invade_island
		position = 5
		
		required_missions = {
			freemarches_the_freemarches
		}
		
		trigger = {
			1177 = {
				development = 10
				has_production_building_trigger = yes
			}
			treasury = 250
		}
		
		effect = {
			change_trade_goods = sugar
			
			if = {
				limit = {
					NOT = {
						has_building = tradecompany
					}
				}
				
				add_building_construction = {
				  building = tradecompany
				  speed = 1
				  cost = 0
				}
				add_treasury = -250
			}
		}
	}
	
	freemarches_reach_out_to_grombar= {
		icon = mission_invade_island
		position = 8
		
		required_missions = {
			freemarches_breaking_through_to_the_sea
		}
		
		trigger = {
			if = {
				limit = {
					Z50 = { #Grombar
						exists = no
					}
				}
				Z50 = {
					culture_group = gnomish
					has_opinion = {
						who = ROOT
						value = 100
					}
				}
			}
			else = {
				740 = { 	# Bal Vroren
					owner = { 
						has_spy_network_from = {
							who = ROOT
							value = 50
						}
					}	
				}
			}
			treasury = 500
		}
		
		effect = {
			add_treasury = 500
			if = {
				limit = { exists = Z50 }
				add_historical_friend = Z50
			}
		}
	}
	
	freemarches_the_gray_guard= {
		icon = mission_invade_island
		position = 10
		
		required_missions = {
			freemarches_reach_out_to_grombar
		}
		
		trigger = {
			if = {
				limit = { has_dlc = "Cradle of Civilization" }
				army_professionalism = 0.6
			}
			else = {
				army_tradition = 60
			}
			
			OR = {
				army_organiser = 3
				army_reformer = 3
				commandant = 3
				grand_captain = 3
			}
		}
		
		effect = {
			change_unit_type = tech_gerudian
		}
	}
}

freemarches_missions_5_established_religious= {
	slot = 5
	generic = no
	ai = yes
	potential = {	
		tag = H51
		#has_country_flag = freemarches_part_two_unlocked
	}
	has_country_shield = yes
	
	freemarches_temples_to_falah = {
		icon = mission_invade_island
		position = 5
		
		required_missions = {
			freemarches_a_new_avatar
		}
		
		trigger = {
			num_of_owned_provinces_with = {
				value = 4
				has_tax_building_trigger = yes
			}
		}
		
		effect = {
			1183 = {
				add_building = cathedral
				add_stability_or_adm_power = yes
			}
		}
	}
	
	freemarches_murogafest = {
		icon = mission_invade_island
		position = 6
		
		required_missions = {
			freemarches_temples_to_falah
		}
		
		trigger = {
			estate_loyalty = {
				estate = estate_church
				loyalty = 60
			}
			monthly_income = 20
		}
		
		effect = {
		}
	}
	
	freemarches_twelfth_pantheonic_council = {
		icon = mission_invade_island
		position = 7
		
		required_missions = {
			freemarches_murogafest
		}
		
		trigger = {
		}
		
		effect = {
		}
	}
}

freemarches_missions_5_established_conquest= {
	slot = 5
	generic = no
	ai = yes
	potential = {	
		tag = H51
		#has_country_flag = freemarches_part_two_unlocked
	}
	has_country_shield = yes
	
	freemarches_our_forest = {
		icon = mission_invade_island
		position = 8
		
		required_missions = {
			freemarches_breaking_through_to_the_sea
		}
		
		provinces_to_highlight = {
			OR = {
				region = forest_of_the_cursed_ones_region
				area = fionveren_area
				area = ildavar_area
				province_id = 1240
				province_id = 1224
				province_id = 2848
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			forest_of_the_cursed_ones_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			fionveren_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			ildavar_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			1240 = {
				country_or_non_sovereign_subject_holds = ROOT
			}
			1224 = {
				country_or_non_sovereign_subject_holds = ROOT
			}
			2848 = {
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		effect = {
			themaria_area = {
				add_permanent_claim = ROOT
			}
			reithemar_area = {
				add_permanent_claim = ROOT
			}
			oighach_area = {
				add_permanent_claim = ROOT
			}
		}
	}
	
	freemarches_in_search_of_more_furs = {
		icon = mission_invade_island
		position = 9
		
		required_missions = {
			freemarches_our_forest
		}
		
		provinces_to_highlight = {
			OR = {
				area = themaria_area
				area = reithemar_area
				area = oighach_area
			}
			NOT = { owned_by = ROOT }
		}
		
		trigger = {
			themaria_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			reithemar_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			oighach_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		effect = {
		}
	}
	
	freemarches_best_served_cold = {
		icon = mission_invade_island
		position = 10
		
		required_missions = {
			freemarches_in_search_of_more_furs
		}
		
		provinces_to_highlight = {
			province_id = 1202
		}
		
		trigger = {
			controls = 1202
		}
		
		effect = {
		}
	}
	
	freemarches_our_north = {
		icon = mission_invade_island
		position = 11
		
		required_missions = {
			freemarches_best_served_cold
		}
		
		provinces_to_highlight = {
			OR = {
				region = forest_of_the_cursed_ones_region
				region = dalaire_region
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
			forest_of_the_cursed_ones_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			dalaire_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		effect = {
		}
	}
}